{"version":3,"file":"makehuman.js","sources":["../node_modules/toad.jsx/lib/jsx-runtime.js","../../toad.js/lib/src/Signal.js","../../toad.js/lib/src/model/Model.js","../../toad.js/lib/src/model/GenericModel.js","../../toad.js/lib/src/model/NumberModel.js","../src/Human.ts","../src/lib/StringToLineIterator.ts","../src/lib/StringToLine.ts","../src/filesystem/FileSystemAdapter.ts","../src/target/Target.ts","../src/target/Component.ts","../src/target/TargetFactory.ts","../node_modules/gl-matrix/esm/common.js","../node_modules/gl-matrix/esm/mat4.js","../node_modules/gl-matrix/esm/vec3.js","../node_modules/gl-matrix/esm/vec4.js","../src/skeleton/Bone.ts","../src/skeleton/loadSkeleton.ts","../src/skeleton/VertexBoneWeights.ts","../src/skeleton/Skeleton.ts","../src/modifier/getTargetWeights.ts","../../toad.js/node_modules/toad.jsx/lib/jsx-runtime.js","../../toad.js/lib/src/util/lsx.js","../../toad.js/lib/src/model/BooleanModel.js","../../toad.js/lib/src/model/TextModel.js","../../toad.js/lib/src/model/HtmlModel.js","../../toad.js/lib/src/model/Action.js","../../toad.js/lib/src/util/dom.js","../../toad.js/lib/src/controller/globalController.js","../../toad.js/lib/src/controller/Controller.js","../../toad.js/lib/src/util/animation.js","../../toad.js/lib/src/model/OptionModelBase.js","../../toad.js/lib/src/model/EnumModel.js","../../toad.js/lib/src/view/View.js","../../toad.js/lib/src/view/ModelView.js","../../toad.js/lib/src/view/ActionView.js","../../toad.js/lib/src/style/tx-text.js","../../toad.js/lib/src/view/Text.js","../../toad.js/lib/src/view/textAreaStyle.js","../../toad.js/lib/src/view/TextTool.js","../../toad.js/lib/src/view/TextArea.js","../../toad.js/lib/src/view/Display.js","../../toad.js/lib/src/style/tx-button.js","../../toad.js/lib/src/view/Button.js","../../toad.js/lib/src/view/BooleanView.js","../../toad.js/lib/src/style/tx-checkbox.js","../../toad.js/lib/src/view/Checkbox.js","../../toad.js/lib/src/style/tx-search.js","../../toad.js/lib/src/view/Search.js","../../toad.js/lib/src/style/tx-switch.js","../../toad.js/lib/src/view/Switch.js","../../toad.js/lib/src/style/tx-radio.js","../../toad.js/lib/src/view/RadioButton.js","../../toad.js/lib/src/menu/MenuState.js","../../toad.js/lib/src/menu/MenuHelper.js","../../toad.js/lib/src/menu/PopupMenu.js","../../toad.js/lib/src/style/tx-combobox.js","../../toad.js/lib/src/style/tx-menu.js","../../toad.js/lib/src/view/Select.js","../../toad.js/lib/src/style/tx-slider.js","../../toad.js/lib/src/view/Slider.js","../../toad.js/lib/src/view/GenericTool.js","../../toad.js/lib/src/view/ToolButton.js","../../toad.js/lib/src/view/SlotView.js","../../toad.js/lib/src/view/ToadIf.js","../../toad.js/lib/src/style/tx-tabs.js","../../toad.js/lib/src/view/Tab.js","../../toad.js/lib/src/menu/menuStyle.js","../../toad.js/lib/src/menu/MenuButton.js","../../toad.js/lib/src/menu/MenuNode.js","../../toad.js/lib/src/menu/Menu.js","../../toad.js/lib/src/menu/MenuSpacer.js","../../toad.js/lib/src/table/model/TableModel.js","../../toad.js/lib/src/table/TableEditMode.js","../../toad.js/lib/src/table/adapter/TableAdapter.js","../../toad.js/lib/src/table/TableEventType.js","../../toad.js/lib/src/table/TablePos.js","../../toad.js/lib/src/table/model/SelectionModel.js","../../toad.js/lib/src/table/model/TypedTableModel.js","../../toad.js/lib/src/table/private/TableFriend.js","../../toad.js/lib/src/table/private/TableAnimation.js","../../toad.js/lib/src/table/private/InsertAnimation.js","../../toad.js/lib/src/table/private/InsertRowAnimation.js","../../toad.js/lib/src/table/private/RemoveRowAnimation.js","../../toad.js/lib/src/table/private/InsertColumnAnimation.js","../../toad.js/lib/src/table/private/RemoveColumnAnimation.js","../../toad.js/lib/src/util/scrollIntoView.js","../../toad.js/lib/src/table/style/tx-table.js","../../toad.js/lib/src/table/Table.js","../../toad.js/lib/src/table/TableTool.js","../../toad.js/lib/src/table/adapter/TypedTableAdapter.js","../../toad.js/lib/src/table/TableEvent.js","../../toad.js/lib/src/table/model/TreeModel.js","../../toad.js/lib/src/table/adapter/TreeAdapter.js","../../toad.js/lib/src/table/model/TreeNodeModel.js","../src/modifier/Modifier.ts","../src/modifier/ManagedTargetModifier.ts","../src/modifier/TargetRef.ts","../src/modifier/findTargets.ts","../src/modifier/MacroModifier.ts","../src/modifier/findMacroDependencies.ts","../src/modifier/EthnicModifier.ts","../src/modifier/UniversalModifier.ts","../src/modifier/loadModifiers.ts","../src/modifier/loadSliders.ts","../src/mesh/Mesh.ts","../src/mesh/WavefrontObj.ts","../src/mesh/HumanMesh.ts","../src/Mode.ts","../node_modules/fflate/esm/browser.js","../src/Mesh.ts","../src/filesystem/HTTPFSAdapter.ts","../src/lib/calculateNormals.ts","../src/render.ts","../src/skeleton/poseView.tsx","../src/modifier/morphView.tsx","../src/mesh/Collada.ts","../src/main.tsx"],"sourcesContent":["export class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map(a => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        while (element.childNodes.length > 0) {\n            element.removeChild(element.childNodes[element.childNodes.length - 1]);\n        }\n        this.appendTo(element);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== 'string') {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case 'children':\n                break;\n            case 'action':\n                element.setAction(value);\n                break;\n            case 'model':\n                element.setModel(value);\n                break;\n            case 'class':\n                element.classList.add(value);\n                break;\n            case 'style':\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case 'set':\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substr(2), value);\n                }\n                else {\n                    if (typeof value !== \"object\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        for (let child of props.children) {\n            if (typeof child === \"string\") {\n                element.appendChild(document.createTextNode(child));\n            }\n            else {\n                element.appendChild(child);\n            }\n        }\n    }\n}\nexport function createElement(nameOrConstructor, props, ...children) {\n    let key;\n    if (props !== null) {\n        if ('key' in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","export class SignalLink {\n    constructor(callback, id) {\n        this.callback = callback;\n        this.id = id;\n    }\n}\nexport class Signal {\n    add(callback, id) {\n        if (!this.callbacks)\n            this.callbacks = new Array();\n        this.callbacks.push(new SignalLink(callback, id));\n    }\n    remove(id) {\n        if (!this.callbacks)\n            return;\n        for (let i = this.callbacks.length - 1; i >= 0; --i) {\n            if (this.callbacks[i].id === id)\n                this.callbacks.splice(i, 1);\n        }\n    }\n    count() {\n        if (!this.callbacks)\n            return 0;\n        return this.callbacks.length;\n    }\n    lock() {\n        this.locked = true;\n    }\n    unlock() {\n        this.locked = undefined;\n        if (this.triggered) {\n            let data = this.triggered.data;\n            this.triggered = undefined;\n            this.trigger(data);\n        }\n    }\n    trigger(data) {\n        if (this.locked) {\n            this.triggered = { data: data };\n            return;\n        }\n        if (!this.callbacks)\n            return;\n        for (let i = 0; i < this.callbacks.length; ++i)\n            this.callbacks[i].callback(data);\n    }\n}\n//# sourceMappingURL=Signal.js.map","import { Signal } from \"../Signal.js\";\nexport class Model {\n    constructor() {\n        this._enabled = true;\n        this.modified = new Signal();\n    }\n    set enabled(enabled) {\n        if (this._enabled == enabled)\n            return;\n        this._enabled = enabled;\n        this.modified.trigger(undefined);\n    }\n    get enabled() {\n        return this._enabled;\n    }\n}\n//# sourceMappingURL=Model.js.map","import { Model } from \"./Model.js\";\nexport class GenericModel extends Model {\n    constructor(value) {\n        super();\n        this._value = value;\n    }\n    set value(value) {\n        if (this._value == value)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n}\n//# sourceMappingURL=GenericModel.js.map","import { GenericModel } from \"./GenericModel.js\";\nexport class NumberModel extends GenericModel {\n    constructor(value, options) {\n        super(value);\n        if (options) {\n            this.min = options.min;\n            this.max = options.max;\n            this.step = options.step;\n        }\n    }\n    increment() {\n        if (this.step !== undefined) {\n            this.value += this.step;\n        }\n    }\n    decrement() {\n        if (this.step !== undefined) {\n            this.value -= this.step;\n        }\n    }\n    get value() {\n        return super.value;\n    }\n    set value(value) {\n        if (this.min !== undefined) {\n            if (value < this.min) {\n                value = this.min;\n            }\n        }\n        if (this.max !== undefined) {\n            if (value > this.max) {\n                value = this.max;\n            }\n        }\n        super.value = value;\n    }\n}\n//# sourceMappingURL=NumberModel.js.map","import { Modifier } from './modifier/Modifier'\nimport { NumberModel } from 'toad.js/model/NumberModel'\nimport { Signal } from 'toad.js/Signal'\nimport { WavefrontObj } from 'mesh/WavefrontObj'\nimport { Skeleton } from \"skeleton/Skeleton\"\n\n// shared/animation.py\n/**\n * Manages skeletal animation for a mesh or multiple meshes.\n * Multiple meshes can be added each with their specific bone-to-vertex mapping\n * to make it possible to play back the same animation on a skeleton attached\n * to multiple meshes.\n */\nclass AnimatedMesh {\n    // for now only one mesh, the base mesh\n    meshData!: WavefrontObj\n    __skeleton!: Skeleton\n\n    getRestCoordinates(name: string) {\n        // rIdx = self._getBoundMeshIndex(name)\n        // return self.__originalMeshCoords[rIdx][:,:3]\n        if (name != this.meshData.name) {\n            throw Error(`AnimatedMesh.getRestCoordinates('${name}'): no such mesh`)\n        }\n        return this.meshData.vertex\n    }\n    setBaseSkeleton(skel: Skeleton) {\n        this.__skeleton = skel\n        // self.removeAnimations(update=False)\n        // self.resetCompiledWeights()\n    }\n    // isPosed() {\n    //     return true\n    // }\n    // _pose() {\n    //     if (this.isPosed()) {\n    //         // this.__skeleton.skinMesh(self.__originalMeshCoords[idx], self.__vertexToBoneMaps[idx].data)\n    //         const mesh = this.meshData\n    //         const posedCoords = this.__skeleton.skinMesh(\n    //             mesh.vertex,\n    //             this.__skeleton.vertexWeights!._data\n    //         )\n    //         this._updateMeshVerts(mesh, posedCoords)\n    //     } else {\n    //         throw Error(`Not implemented yet.`)\n    //     }\n    // }\n    // _updateMeshVerts(mesh: WavefrontObj, verts: number[]) {\n    //     NOTE: we should only send one message to mesh, doing three calls violates information hiding\n    //     mesh.changeCoords(verts)\n    //     mesh.calcNormals()\n    //     mesh.update()\n    // }\n}\n\n// apps/human.py class Human\nexport class Human extends AnimatedMesh {\n    private static instance?: Human\n    static getInstance(): Human {\n        if (Human.instance === undefined)\n            Human.instance = new Human()\n        return Human.instance\n    }\n\n    modified = new Signal()\n\n    private modifiers: Map<string, Modifier>\n    private modifierGroups: Map<string, Modifier[]>\n\n    // for now HumanMesh is our quick'n dirty friend\n    public targetsDetailStack: Map<string, number>\n\n    // values to be edited by the macro/ethnic modifiers\n    age = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    gender = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    weight = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    muscle = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    height = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    breastSize = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    breastFirmness = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n    bodyProportions = new NumberModel(0.5, { min: 0, max: 1, step: 0.05 })\n\n    // all variables suffixed with 'Val' will be read by ManagedTargetModifier.getFactors()\n    caucasianVal = new NumberModel(1 / 3, { min: 0, max: 1, step: 0.05 })\n    asianVal = new NumberModel(1 / 3, { min: 0, max: 1, step: 0.05 })\n    africanVal = new NumberModel(1 / 3, { min: 0, max: 1, step: 0.05 })\n\n    // the above values are transformed into the values below,\n    // which are then used by the modifiers\n    private maleVal = new NumberModel(0)\n    private femaleVal = new NumberModel(0)\n    private oldVal = new NumberModel(0)\n    private babyVal = new NumberModel(0)\n    private youngVal = new NumberModel(0)\n    private childVal = new NumberModel(0)\n    private maxweightVal = new NumberModel(0)\n    private minweightVal = new NumberModel(0)\n    private averageweightVal = new NumberModel(0)\n    private maxmuscleVal = new NumberModel(0)\n    private minmuscleVal = new NumberModel(0)\n    private averagemuscleVal = new NumberModel(0)\n    private maxheightVal = new NumberModel(0)\n    private minheightVal = new NumberModel(0)\n    private averageheightVal = new NumberModel(0)\n    private maxcupVal = new NumberModel(0)\n    private mincupVal = new NumberModel(0)\n    private averagecupVal = new NumberModel(0)\n    private maxfirmnessVal = new NumberModel(0)\n    private minfirmnessVal = new NumberModel(0)\n    private averagefirmnessVal = new NumberModel(0)\n    private idealproportionsVal = new NumberModel(0)\n    private uncommonproportionsVal = new NumberModel(0)\n    private regularproportionsVal = new NumberModel(0)\n\n    constructor() {\n        super()\n        this._setDependendValues()\n\n        this.gender.modified.add(() => this._setGenderVals())\n        this.age.modified.add(() => this._setAgeVals())\n        this.muscle.modified.add(() => this._setMuscleVals())\n        this.weight.modified.add(() => this._setWeightVals())\n        this.height.modified.add(() => this._setHeightVals())\n        this.breastSize.modified.add(() => this._setBreastSizeVals())\n        this.breastFirmness.modified.add(() => this._setBreastFirmnessVals())\n        this.bodyProportions.modified.add(() => this._setBodyProportionVals())\n        this.africanVal.modified.add(() => this._setEthnicVals(\"African\"))\n        this.asianVal.modified.add(() => this._setEthnicVals(\"Asian\"))\n        this.caucasianVal.modified.add(() => this._setEthnicVals(\"Caucasian\"))\n\n        this.modifiers = new Map<string, Modifier>()\n        this.modifierGroups = new Map<string, Modifier[]>()\n        this.targetsDetailStack = new Map()\n    }\n\n    getModifier(name: string): Modifier | undefined {\n        return this.modifiers.get(name)\n    }\n\n    getModifiersByGroup(groupName: string): Modifier[] {\n        const group = this.modifierGroups.get(groupName)\n        if (group === undefined) {\n            console.log(`Modifier group ${groupName} does not exist.`)\n            return []\n        }\n        return group\n    }\n\n    addModifier(modifier: Modifier) {\n        // console.log(`Human.addModifier(${modifier.fullName})`)\n        //         if modifier.fullName in self._modifiers:\n        if (this.modifiers.has(modifier.fullName)) {\n            //             log.error(\"Modifier with name %s is already attached to human.\", modifier.fullName)\n            //             raise RuntimeError(\"Modifier with name %s is already attached to human.\" % modifier.fullName)\n            throw Error(`Modifier with name ${modifier.fullName} is already attached to human.`)\n        }\n\n        //         self._modifier_type_cache = dict()\n        //         self._modifiers[modifier.fullName] = modifier\n        this.modifiers.set(modifier.fullName, modifier)\n\n        //         if modifier.groupName not in self._modifier_groups:\n        if (!this.modifierGroups.has(modifier.groupName)) {\n            //             self._modifier_groups[modifier.groupName] = []\n            this.modifierGroups.set(modifier.groupName, new Array<Modifier>())\n        }\n\n        //         self._modifier_groups[modifier.groupName].append(modifier)\n        this.modifierGroups.get(modifier.groupName)!.push(modifier)\n\n        //         # Update dependency mapping\n        //         if modifier.macroVariable and modifier.macroVariable != 'None':\n        //             if modifier.macroVariable in self._modifier_varMapping and \\\n        //                self._modifier_varMapping[modifier.macroVariable] != modifier.groupName:\n        //                 log.error(\"Error, multiple modifier groups setting var %s (%s and %s)\", modifier.macroVariable, modifier.groupName, self._modifier_varMapping[modifier.macroVariable])\n        //             else:\n        //                 self._modifier_varMapping[modifier.macroVariable] = modifier.groupName\n        //                 # Update any new backwards references that might be influenced by this change (to make it independent of order of adding modifiers)\n        //                 toRemove = set()  # Modifiers to remove again from backwards map because they belogn to the same group as the modifier controlling the var\n        //                 dep = modifier.macroVariable\n        //                 for affectedModifierGroup in self._modifier_dependencyMapping.get(dep, []):\n        //                     if affectedModifierGroup == modifier.groupName:\n        //                         toRemove.add(affectedModifierGroup)\n        //                         #log.debug('REMOVED from backwards map again %s', affectedModifierGroup)\n        //                 if len(toRemove) > 0:\n        //                     if len(toRemove) == len(self._modifier_dependencyMapping[dep]):\n        //                         del self._modifier_dependencyMapping[dep]\n        //                     else:\n        //                         for t in toRemove:\n        //                             self._modifier_dependencyMapping[dep].remove(t)\n        //         for dep in modifier.macroDependencies:\n        //             groupName = self._modifier_varMapping.get(dep, None)\n        //             if groupName and groupName == modifier.groupName:\n        //                 # Do not include dependencies within the same modifier group\n        //                 # (this step might be omitted if the mapping is still incomplete (dependency is not yet mapped to a group), and can later be fixed by removing the entry again from the reverse mapping)\n        //                 continue\n        //             if dep not in self._modifier_dependencyMapping:\n        //                 self._modifier_dependencyMapping[dep] = []\n        //             if modifier.groupName not in self._modifier_dependencyMapping[dep]:\n        //                 self._modifier_dependencyMapping[dep].append(modifier.groupName)\n        //             if modifier.isMacro():\n        //                 self.updateMacroModifiers()\n    }\n\n    setDetail(targetName: string, value: number | undefined) {\n        // NOTE: no 'name=canonicalpath(name)' as the host filesystem is a detail to be ignored in the domain core\n        // console.log(`Human.setDetail('${name}', ${value})`)\n        if (value !== undefined) { // TODO: check if '&& isZero(value)' is a valid optimization\n            this.targetsDetailStack.set(targetName, value)\n        } else {\n            this.targetsDetailStack.delete(targetName)\n        }\n    }\n\n    getDetail(targetName: string): number {\n        // NOTE: no 'name=canonicalpath(name)' as the host filesystem is a detail to be ignored in the domain core\n        let value = this.targetsDetailStack.get(targetName)\n        if (value === undefined)\n            value = 0\n        // console.log(`Human.getDetail('${name}') -> ${value}`)\n        return value\n    }\n\n    setDefaultValues() {\n        this.age.value = 0.5\n        this.gender.value = 0.5\n        this.weight.value = 0.5\n        this.muscle.value = 0.5\n        this.height.value = 0.5\n        this.breastSize.value = 0.5\n        this.breastFirmness.value = 0.5\n        this.bodyProportions.value = 0.5\n        this.caucasianVal.value = 1 / 3\n        this.asianVal.value = 1 / 3\n        this.africanVal.value = 1 / 3\n        this._setDependendValues()\n    }\n\n    _setDependendValues() {\n        this._setGenderVals()\n        this._setAgeVals()\n        this._setWeightVals()\n        this._setMuscleVals()\n        this._setHeightVals()\n        this._setBreastSizeVals()\n        this._setBreastFirmnessVals()\n        this._setBodyProportionVals()\n    }\n\n    _setGenderVals() {\n        this.maleVal.value = this.gender.value\n        this.femaleVal.value = 1 - this.gender.value\n    }\n\n    _setAgeVals() {\n        // New system (A8):\n        // ----------------\n        //\n        // 1y       10y       25y            90y\n        // baby    child     young           old\n        // |---------|---------|--------------|\n        // 0      0.1875      0.5             1  = age [0, 1]\n        //\n        // val ^     child young     old\n        //   1 |baby\\ / \\ /   \\    /\n        //     |     \\   \\      /\n        //     |    / \\ / \\  /    \\ young\n        //   0 ______________________________> age\n        //        0  0.1875 0.5      1\n        if (this.age.value < 0.5) {\n            this.oldVal.value = 0.0\n            this.babyVal.value = Math.max(0.0, 1 - this.age.value * 5.333)  // 1/0.1875 = 5.333\n            this.youngVal.value = Math.max(0.0, (this.age.value - 0.1875) * 3.2) // 1/(0.5-0.1875) = 3.2\n            this.childVal.value = Math.max(0.0, Math.min(1.0, 5.333 * this.age.value) - this.youngVal.value)\n        } else {\n            this.childVal.value = 0.0\n            this.babyVal.value = 0.0\n            this.oldVal.value = Math.max(0.0, this.age.value * 2 - 1)\n            this.youngVal.value = 1 - this.oldVal.value\n        }\n    }\n\n    _setWeightVals() {\n        this.maxweightVal.value = Math.max(0.0, this.weight.value * 2 - 1)\n        this.minweightVal.value = Math.max(0.0, 1 - this.weight.value * 2)\n        this.averageweightVal.value = 1 - (this.maxweightVal.value + this.minweightVal.value)\n    }\n\n    _setMuscleVals() {\n        this.maxmuscleVal.value = Math.max(0.0, this.muscle.value * 2 - 1)\n        this.minmuscleVal.value = Math.max(0.0, 1 - this.muscle.value * 2)\n        this.averagemuscleVal.value = 1 - (this.maxmuscleVal.value + this.minmuscleVal.value)\n    }\n\n    _setHeightVals() {\n        this.maxheightVal.value = Math.max(0.0, this.height.value * 2 - 1)\n        this.minheightVal.value = Math.max(0.0, 1 - this.height.value * 2)\n        if (this.maxheightVal.value > this.minheightVal.value) {\n            this.averageheightVal.value = 1 - this.maxheightVal.value\n        } else {\n            this.averageheightVal.value = 1 - this.minheightVal.value\n        }\n    }\n\n    _setBreastSizeVals() {\n        this.maxcupVal.value = Math.max(0.0, this.breastSize.value * 2 - 1)\n        this.mincupVal.value = Math.max(0.0, 1 - this.breastSize.value * 2)\n        if (this.maxcupVal.value > this.mincupVal.value) {\n            this.averagecupVal.value = 1 - this.maxcupVal.value\n        } else {\n            this.averagecupVal.value = 1 - this.mincupVal.value\n        }\n    }\n\n    _setBreastFirmnessVals() {\n        this.maxfirmnessVal.value = Math.max(0.0, this.breastFirmness.value * 2 - 1)\n        this.minfirmnessVal.value = Math.max(0.0, 1 - this.breastFirmness.value * 2)\n\n        if (this.maxfirmnessVal.value > this.minfirmnessVal.value) {\n            this.averagefirmnessVal.value = 1 - this.maxfirmnessVal.value\n        } else {\n            this.averagefirmnessVal.value = 1 - this.minfirmnessVal.value\n        }\n    }\n\n    _setBodyProportionVals() {\n        this.idealproportionsVal.value = Math.max(0.0, this.bodyProportions.value * 2 - 1)\n        this.uncommonproportionsVal.value = Math.max(0.0, 1 - this.bodyProportions.value * 2)\n\n        if (this.idealproportionsVal > this.uncommonproportionsVal) {\n            this.regularproportionsVal.value = 1 - this.idealproportionsVal.value\n        } else {\n            this.regularproportionsVal.value = 1 - this.uncommonproportionsVal.value\n        }\n    }\n\n    flag = false\n    _setEthnicVals(exclude: undefined | \"African\" | \"Asian\" | \"Caucasian\") {\n        if (this.flag)\n            return\n        this.flag = true\n        this.africanVal.modified.lock()\n        this.asianVal.modified.lock()\n        this.caucasianVal.modified.lock()\n        this._setEthnicValsCore(exclude)\n        this.africanVal.modified.unlock()\n        this.asianVal.modified.unlock()\n        this.caucasianVal.modified.unlock()\n        this.flag = false\n    }\n\n    protected _setEthnicValsCore(exclude: undefined | \"African\" | \"Asian\" | \"Caucasian\") {\n        let remaining = 1\n        let otherTotal = 0\n        if (exclude !== \"African\") {\n            otherTotal += this.africanVal.value\n        } else {\n            remaining -= this.africanVal.value\n        }\n        if (exclude !== \"Asian\") {\n            otherTotal += this.asianVal.value\n        } else {\n            remaining -= this.asianVal.value\n        }\n        if (exclude !== \"Caucasian\") {\n            otherTotal += this.caucasianVal.value\n        } else {\n            remaining -= this.caucasianVal.value\n        }\n\n        if (otherTotal === 0) {\n            if (exclude === undefined) {\n                // All values 0, this cannot be. Reset to default values.\n                this.caucasianVal.value = 1 / 3\n                this.asianVal.value = 1 / 3\n                this.africanVal.value = 1 / 3\n            }\n            else if (Math.abs(remaining) < 0.001) {\n                // One ethnicity is 1, the rest is 0\n                if (exclude !== \"African\") {\n                    this.africanVal.value = 1\n                } else {\n                    this.africanVal.value = 0\n                }\n                if (exclude !== \"Asian\") {\n                    this.asianVal.value = 1\n                } else {\n                    this.asianVal.value = 0\n                }\n                if (exclude !== \"Caucasian\") {\n                    this.caucasianVal.value = 1\n                } else {\n                    this.caucasianVal.value = 0\n                }\n            } else {\n                // Increase values of other ethnicities (that were 0) to hit total sum of 1\n                if (exclude !== \"African\") {\n                    this.africanVal.value = 0.01\n                }\n                if (exclude !== \"Asian\") {\n                    this.asianVal.value = 0.01\n                }\n                if (exclude !== \"Caucasian\") {\n                    this.caucasianVal.value = 0.01\n                }\n                this._setEthnicValsCore(exclude)\n            }\n        } else {\n            if (exclude !== \"African\") {\n                this.africanVal.value = remaining * this.africanVal.value / otherTotal\n            }\n            if (exclude !== \"Asian\") {\n                this.asianVal.value = remaining * this.asianVal.value / otherTotal\n            }\n            if (exclude !== \"Caucasian\") {\n                this.caucasianVal.value = remaining * this.caucasianVal.value / otherTotal\n            }\n        }\n    }\n\n    updateProxyMesh(fitToPosed = false) {\n        // console.log(\"Human.updateProxyMesh with:\")\n        this.modified.trigger()\n        // this.targetsDetailStack.forEach( (value, targetName) => console.log(`${targetName}=${value}`) )\n        // if self.proxy and self.__proxyMesh:\n        //     self.proxy.update(self.__proxyMesh, fit_to_posed)\n        //     self.__proxyMesh.update()\n    }\n\n    // Retrieve human seed mesh vertex coordinates in rest pose.\n    getRestposeCoordinates() {\n        return this.getRestCoordinates(this.meshData.name)\n    }\n\n    override setBaseSkeleton(skel: Skeleton) {\n        // self.callEvent('onChanging', events3d.HumanEvent(self, 'skeleton'))\n        // animation.AnimatedMesh.setBaseSkeleton(self, skel)\n        super.setBaseSkeleton(skel)\n\n        // self.updateVertexWeights(skel.getVertexWeights() if skel else None)\n        // self.callEvent('onChanged', events3d.HumanEvent(self, 'skeleton'))\n        // self.refreshPose()\n    }\n}\n","\nexport class StringToLineIterator implements Iterator<string> {\n    private data: string\n    private index: number\n\n    constructor(data: string) {\n        this.data = data\n        this.index = 0\n    }\n\n    next(): IteratorResult<string> {\n        if (this.data.length === 0 || this.index === -1)\n            return { value: undefined, done: true }\n        const nextIndex = this.data.indexOf('\\n', this.index)\n        let length: number | undefined\n        if (nextIndex === -1) {\n            length = undefined\n        } else {\n            length = nextIndex - this.index\n        }\n        const result = this.data.substr(this.index, length)\n        if (nextIndex === -1) {\n            this.index = -1\n        } else {\n            this.index = nextIndex + 1\n        }\n        return { value: result, done: false }\n    }\n\n}\n","import { StringToLineIterator } from './StringToLineIterator'\n\nexport class StringToLine implements Iterable<string> {\n    data: string;\n    constructor(data: string) {\n        this.data = data\n    }\n\n    [Symbol.iterator](): Iterator<string> {\n        return new StringToLineIterator(this.data)\n    }\n}\n","import { AbstractFileSystemAdapter } from './AbstractFileSystemAdapter'\n\nexport class FileSystemAdapter {\n    private static instance?: AbstractFileSystemAdapter\n    static setInstance(instance: AbstractFileSystemAdapter) {\n        FileSystemAdapter.instance = instance\n    }\n    static getInstance(): AbstractFileSystemAdapter {\n        if (FileSystemAdapter.instance === undefined)\n            throw Error('Missing call to FileSystemAdapter.setInstance(instance: AbstractFilesystemAdapter).')\n        return FileSystemAdapter.instance\n    }\n}\n","import { StringToLine } from '../lib/StringToLine'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\n\n// import { vec3 } from 'gl-matrix'\n\n// lib/targets.py\n// getTargets()\n\n// FILE: data/modifiers/modeling_modifiers.json\n// points to the files in the data/targets/ directory: data/targets/<group>/<target>-(<min>|<max>).target\n//\n// [\n// {\n//    \"group\": \"<group>\"\n//    \"modifiers\": [\n//       { \"macrovar\": \"<name>\" [, \"modifierType\": \"EthnicModifier\"]\n//       { \"target\": \"<target>\", \"min\": \"<min>\", \"max\": \"<max>\" },\n//    ]\n// }\n// ]\n//\n// \n// data/targets/macrodetails/(african|asian|caucasian)-(male|female)-(baby|child|young|old).target\n// data/targets/macrodetails/universal-(male|female)-(baby|child|young|old)-(minweight|averageweight|maxweight).target\n// data/targets/macrodetails/height/(male|female)-(minmuscle|averagemuscle|maxmuscle)-(minweight|averageweight|maxweight)-(minheight|maxheight).target\n// data/targets/macrodetails/proportions/(male|female)-(minmuscle|averagemuscle|maxmuscle)-(minweight|averageweight|maxweight)-(idealproportions|uncommonproportions).target\n// FILE: data/modifiers/modeling_modifiers_desc.json\n// additional description for the UI\n//\n// FILE: data/modifiers/modeling_sliders.json\n//\n// ./compile_targets.py: create a binary representation of the target files?\n// ./lib/targets.py    : load target files?\n// apps/human.py\n// apps/compat.py\n// apps/devtests.py\n// apps/humanmodifier.py\n// apps/warpmodifier.py\n// core/algos3d.py: class Target!\n// number: 64bit double float\n// should use these instead to save memory and to improve performance:\n// Int8Array, Uint8Array, Uint8ClampedArray, Int16Array, Uint16Array, Int32Array, Uint32Array\n// Float32Array, Float64Array\n// BigInt64Array, BigUint64Array\n\n// morph target\nexport class Target {\n    verts: Array<number>; // x, y, z\n    data: Array<number>; // index\n\n    constructor() {\n        this.verts = new Array<number>()\n        this.data = new Array<number>()\n    }\n\n    load(filename: string) {\n        const data = FileSystemAdapter.getInstance().readFile(filename)\n        // index x y, z\n        const reader = new StringToLine(data)\n        //  const reader = readline.createInterface(input)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            // console.log(line)\n            line = line.trim()\n            if (line.length === 0)\n                continue\n            if (line[0] === '#')\n                continue\n            const tokens = line.split(/\\s+/)\n            this.data.push(parseInt(tokens[0], 10))\n            this.verts.push(parseFloat(tokens[1]))\n            this.verts.push(parseFloat(tokens[2]))\n            this.verts.push(parseFloat(tokens[3]))\n        }\n    }\n\n    apply(verts: number[], scale: number) {\n        // console.log(`morphing ${this.data.length} vertices by ${scale}`)\n        let dataIndex = 0, vertexIndex = 0\n        while(dataIndex < this.data.length) {\n            let index = this.data[dataIndex++] * 3\n            verts[index++] += this.verts[vertexIndex++] * scale\n            verts[index++] += this.verts[vertexIndex++] * scale\n            verts[index++] += this.verts[vertexIndex++] * scale\n        }\n    }\n}\n","// _cat_data\nconst categoryData = {\n    // category        values\n    'gender':          ['male', 'female'],\n    'age':             ['baby', 'child', 'young', 'old'],\n    'race':            ['caucasian', 'asian', 'african'],\n    'muscle':          ['maxmuscle', 'averagemuscle', 'minmuscle'],\n    'weight':          ['minweight', 'averageweight', 'maxweight'],\n    'height':          ['minheight', 'averageheight', 'maxheight'],\n    'breastsize':      ['mincup', 'averagecup', 'maxcup'],\n    'breastfirmness':  ['minfirmness', 'averagefirmness', 'maxfirmness'],\n    'bodyproportions': ['uncommonproportions', 'regularproportions', 'idealproportions']\n}\n// _categories\nexport const validCategories = new Array<string>()\n// _value_cat\nexport const valueToCategory = new Map<string, string>()\n\nfor(const category in categoryData) {\n    if (!categoryData.hasOwnProperty(category))\n        continue\n    validCategories.push(category)\n    // tslint:disable-next-line: forin\n    for(const value of (categoryData as any)[category]) {\n        valueToCategory.set(value, category)\n    }\n}\n\nexport class Component {\n    path?: string\n    parent?: Component\n\n    // the target's file name is split into parts.\n    // if the part belongs to a category, it is stored in ...\n    data: Map<string, string|undefined> // Map<category, value>\n    // ... otherwise it is stored in ...\n    key: string[] // values (TargetsCrawler sorts the directory content so that the keys in here are sorted)\n\n    constructor(parent?: Component) {\n        this.parent = parent\n        if (parent === undefined) {\n            this.key = new Array<string>()\n            this.data = new Map<string, string|undefined>()\n        } else {\n            this.key = parent.key.slice()\n            this.data = new Map(parent.data)\n        }\n    }\n\n    isRoot(): boolean {\n        return this.parent === undefined\n    }\n\n    createChild(): Component {\n        return new Component(this)\n    }\n\n    update(value: string) {\n        const category = valueToCategory.get(value)\n        if (category !== undefined) {\n            this.setData(category, value)\n        } else\n        if (value !== 'target') {\n            this.addKey(value)\n        }\n    }\n\n    tuple(): string {\n        let s = ''\n        for(const key of this.key) {\n            if (s.length !== 0)\n                s += '-'\n            s += key\n        }\n        return s\n    }\n\n    getVariables(): string[] {\n        // return [value for key,value in list(self.data.items()) if value != None]\n        const result = []\n        for(const [key, value] of this.data.entries()) {\n            if (value !== undefined)\n                result.push(value)\n        }\n        return result\n    }\n\n    private addKey(key: string) {\n        this.key.push(key)\n    }\n\n    private setData(category: string, value: string) {\n        this.data = new Map(this.data)\n        const orig = this.data.get(category)\n        if (orig !== undefined) {\n            if (orig !== value)\n                throw Error(`Component category ${category} can not be set to ${value} as it is already been set to ${orig}`)\n            return\n        }\n        this.data.set(category, value)\n    }\n\n    finish(pathname: string) {\n        this.path = pathname\n        for(const category of validCategories) {\n            if (!this.data.has(category))\n                this.data.set(category, undefined)\n        }\n    }\n}\n","import { Target } from './Target'\nimport { Component} from './Component'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\n\n\n// what's inside TargetFactory:\n//   groups: Map<target name, Component>\n//      \"buttocks-buttocks-volume-decr\"\n///       parent: key: [\"buttocks\"]\n//        key: the name splitted at '-'\n//        data: gender, age, race, muscle, weight, height, breastsize, breastfirmness, bodypropotions: all undefined\n//        path: \"/targets/buttocks/buttocks-volume-decr.target\"\n//   images: Map<target name, image filename>\n//   index: (superset of groups?)\n//     \"buttocks\" -> [\"buttocks-buttocks-volume-decr\", \"buttocks-buttocks-volume-incr\"]\n//     \"buttocks-buttocks-volume-decr\" -> Component\n//     \"buttocks-buttocks-volume-incr\" -> Component\n//   targets:\n//     list of all Components\n\nexport class TargetFactory {\n    rootComponent: Component\n    targets: Component[] // all components\n    groups: Map<string, Component[]> // Component.keys to Components\n    index: Map<string, (Component|string)[]>\n    images: Map<string, string> // list of all PNG files found while crawling\n\n    private constructor() {\n        this.rootComponent = new Component()\n        this.images = new Map<string, string>()\n        this.targets = new Array<Component>()\n        this.groups = new Map<string, Component[]>()\n        this.index = new Map<string, (Component|string)[]>() // Component key names to ...\n        this.loadTargetDirectory()\n        console.log(`Loaded target directory: ${this.targets.length} targets, ${this.groups.size} groups, ${this.index.size} indizes, ${this.images.size} images`)\n    }\n\n    private static instance?: TargetFactory\n    static getInstance(): TargetFactory {\n        if (TargetFactory.instance === undefined)\n            TargetFactory.instance = new TargetFactory()\n        return TargetFactory.instance\n    }\n\n    private loadTargetDirectory() {\n        this.walkTargets('', this.rootComponent)\n        this.buildIndex()\n    }\n\n    findTargets(partialGroup: string): Component[] {\n        // if isinstance(partialGroup, str):\n        //     partialGroup = tuple(partialGroup.split('-'))\n        // elif not isinstance(partialGroup, tuple):\n        //     partialGroup = tuple(partialGroup)\n        // if partialGroup not in self.index:\n        if (!this.index.has(partialGroup))\n        //     return []\n            return []\n        // result = []\n        const result = new Array<Component>()\n        // for entry in self.index[partialGroup]:\n        for (const entry of this.index.get(partialGroup)!) {\n        //     if isinstance(entry, Component):\n            if (entry instanceof Component)\n            //         result.append(entry)\n                result.push(entry)\n            //     else:\n            else\n            //         result.extend(self.findTargets(entry))\n                result.concat(this.findTargets(entry))\n        }\n        // return result\n        return result\n    }\n\n    getTargetsByGroup(group: string): Component[]|undefined {\n        return this.groups.get(group)\n    }\n\n    private walkTargets(root: string, base: Component) {\n        const fs = FileSystemAdapter.getInstance()\n        const directoryPath = fs.realPath(root)\n        const dir = fs.listDir(directoryPath).sort()\n        // console.log(`dir=${dir}`)\n        for(const name of dir) {\n            // console.log(`directoryPath='${directoryPath}', dir=${dir}, name='${name}'`)\n            const p = fs.joinPath(directoryPath, name)\n            if (fs.isFile(p) && ! p.toLowerCase().endsWith('.target')) {\n                if (p.toLowerCase().endsWith('.png')) {\n                    this.images.set(name.toLowerCase(), p)\n                }\n            } else {\n                const item = base.createChild()\n                const parts = name.replace('_', '-').replace('.', '-').split('-')\n                for(const part of parts.entries()) {\n                    if (part[0]===0 && part[1]==='targets')\n                        continue\n                    item.update(part[1])\n                }\n\n                if (fs.isDir(p)) {\n                    const nextRoot = fs.joinPath(root, name)\n                    this.walkTargets(nextRoot, item)\n                } else {\n                    item.finish(`data/${root}/${name}`)\n                    this.targets.push(item)\n                    const key = item.tuple()\n                    let a = this.groups.get(key)\n                    if (a === undefined) {\n                        a = new Array<Component>()\n                        this.groups.set(key, a)\n                    }\n                    a!.push(item)\n                }\n            }\n        }\n    }\n\n    private buildIndex() {\n        for(const target of this.targets) {\n            if (!this.index.has(target.tuple())) {\n                this.index.set(target.tuple(), [])\n            }\n            this.index.get(target.tuple())!.push(target)\n            let component = target\n            while(component.parent !== undefined) {\n                const parent = component.parent\n                if (!this.index.has(parent.tuple())) {\n                    this.index.set(parent.tuple(), new Array<Component|string>())\n                }\n                if (component.tuple() !== parent.tuple() &&\n                     !this.index.get(parent.tuple())!.includes(component.tuple()) ) {\n                        this.index.get(parent.tuple())!.push(component.tuple())\n                }\n                component = parent\n            }\n        }\n    }\n}\n\n\n// class FaceGroup // a group of faces with a unique name\n\n// class Object3D\n\n// FROM: core/algos3d.py\n// filename to target?\nconst targetBuffer = new Map<string, Target>()\n\nexport function getTarget(filename: string) {\n    let target = targetBuffer.get(filename)\n    if (target !== undefined)\n        return target\n    target = new Target() // Target(3DObject, filename)\n    target.load(filename)\n    targetBuffer.set(filename, target)\n    return target\n}\n\nexport function refreshCachedTarget(filename: string) {\n    if (targetBuffer.has(filename))\n        targetBuffer.delete(filename)\n}\n","/**\n * Common utilities\n * @module glMatrix\n */\n// Configuration Constants\nexport var EPSILON = 0.000001;\nexport var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;\nexport var RANDOM = Math.random;\n/**\n * Sets the type of array used when creating new vectors and matrices\n *\n * @param {Float32ArrayConstructor | ArrayConstructor} type Array type, such as Float32Array or Array\n */\n\nexport function setMatrixArrayType(type) {\n  ARRAY_TYPE = type;\n}\nvar degree = Math.PI / 180;\n/**\n * Convert Degree To Radian\n *\n * @param {Number} a Angle in Degrees\n */\n\nexport function toRadian(a) {\n  return a * degree;\n}\n/**\n * Tests whether or not the arguments have approximately the same value, within an absolute\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\n * than or equal to 1.0, and a relative tolerance is used for larger values)\n *\n * @param {Number} a The first number to test.\n * @param {Number} b The second number to test.\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));\n}\nif (!Math.hypot) Math.hypot = function () {\n  var y = 0,\n      i = arguments.length;\n\n  while (i--) {\n    y += arguments[i] * arguments[i];\n  }\n\n  return Math.sqrt(y);\n};","import * as glMatrix from \"./common.js\";\n/**\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\n * @module mat4\n */\n\n/**\n * Creates a new identity mat4\n *\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(16);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = 0;\n    out[9] = 0;\n    out[11] = 0;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = 0;\n  }\n\n  out[0] = 1;\n  out[5] = 1;\n  out[10] = 1;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 initialized with values from an existing matrix\n *\n * @param {ReadonlyMat4} a matrix to clone\n * @returns {mat4} a new 4x4 matrix\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Copy the values from one mat4 to another\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  out[4] = a[4];\n  out[5] = a[5];\n  out[6] = a[6];\n  out[7] = a[7];\n  out[8] = a[8];\n  out[9] = a[9];\n  out[10] = a[10];\n  out[11] = a[11];\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Create a new mat4 with the given values\n *\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} A new mat4\n */\n\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  var out = new glMatrix.ARRAY_TYPE(16);\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set the components of a mat4 to the given values\n *\n * @param {mat4} out the receiving matrix\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\n * @returns {mat4} out\n */\n\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n  out[0] = m00;\n  out[1] = m01;\n  out[2] = m02;\n  out[3] = m03;\n  out[4] = m10;\n  out[5] = m11;\n  out[6] = m12;\n  out[7] = m13;\n  out[8] = m20;\n  out[9] = m21;\n  out[10] = m22;\n  out[11] = m23;\n  out[12] = m30;\n  out[13] = m31;\n  out[14] = m32;\n  out[15] = m33;\n  return out;\n}\n/**\n * Set a mat4 to the identity matrix\n *\n * @param {mat4} out the receiving matrix\n * @returns {mat4} out\n */\n\nexport function identity(out) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Transpose the values of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function transpose(out, a) {\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\n  if (out === a) {\n    var a01 = a[1],\n        a02 = a[2],\n        a03 = a[3];\n    var a12 = a[6],\n        a13 = a[7];\n    var a23 = a[11];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a01;\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a02;\n    out[9] = a12;\n    out[11] = a[14];\n    out[12] = a03;\n    out[13] = a13;\n    out[14] = a23;\n  } else {\n    out[0] = a[0];\n    out[1] = a[4];\n    out[2] = a[8];\n    out[3] = a[12];\n    out[4] = a[1];\n    out[5] = a[5];\n    out[6] = a[9];\n    out[7] = a[13];\n    out[8] = a[2];\n    out[9] = a[6];\n    out[10] = a[10];\n    out[11] = a[14];\n    out[12] = a[3];\n    out[13] = a[7];\n    out[14] = a[11];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Inverts a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function invert(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n\n  if (!det) {\n    return null;\n  }\n\n  det = 1.0 / det;\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\n  return out;\n}\n/**\n * Calculates the adjugate of a mat4\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the source matrix\n * @returns {mat4} out\n */\n\nexport function adjoint(out, a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);\n  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\n  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);\n  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\n  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\n  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);\n  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\n  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);\n  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);\n  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\n  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\n  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\n  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);\n  return out;\n}\n/**\n * Calculates the determinant of a mat4\n *\n * @param {ReadonlyMat4} a the source matrix\n * @returns {Number} determinant of a\n */\n\nexport function determinant(a) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15];\n  var b00 = a00 * a11 - a01 * a10;\n  var b01 = a00 * a12 - a02 * a10;\n  var b02 = a00 * a13 - a03 * a10;\n  var b03 = a01 * a12 - a02 * a11;\n  var b04 = a01 * a13 - a03 * a11;\n  var b05 = a02 * a13 - a03 * a12;\n  var b06 = a20 * a31 - a21 * a30;\n  var b07 = a20 * a32 - a22 * a30;\n  var b08 = a20 * a33 - a23 * a30;\n  var b09 = a21 * a32 - a22 * a31;\n  var b10 = a21 * a33 - a23 * a31;\n  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant\n\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\n}\n/**\n * Multiplies two mat4s\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function multiply(out, a, b) {\n  var a00 = a[0],\n      a01 = a[1],\n      a02 = a[2],\n      a03 = a[3];\n  var a10 = a[4],\n      a11 = a[5],\n      a12 = a[6],\n      a13 = a[7];\n  var a20 = a[8],\n      a21 = a[9],\n      a22 = a[10],\n      a23 = a[11];\n  var a30 = a[12],\n      a31 = a[13],\n      a32 = a[14],\n      a33 = a[15]; // Cache only the current line of the second matrix\n\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[4];\n  b1 = b[5];\n  b2 = b[6];\n  b3 = b[7];\n  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[8];\n  b1 = b[9];\n  b2 = b[10];\n  b3 = b[11];\n  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  b0 = b[12];\n  b1 = b[13];\n  b2 = b[14];\n  b3 = b[15];\n  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;\n  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;\n  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;\n  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;\n  return out;\n}\n/**\n * Translate a mat4 by the given vector\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to translate\n * @param {ReadonlyVec3} v vector to translate by\n * @returns {mat4} out\n */\n\nexport function translate(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n\n  if (a === out) {\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\n  } else {\n    a00 = a[0];\n    a01 = a[1];\n    a02 = a[2];\n    a03 = a[3];\n    a10 = a[4];\n    a11 = a[5];\n    a12 = a[6];\n    a13 = a[7];\n    a20 = a[8];\n    a21 = a[9];\n    a22 = a[10];\n    a23 = a[11];\n    out[0] = a00;\n    out[1] = a01;\n    out[2] = a02;\n    out[3] = a03;\n    out[4] = a10;\n    out[5] = a11;\n    out[6] = a12;\n    out[7] = a13;\n    out[8] = a20;\n    out[9] = a21;\n    out[10] = a22;\n    out[11] = a23;\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\n  }\n\n  return out;\n}\n/**\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {ReadonlyVec3} v the vec3 to scale the matrix by\n * @returns {mat4} out\n **/\n\nexport function scale(out, a, v) {\n  var x = v[0],\n      y = v[1],\n      z = v[2];\n  out[0] = a[0] * x;\n  out[1] = a[1] * x;\n  out[2] = a[2] * x;\n  out[3] = a[3] * x;\n  out[4] = a[4] * y;\n  out[5] = a[5] * y;\n  out[6] = a[6] * y;\n  out[7] = a[7] * y;\n  out[8] = a[8] * z;\n  out[9] = a[9] * z;\n  out[10] = a[10] * z;\n  out[11] = a[11] * z;\n  out[12] = a[12];\n  out[13] = a[13];\n  out[14] = a[14];\n  out[15] = a[15];\n  return out;\n}\n/**\n * Rotates a mat4 by the given angle around the given axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function rotate(out, a, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n  var a00, a01, a02, a03;\n  var a10, a11, a12, a13;\n  var a20, a21, a22, a23;\n  var b00, b01, b02;\n  var b10, b11, b12;\n  var b20, b21, b22;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c;\n  a00 = a[0];\n  a01 = a[1];\n  a02 = a[2];\n  a03 = a[3];\n  a10 = a[4];\n  a11 = a[5];\n  a12 = a[6];\n  a13 = a[7];\n  a20 = a[8];\n  a21 = a[9];\n  a22 = a[10];\n  a23 = a[11]; // Construct the elements of the rotation matrix\n\n  b00 = x * x * t + c;\n  b01 = y * x * t + z * s;\n  b02 = z * x * t - y * s;\n  b10 = x * y * t - z * s;\n  b11 = y * y * t + c;\n  b12 = z * y * t + x * s;\n  b20 = x * z * t + y * s;\n  b21 = y * z * t - x * s;\n  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication\n\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  }\n\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the X axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateX(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[0] = a[0];\n    out[1] = a[1];\n    out[2] = a[2];\n    out[3] = a[3];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[4] = a10 * c + a20 * s;\n  out[5] = a11 * c + a21 * s;\n  out[6] = a12 * c + a22 * s;\n  out[7] = a13 * c + a23 * s;\n  out[8] = a20 * c - a10 * s;\n  out[9] = a21 * c - a11 * s;\n  out[10] = a22 * c - a12 * s;\n  out[11] = a23 * c - a13 * s;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Y axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateY(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a20 = a[8];\n  var a21 = a[9];\n  var a22 = a[10];\n  var a23 = a[11];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged rows\n    out[4] = a[4];\n    out[5] = a[5];\n    out[6] = a[6];\n    out[7] = a[7];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c - a20 * s;\n  out[1] = a01 * c - a21 * s;\n  out[2] = a02 * c - a22 * s;\n  out[3] = a03 * c - a23 * s;\n  out[8] = a00 * s + a20 * c;\n  out[9] = a01 * s + a21 * c;\n  out[10] = a02 * s + a22 * c;\n  out[11] = a03 * s + a23 * c;\n  return out;\n}\n/**\n * Rotates a matrix by the given angle around the Z axis\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to rotate\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function rotateZ(out, a, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad);\n  var a00 = a[0];\n  var a01 = a[1];\n  var a02 = a[2];\n  var a03 = a[3];\n  var a10 = a[4];\n  var a11 = a[5];\n  var a12 = a[6];\n  var a13 = a[7];\n\n  if (a !== out) {\n    // If the source and destination differ, copy the unchanged last row\n    out[8] = a[8];\n    out[9] = a[9];\n    out[10] = a[10];\n    out[11] = a[11];\n    out[12] = a[12];\n    out[13] = a[13];\n    out[14] = a[14];\n    out[15] = a[15];\n  } // Perform axis-specific matrix multiplication\n\n\n  out[0] = a00 * c + a10 * s;\n  out[1] = a01 * c + a11 * s;\n  out[2] = a02 * c + a12 * s;\n  out[3] = a03 * c + a13 * s;\n  out[4] = a10 * c - a00 * s;\n  out[5] = a11 * c - a01 * s;\n  out[6] = a12 * c - a02 * s;\n  out[7] = a13 * c - a03 * s;\n  return out;\n}\n/**\n * Creates a matrix from a vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromTranslation(out, v) {\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a vector scaling\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.scale(dest, dest, vec);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyVec3} v Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromScaling(out, v) {\n  out[0] = v[0];\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = v[1];\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = v[2];\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a given angle around a given axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotate(dest, dest, rad, axis);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @param {ReadonlyVec3} axis the axis to rotate around\n * @returns {mat4} out\n */\n\nexport function fromRotation(out, rad, axis) {\n  var x = axis[0],\n      y = axis[1],\n      z = axis[2];\n  var len = Math.hypot(x, y, z);\n  var s, c, t;\n\n  if (len < glMatrix.EPSILON) {\n    return null;\n  }\n\n  len = 1 / len;\n  x *= len;\n  y *= len;\n  z *= len;\n  s = Math.sin(rad);\n  c = Math.cos(rad);\n  t = 1 - c; // Perform rotation-specific matrix multiplication\n\n  out[0] = x * x * t + c;\n  out[1] = y * x * t + z * s;\n  out[2] = z * x * t - y * s;\n  out[3] = 0;\n  out[4] = x * y * t - z * s;\n  out[5] = y * y * t + c;\n  out[6] = z * y * t + x * s;\n  out[7] = 0;\n  out[8] = x * z * t + y * s;\n  out[9] = y * z * t - x * s;\n  out[10] = z * z * t + c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the X axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateX(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromXRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = 1;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = c;\n  out[6] = s;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = -s;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Y axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateY(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromYRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = 0;\n  out[2] = -s;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = 1;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = s;\n  out[9] = 0;\n  out[10] = c;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from the given angle around the Z axis\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.rotateZ(dest, dest, rad);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {Number} rad the angle to rotate the matrix by\n * @returns {mat4} out\n */\n\nexport function fromZRotation(out, rad) {\n  var s = Math.sin(rad);\n  var c = Math.cos(rad); // Perform axis-specific matrix multiplication\n\n  out[0] = c;\n  out[1] = s;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = -s;\n  out[5] = c;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 1;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation and vector translation\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslation(out, q, v) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - (yy + zz);\n  out[1] = xy + wz;\n  out[2] = xz - wy;\n  out[3] = 0;\n  out[4] = xy - wz;\n  out[5] = 1 - (xx + zz);\n  out[6] = yz + wx;\n  out[7] = 0;\n  out[8] = xz + wy;\n  out[9] = yz - wx;\n  out[10] = 1 - (xx + yy);\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a new mat4 from a dual quat.\n *\n * @param {mat4} out Matrix\n * @param {ReadonlyQuat2} a Dual Quaternion\n * @returns {mat4} mat4 receiving operation result\n */\n\nexport function fromQuat2(out, a) {\n  var translation = new glMatrix.ARRAY_TYPE(3);\n  var bx = -a[0],\n      by = -a[1],\n      bz = -a[2],\n      bw = a[3],\n      ax = a[4],\n      ay = a[5],\n      az = a[6],\n      aw = a[7];\n  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense\n\n  if (magnitude > 0) {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\n  } else {\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\n  }\n\n  fromRotationTranslation(out, a, translation);\n  return out;\n}\n/**\n * Returns the translation vector component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslation,\n *  the returned vector will be the same as the translation vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive translation component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getTranslation(out, mat) {\n  out[0] = mat[12];\n  out[1] = mat[13];\n  out[2] = mat[14];\n  return out;\n}\n/**\n * Returns the scaling factor component of a transformation\n *  matrix. If a matrix is built with fromRotationTranslationScale\n *  with a normalized Quaternion paramter, the returned vector will be\n *  the same as the scaling vector\n *  originally supplied.\n * @param  {vec3} out Vector to receive scaling factor component\n * @param  {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {vec3} out\n */\n\nexport function getScaling(out, mat) {\n  var m11 = mat[0];\n  var m12 = mat[1];\n  var m13 = mat[2];\n  var m21 = mat[4];\n  var m22 = mat[5];\n  var m23 = mat[6];\n  var m31 = mat[8];\n  var m32 = mat[9];\n  var m33 = mat[10];\n  out[0] = Math.hypot(m11, m12, m13);\n  out[1] = Math.hypot(m21, m22, m23);\n  out[2] = Math.hypot(m31, m32, m33);\n  return out;\n}\n/**\n * Returns a quaternion representing the rotational component\n *  of a transformation matrix. If a matrix is built with\n *  fromRotationTranslation, the returned quaternion will be the\n *  same as the quaternion originally supplied.\n * @param {quat} out Quaternion to receive the rotation component\n * @param {ReadonlyMat4} mat Matrix to be decomposed (input)\n * @return {quat} out\n */\n\nexport function getRotation(out, mat) {\n  var scaling = new glMatrix.ARRAY_TYPE(3);\n  getScaling(scaling, mat);\n  var is1 = 1 / scaling[0];\n  var is2 = 1 / scaling[1];\n  var is3 = 1 / scaling[2];\n  var sm11 = mat[0] * is1;\n  var sm12 = mat[1] * is2;\n  var sm13 = mat[2] * is3;\n  var sm21 = mat[4] * is1;\n  var sm22 = mat[5] * is2;\n  var sm23 = mat[6] * is3;\n  var sm31 = mat[8] * is1;\n  var sm32 = mat[9] * is2;\n  var sm33 = mat[10] * is3;\n  var trace = sm11 + sm22 + sm33;\n  var S = 0;\n\n  if (trace > 0) {\n    S = Math.sqrt(trace + 1.0) * 2;\n    out[3] = 0.25 * S;\n    out[0] = (sm23 - sm32) / S;\n    out[1] = (sm31 - sm13) / S;\n    out[2] = (sm12 - sm21) / S;\n  } else if (sm11 > sm22 && sm11 > sm33) {\n    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;\n    out[3] = (sm23 - sm32) / S;\n    out[0] = 0.25 * S;\n    out[1] = (sm12 + sm21) / S;\n    out[2] = (sm31 + sm13) / S;\n  } else if (sm22 > sm33) {\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\n    out[3] = (sm31 - sm13) / S;\n    out[0] = (sm12 + sm21) / S;\n    out[1] = 0.25 * S;\n    out[2] = (sm23 + sm32) / S;\n  } else {\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\n    out[3] = (sm12 - sm21) / S;\n    out[0] = (sm31 + sm13) / S;\n    out[1] = (sm23 + sm32) / S;\n    out[2] = 0.25 * S;\n  }\n\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScale(out, q, v, s) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  out[0] = (1 - (yy + zz)) * sx;\n  out[1] = (xy + wz) * sx;\n  out[2] = (xz - wy) * sx;\n  out[3] = 0;\n  out[4] = (xy - wz) * sy;\n  out[5] = (1 - (xx + zz)) * sy;\n  out[6] = (yz + wx) * sy;\n  out[7] = 0;\n  out[8] = (xz + wy) * sz;\n  out[9] = (yz - wx) * sz;\n  out[10] = (1 - (xx + yy)) * sz;\n  out[11] = 0;\n  out[12] = v[0];\n  out[13] = v[1];\n  out[14] = v[2];\n  out[15] = 1;\n  return out;\n}\n/**\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n * This is equivalent to (but much faster than):\n *\n *     mat4.identity(dest);\n *     mat4.translate(dest, vec);\n *     mat4.translate(dest, origin);\n *     let quatMat = mat4.create();\n *     quat4.toMat4(quat, quatMat);\n *     mat4.multiply(dest, quatMat);\n *     mat4.scale(dest, scale)\n *     mat4.translate(dest, negativeOrigin);\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {quat4} q Rotation quaternion\n * @param {ReadonlyVec3} v Translation vector\n * @param {ReadonlyVec3} s Scaling vector\n * @param {ReadonlyVec3} o The origin vector around which to scale and rotate\n * @returns {mat4} out\n */\n\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\n  // Quaternion math\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var xy = x * y2;\n  var xz = x * z2;\n  var yy = y * y2;\n  var yz = y * z2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  var sx = s[0];\n  var sy = s[1];\n  var sz = s[2];\n  var ox = o[0];\n  var oy = o[1];\n  var oz = o[2];\n  var out0 = (1 - (yy + zz)) * sx;\n  var out1 = (xy + wz) * sx;\n  var out2 = (xz - wy) * sx;\n  var out4 = (xy - wz) * sy;\n  var out5 = (1 - (xx + zz)) * sy;\n  var out6 = (yz + wx) * sy;\n  var out8 = (xz + wy) * sz;\n  var out9 = (yz - wx) * sz;\n  var out10 = (1 - (xx + yy)) * sz;\n  out[0] = out0;\n  out[1] = out1;\n  out[2] = out2;\n  out[3] = 0;\n  out[4] = out4;\n  out[5] = out5;\n  out[6] = out6;\n  out[7] = 0;\n  out[8] = out8;\n  out[9] = out9;\n  out[10] = out10;\n  out[11] = 0;\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\n  out[15] = 1;\n  return out;\n}\n/**\n * Calculates a 4x4 matrix from the given quaternion\n *\n * @param {mat4} out mat4 receiving operation result\n * @param {ReadonlyQuat} q Quaternion to create matrix from\n *\n * @returns {mat4} out\n */\n\nexport function fromQuat(out, q) {\n  var x = q[0],\n      y = q[1],\n      z = q[2],\n      w = q[3];\n  var x2 = x + x;\n  var y2 = y + y;\n  var z2 = z + z;\n  var xx = x * x2;\n  var yx = y * x2;\n  var yy = y * y2;\n  var zx = z * x2;\n  var zy = z * y2;\n  var zz = z * z2;\n  var wx = w * x2;\n  var wy = w * y2;\n  var wz = w * z2;\n  out[0] = 1 - yy - zz;\n  out[1] = yx + wz;\n  out[2] = zx - wy;\n  out[3] = 0;\n  out[4] = yx - wz;\n  out[5] = 1 - xx - zz;\n  out[6] = zy + wx;\n  out[7] = 0;\n  out[8] = zx + wy;\n  out[9] = zy - wx;\n  out[10] = 1 - xx - yy;\n  out[11] = 0;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = 0;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a frustum matrix with the given bounds\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Number} left Left bound of the frustum\n * @param {Number} right Right bound of the frustum\n * @param {Number} bottom Bottom bound of the frustum\n * @param {Number} top Top bound of the frustum\n * @param {Number} near Near bound of the frustum\n * @param {Number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function frustum(out, left, right, bottom, top, near, far) {\n  var rl = 1 / (right - left);\n  var tb = 1 / (top - bottom);\n  var nf = 1 / (near - far);\n  out[0] = near * 2 * rl;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = near * 2 * tb;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = (right + left) * rl;\n  out[9] = (top + bottom) * tb;\n  out[10] = (far + near) * nf;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[14] = far * near * 2 * nf;\n  out[15] = 0;\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveNO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = (far + near) * nf;\n    out[14] = 2 * far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -2 * near;\n  }\n\n  return out;\n}\n/**\n * Alias for {@link mat4.perspectiveNO}\n * @function\n */\n\nexport var perspective = perspectiveNO;\n/**\n * Generates a perspective projection matrix suitable for WebGPU with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n * Passing null/undefined/no value for far will generate infinite projection matrix.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} fovy Vertical field of view in radians\n * @param {number} aspect Aspect ratio. typically viewport width/height\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum, can be null or Infinity\n * @returns {mat4} out\n */\n\nexport function perspectiveZO(out, fovy, aspect, near, far) {\n  var f = 1.0 / Math.tan(fovy / 2),\n      nf;\n  out[0] = f / aspect;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = f;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[11] = -1;\n  out[12] = 0;\n  out[13] = 0;\n  out[15] = 0;\n\n  if (far != null && far !== Infinity) {\n    nf = 1 / (near - far);\n    out[10] = far * nf;\n    out[14] = far * near * nf;\n  } else {\n    out[10] = -1;\n    out[14] = -near;\n  }\n\n  return out;\n}\n/**\n * Generates a perspective projection matrix with the given field of view.\n * This is primarily useful for generating projection matrices to be used\n * with the still experiemental WebVR API.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\n  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);\n  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);\n  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);\n  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);\n  var xScale = 2.0 / (leftTan + rightTan);\n  var yScale = 2.0 / (upTan + downTan);\n  out[0] = xScale;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  out[4] = 0.0;\n  out[5] = yScale;\n  out[6] = 0.0;\n  out[7] = 0.0;\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\n  out[9] = (upTan - downTan) * yScale * 0.5;\n  out[10] = far / (near - far);\n  out[11] = -1.0;\n  out[12] = 0.0;\n  out[13] = 0.0;\n  out[14] = far * near / (near - far);\n  out[15] = 0.0;\n  return out;\n}\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [-1, 1],\n * which matches WebGL/OpenGL's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoNO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = 2 * nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = (far + near) * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Alias for {@link mat4.orthoNO}\n * @function\n */\n\nexport var ortho = orthoNO;\n/**\n * Generates a orthogonal projection matrix with the given bounds.\n * The near/far clip planes correspond to a normalized device coordinate Z range of [0, 1],\n * which matches WebGPU/Vulkan/DirectX/Metal's clip volume.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {number} left Left bound of the frustum\n * @param {number} right Right bound of the frustum\n * @param {number} bottom Bottom bound of the frustum\n * @param {number} top Top bound of the frustum\n * @param {number} near Near bound of the frustum\n * @param {number} far Far bound of the frustum\n * @returns {mat4} out\n */\n\nexport function orthoZO(out, left, right, bottom, top, near, far) {\n  var lr = 1 / (left - right);\n  var bt = 1 / (bottom - top);\n  var nf = 1 / (near - far);\n  out[0] = -2 * lr;\n  out[1] = 0;\n  out[2] = 0;\n  out[3] = 0;\n  out[4] = 0;\n  out[5] = -2 * bt;\n  out[6] = 0;\n  out[7] = 0;\n  out[8] = 0;\n  out[9] = 0;\n  out[10] = nf;\n  out[11] = 0;\n  out[12] = (left + right) * lr;\n  out[13] = (top + bottom) * bt;\n  out[14] = near * nf;\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function lookAt(out, eye, center, up) {\n  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\n  var eyex = eye[0];\n  var eyey = eye[1];\n  var eyez = eye[2];\n  var upx = up[0];\n  var upy = up[1];\n  var upz = up[2];\n  var centerx = center[0];\n  var centery = center[1];\n  var centerz = center[2];\n\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON && Math.abs(eyey - centery) < glMatrix.EPSILON && Math.abs(eyez - centerz) < glMatrix.EPSILON) {\n    return identity(out);\n  }\n\n  z0 = eyex - centerx;\n  z1 = eyey - centery;\n  z2 = eyez - centerz;\n  len = 1 / Math.hypot(z0, z1, z2);\n  z0 *= len;\n  z1 *= len;\n  z2 *= len;\n  x0 = upy * z2 - upz * z1;\n  x1 = upz * z0 - upx * z2;\n  x2 = upx * z1 - upy * z0;\n  len = Math.hypot(x0, x1, x2);\n\n  if (!len) {\n    x0 = 0;\n    x1 = 0;\n    x2 = 0;\n  } else {\n    len = 1 / len;\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  y0 = z1 * x2 - z2 * x1;\n  y1 = z2 * x0 - z0 * x2;\n  y2 = z0 * x1 - z1 * x0;\n  len = Math.hypot(y0, y1, y2);\n\n  if (!len) {\n    y0 = 0;\n    y1 = 0;\n    y2 = 0;\n  } else {\n    len = 1 / len;\n    y0 *= len;\n    y1 *= len;\n    y2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = y0;\n  out[2] = z0;\n  out[3] = 0;\n  out[4] = x1;\n  out[5] = y1;\n  out[6] = z1;\n  out[7] = 0;\n  out[8] = x2;\n  out[9] = y2;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\n  out[15] = 1;\n  return out;\n}\n/**\n * Generates a matrix that makes something look at something else.\n *\n * @param {mat4} out mat4 frustum matrix will be written into\n * @param {ReadonlyVec3} eye Position of the viewer\n * @param {ReadonlyVec3} center Point the viewer is looking at\n * @param {ReadonlyVec3} up vec3 pointing up\n * @returns {mat4} out\n */\n\nexport function targetTo(out, eye, target, up) {\n  var eyex = eye[0],\n      eyey = eye[1],\n      eyez = eye[2],\n      upx = up[0],\n      upy = up[1],\n      upz = up[2];\n  var z0 = eyex - target[0],\n      z1 = eyey - target[1],\n      z2 = eyez - target[2];\n  var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    z0 *= len;\n    z1 *= len;\n    z2 *= len;\n  }\n\n  var x0 = upy * z2 - upz * z1,\n      x1 = upz * z0 - upx * z2,\n      x2 = upx * z1 - upy * z0;\n  len = x0 * x0 + x1 * x1 + x2 * x2;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n    x0 *= len;\n    x1 *= len;\n    x2 *= len;\n  }\n\n  out[0] = x0;\n  out[1] = x1;\n  out[2] = x2;\n  out[3] = 0;\n  out[4] = z1 * x2 - z2 * x1;\n  out[5] = z2 * x0 - z0 * x2;\n  out[6] = z0 * x1 - z1 * x0;\n  out[7] = 0;\n  out[8] = z0;\n  out[9] = z1;\n  out[10] = z2;\n  out[11] = 0;\n  out[12] = eyex;\n  out[13] = eyey;\n  out[14] = eyez;\n  out[15] = 1;\n  return out;\n}\n/**\n * Returns a string representation of a mat4\n *\n * @param {ReadonlyMat4} a matrix to represent as a string\n * @returns {String} string representation of the matrix\n */\n\nexport function str(a) {\n  return \"mat4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \", \" + a[4] + \", \" + a[5] + \", \" + a[6] + \", \" + a[7] + \", \" + a[8] + \", \" + a[9] + \", \" + a[10] + \", \" + a[11] + \", \" + a[12] + \", \" + a[13] + \", \" + a[14] + \", \" + a[15] + \")\";\n}\n/**\n * Returns Frobenius norm of a mat4\n *\n * @param {ReadonlyMat4} a the matrix to calculate Frobenius norm of\n * @returns {Number} Frobenius norm\n */\n\nexport function frob(a) {\n  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);\n}\n/**\n * Adds two mat4's\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  out[4] = a[4] + b[4];\n  out[5] = a[5] + b[5];\n  out[6] = a[6] + b[6];\n  out[7] = a[7] + b[7];\n  out[8] = a[8] + b[8];\n  out[9] = a[9] + b[9];\n  out[10] = a[10] + b[10];\n  out[11] = a[11] + b[11];\n  out[12] = a[12] + b[12];\n  out[13] = a[13] + b[13];\n  out[14] = a[14] + b[14];\n  out[15] = a[15] + b[15];\n  return out;\n}\n/**\n * Subtracts matrix b from matrix a\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @returns {mat4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  out[4] = a[4] - b[4];\n  out[5] = a[5] - b[5];\n  out[6] = a[6] - b[6];\n  out[7] = a[7] - b[7];\n  out[8] = a[8] - b[8];\n  out[9] = a[9] - b[9];\n  out[10] = a[10] - b[10];\n  out[11] = a[11] - b[11];\n  out[12] = a[12] - b[12];\n  out[13] = a[13] - b[13];\n  out[14] = a[14] - b[14];\n  out[15] = a[15] - b[15];\n  return out;\n}\n/**\n * Multiply each element of the matrix by a scalar.\n *\n * @param {mat4} out the receiving matrix\n * @param {ReadonlyMat4} a the matrix to scale\n * @param {Number} b amount to scale the matrix's elements by\n * @returns {mat4} out\n */\n\nexport function multiplyScalar(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  out[4] = a[4] * b;\n  out[5] = a[5] * b;\n  out[6] = a[6] * b;\n  out[7] = a[7] * b;\n  out[8] = a[8] * b;\n  out[9] = a[9] * b;\n  out[10] = a[10] * b;\n  out[11] = a[11] * b;\n  out[12] = a[12] * b;\n  out[13] = a[13] * b;\n  out[14] = a[14] * b;\n  out[15] = a[15] * b;\n  return out;\n}\n/**\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\n *\n * @param {mat4} out the receiving vector\n * @param {ReadonlyMat4} a the first operand\n * @param {ReadonlyMat4} b the second operand\n * @param {Number} scale the amount to scale b's elements by before adding\n * @returns {mat4} out\n */\n\nexport function multiplyScalarAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  out[4] = a[4] + b[4] * scale;\n  out[5] = a[5] + b[5] * scale;\n  out[6] = a[6] + b[6] * scale;\n  out[7] = a[7] + b[7] * scale;\n  out[8] = a[8] + b[8] * scale;\n  out[9] = a[9] + b[9] * scale;\n  out[10] = a[10] + b[10] * scale;\n  out[11] = a[11] + b[11] * scale;\n  out[12] = a[12] + b[12] * scale;\n  out[13] = a[13] + b[13] * scale;\n  out[14] = a[14] + b[14] * scale;\n  out[15] = a[15] + b[15] * scale;\n  return out;\n}\n/**\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\n}\n/**\n * Returns whether or not the matrices have approximately the same elements in the same position.\n *\n * @param {ReadonlyMat4} a The first matrix.\n * @param {ReadonlyMat4} b The second matrix.\n * @returns {Boolean} True if the matrices are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var a4 = a[4],\n      a5 = a[5],\n      a6 = a[6],\n      a7 = a[7];\n  var a8 = a[8],\n      a9 = a[9],\n      a10 = a[10],\n      a11 = a[11];\n  var a12 = a[12],\n      a13 = a[13],\n      a14 = a[14],\n      a15 = a[15];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  var b4 = b[4],\n      b5 = b[5],\n      b6 = b[6],\n      b7 = b[7];\n  var b8 = b[8],\n      b9 = b[9],\n      b10 = b[10],\n      b11 = b[11];\n  var b12 = b[12],\n      b13 = b[13],\n      b14 = b[14],\n      b15 = b[15];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));\n}\n/**\n * Alias for {@link mat4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link mat4.subtract}\n * @function\n */\n\nexport var sub = subtract;","import * as glMatrix from \"./common.js\";\n/**\n * 3 Dimensional Vector\n * @module vec3\n */\n\n/**\n * Creates a new, empty vec3\n *\n * @returns {vec3} a new 3D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(3);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec3 initialized with values from an existing vector\n *\n * @param {ReadonlyVec3} a vector to clone\n * @returns {vec3} a new 3D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Calculates the length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Creates a new vec3 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} a new 3D vector\n */\n\nexport function fromValues(x, y, z) {\n  var out = new glMatrix.ARRAY_TYPE(3);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the source vector\n * @returns {vec3} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n/**\n * Set the components of a vec3 to the given values\n *\n * @param {vec3} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @returns {vec3} out\n */\n\nexport function set(out, x, y, z) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  return out;\n}\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n/**\n * Multiplies two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  return out;\n}\n/**\n * Divides two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  return out;\n}\n/**\n * Math.ceil the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to ceil\n * @returns {vec3} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  return out;\n}\n/**\n * Math.floor the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to floor\n * @returns {vec3} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  return out;\n}\n/**\n * Returns the minimum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  return out;\n}\n/**\n * Returns the maximum of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  return out;\n}\n/**\n * Math.round the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to round\n * @returns {vec3} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  return out;\n}\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return Math.hypot(x, y, z);\n}\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Calculates the squared length of a vec3\n *\n * @param {ReadonlyVec3} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  return x * x + y * y + z * z;\n}\n/**\n * Negates the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to negate\n * @returns {vec3} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to invert\n * @returns {vec3} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  return out;\n}\n/**\n * Normalize a vec3\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a vector to normalize\n * @returns {vec3} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var len = x * x + y * y + z * z;\n\n  if (len > 0) {\n    //TODO: evaluate use of glm_invsqrt here?\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = a[0] * len;\n  out[1] = a[1] * len;\n  out[2] = a[2] * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @returns {vec3} out\n */\n\nexport function cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2];\n  var bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  return out;\n}\n/**\n * Performs a hermite interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function hermite(out, a, b, c, d, t) {\n  var factorTimes2 = t * t;\n  var factor1 = factorTimes2 * (2 * t - 3) + 1;\n  var factor2 = factorTimes2 * (t - 2) + t;\n  var factor3 = factorTimes2 * (t - 1);\n  var factor4 = factorTimes2 * (3 - 2 * t);\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Performs a bezier interpolation with two control points\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the first operand\n * @param {ReadonlyVec3} b the second operand\n * @param {ReadonlyVec3} c the third operand\n * @param {ReadonlyVec3} d the fourth operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec3} out\n */\n\nexport function bezier(out, a, b, c, d, t) {\n  var inverseFactor = 1 - t;\n  var inverseFactorTimesTwo = inverseFactor * inverseFactor;\n  var factorTimes2 = t * t;\n  var factor1 = inverseFactorTimesTwo * inverseFactor;\n  var factor2 = 3 * t * inverseFactorTimesTwo;\n  var factor3 = 3 * factorTimes2 * inverseFactor;\n  var factor4 = factorTimes2 * t;\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec3} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec3} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0;\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\n  var z = glMatrix.RANDOM() * 2.0 - 1.0;\n  var zScale = Math.sqrt(1.0 - z * z) * scale;\n  out[0] = Math.cos(r) * zScale;\n  out[1] = Math.sin(r) * zScale;\n  out[2] = z * scale;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat4.\n * 4th vector component is implicitly '1'\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var w = m[3] * x + m[7] * y + m[11] * z + m[15];\n  w = w || 1.0;\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\n  return out;\n}\n/**\n * Transforms the vec3 with a mat3.\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyMat3} m the 3x3 matrix to transform with\n * @returns {vec3} out\n */\n\nexport function transformMat3(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  out[0] = x * m[0] + y * m[3] + z * m[6];\n  out[1] = x * m[1] + y * m[4] + z * m[7];\n  out[2] = x * m[2] + y * m[5] + z * m[8];\n  return out;\n}\n/**\n * Transforms the vec3 with a quat\n * Can also be used for dual quaternions. (Multiply it with the real part)\n *\n * @param {vec3} out the receiving vector\n * @param {ReadonlyVec3} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec3} out\n */\n\nexport function transformQuat(out, a, q) {\n  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3];\n  var x = a[0],\n      y = a[1],\n      z = a[2]; // var qvec = [qx, qy, qz];\n  // var uv = vec3.cross([], qvec, a);\n\n  var uvx = qy * z - qz * y,\n      uvy = qz * x - qx * z,\n      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);\n\n  var uuvx = qy * uvz - qz * uvy,\n      uuvy = qz * uvx - qx * uvz,\n      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);\n\n  var w2 = qw * 2;\n  uvx *= w2;\n  uvy *= w2;\n  uvz *= w2; // vec3.scale(uuv, uuv, 2);\n\n  uuvx *= 2;\n  uuvy *= 2;\n  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));\n\n  out[0] = x + uvx + uuvx;\n  out[1] = y + uvy + uuvy;\n  out[2] = z + uvz + uuvz;\n  return out;\n}\n/**\n * Rotate a 3D vector around the x-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateX(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0];\n  r[1] = p[1] * Math.cos(rad) - p[2] * Math.sin(rad);\n  r[2] = p[1] * Math.sin(rad) + p[2] * Math.cos(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the y-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateY(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[2] * Math.sin(rad) + p[0] * Math.cos(rad);\n  r[1] = p[1];\n  r[2] = p[2] * Math.cos(rad) - p[0] * Math.sin(rad); //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Rotate a 3D vector around the z-axis\n * @param {vec3} out The receiving vec3\n * @param {ReadonlyVec3} a The vec3 point to rotate\n * @param {ReadonlyVec3} b The origin of the rotation\n * @param {Number} rad The angle of rotation in radians\n * @returns {vec3} out\n */\n\nexport function rotateZ(out, a, b, rad) {\n  var p = [],\n      r = []; //Translate point to the origin\n\n  p[0] = a[0] - b[0];\n  p[1] = a[1] - b[1];\n  p[2] = a[2] - b[2]; //perform rotation\n\n  r[0] = p[0] * Math.cos(rad) - p[1] * Math.sin(rad);\n  r[1] = p[0] * Math.sin(rad) + p[1] * Math.cos(rad);\n  r[2] = p[2]; //translate to correct position\n\n  out[0] = r[0] + b[0];\n  out[1] = r[1] + b[1];\n  out[2] = r[2] + b[2];\n  return out;\n}\n/**\n * Get the angle between two 3D vectors\n * @param {ReadonlyVec3} a The first operand\n * @param {ReadonlyVec3} b The second operand\n * @returns {Number} The angle in radians\n */\n\nexport function angle(a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2],\n      mag1 = Math.sqrt(ax * ax + ay * ay + az * az),\n      mag2 = Math.sqrt(bx * bx + by * by + bz * bz),\n      mag = mag1 * mag2,\n      cosine = mag && dot(a, b) / mag;\n  return Math.acos(Math.min(Math.max(cosine, -1), 1));\n}\n/**\n * Set the components of a vec3 to zero\n *\n * @param {vec3} out the receiving vector\n * @returns {vec3} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec3} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec3(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec3} a The first vector.\n * @param {ReadonlyVec3} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));\n}\n/**\n * Alias for {@link vec3.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec3.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec3.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec3.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec3.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec3.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec3.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec3s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 3;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n    }\n\n    return a;\n  };\n}();","import * as glMatrix from \"./common.js\";\n/**\n * 4 Dimensional Vector\n * @module vec4\n */\n\n/**\n * Creates a new, empty vec4\n *\n * @returns {vec4} a new 4D vector\n */\n\nexport function create() {\n  var out = new glMatrix.ARRAY_TYPE(4);\n\n  if (glMatrix.ARRAY_TYPE != Float32Array) {\n    out[0] = 0;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n  }\n\n  return out;\n}\n/**\n * Creates a new vec4 initialized with values from an existing vector\n *\n * @param {ReadonlyVec4} a vector to clone\n * @returns {vec4} a new 4D vector\n */\n\nexport function clone(a) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Creates a new vec4 initialized with the given values\n *\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} a new 4D vector\n */\n\nexport function fromValues(x, y, z, w) {\n  var out = new glMatrix.ARRAY_TYPE(4);\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Copy the values from one vec4 to another\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the source vector\n * @returns {vec4} out\n */\n\nexport function copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to the given values\n *\n * @param {vec4} out the receiving vector\n * @param {Number} x X component\n * @param {Number} y Y component\n * @param {Number} z Z component\n * @param {Number} w W component\n * @returns {vec4} out\n */\n\nexport function set(out, x, y, z, w) {\n  out[0] = x;\n  out[1] = y;\n  out[2] = z;\n  out[3] = w;\n  return out;\n}\n/**\n * Adds two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  out[3] = a[3] + b[3];\n  return out;\n}\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  out[3] = a[3] - b[3];\n  return out;\n}\n/**\n * Multiplies two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function multiply(out, a, b) {\n  out[0] = a[0] * b[0];\n  out[1] = a[1] * b[1];\n  out[2] = a[2] * b[2];\n  out[3] = a[3] * b[3];\n  return out;\n}\n/**\n * Divides two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function divide(out, a, b) {\n  out[0] = a[0] / b[0];\n  out[1] = a[1] / b[1];\n  out[2] = a[2] / b[2];\n  out[3] = a[3] / b[3];\n  return out;\n}\n/**\n * Math.ceil the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to ceil\n * @returns {vec4} out\n */\n\nexport function ceil(out, a) {\n  out[0] = Math.ceil(a[0]);\n  out[1] = Math.ceil(a[1]);\n  out[2] = Math.ceil(a[2]);\n  out[3] = Math.ceil(a[3]);\n  return out;\n}\n/**\n * Math.floor the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to floor\n * @returns {vec4} out\n */\n\nexport function floor(out, a) {\n  out[0] = Math.floor(a[0]);\n  out[1] = Math.floor(a[1]);\n  out[2] = Math.floor(a[2]);\n  out[3] = Math.floor(a[3]);\n  return out;\n}\n/**\n * Returns the minimum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function min(out, a, b) {\n  out[0] = Math.min(a[0], b[0]);\n  out[1] = Math.min(a[1], b[1]);\n  out[2] = Math.min(a[2], b[2]);\n  out[3] = Math.min(a[3], b[3]);\n  return out;\n}\n/**\n * Returns the maximum of two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {vec4} out\n */\n\nexport function max(out, a, b) {\n  out[0] = Math.max(a[0], b[0]);\n  out[1] = Math.max(a[1], b[1]);\n  out[2] = Math.max(a[2], b[2]);\n  out[3] = Math.max(a[3], b[3]);\n  return out;\n}\n/**\n * Math.round the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to round\n * @returns {vec4} out\n */\n\nexport function round(out, a) {\n  out[0] = Math.round(a[0]);\n  out[1] = Math.round(a[1]);\n  out[2] = Math.round(a[2]);\n  out[3] = Math.round(a[3]);\n  return out;\n}\n/**\n * Scales a vec4 by a scalar number\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec4} out\n */\n\nexport function scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  out[3] = a[3] * b;\n  return out;\n}\n/**\n * Adds two vec4's after scaling the second operand by a scalar value\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec4} out\n */\n\nexport function scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  out[3] = a[3] + b[3] * scale;\n  return out;\n}\n/**\n * Calculates the euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} distance between a and b\n */\n\nexport function distance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared euclidian distance between two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nexport function squaredDistance(a, b) {\n  var x = b[0] - a[0];\n  var y = b[1] - a[1];\n  var z = b[2] - a[2];\n  var w = b[3] - a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Calculates the length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate length of\n * @returns {Number} length of a\n */\n\nexport function length(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return Math.hypot(x, y, z, w);\n}\n/**\n * Calculates the squared length of a vec4\n *\n * @param {ReadonlyVec4} a vector to calculate squared length of\n * @returns {Number} squared length of a\n */\n\nexport function squaredLength(a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  return x * x + y * y + z * z + w * w;\n}\n/**\n * Negates the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to negate\n * @returns {vec4} out\n */\n\nexport function negate(out, a) {\n  out[0] = -a[0];\n  out[1] = -a[1];\n  out[2] = -a[2];\n  out[3] = -a[3];\n  return out;\n}\n/**\n * Returns the inverse of the components of a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to invert\n * @returns {vec4} out\n */\n\nexport function inverse(out, a) {\n  out[0] = 1.0 / a[0];\n  out[1] = 1.0 / a[1];\n  out[2] = 1.0 / a[2];\n  out[3] = 1.0 / a[3];\n  return out;\n}\n/**\n * Normalize a vec4\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a vector to normalize\n * @returns {vec4} out\n */\n\nexport function normalize(out, a) {\n  var x = a[0];\n  var y = a[1];\n  var z = a[2];\n  var w = a[3];\n  var len = x * x + y * y + z * z + w * w;\n\n  if (len > 0) {\n    len = 1 / Math.sqrt(len);\n  }\n\n  out[0] = x * len;\n  out[1] = y * len;\n  out[2] = z * len;\n  out[3] = w * len;\n  return out;\n}\n/**\n * Calculates the dot product of two vec4's\n *\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nexport function dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n}\n/**\n * Returns the cross-product of three vectors in a 4-dimensional space\n *\n * @param {ReadonlyVec4} result the receiving vector\n * @param {ReadonlyVec4} U the first vector\n * @param {ReadonlyVec4} V the second vector\n * @param {ReadonlyVec4} W the third vector\n * @returns {vec4} result\n */\n\nexport function cross(out, u, v, w) {\n  var A = v[0] * w[1] - v[1] * w[0],\n      B = v[0] * w[2] - v[2] * w[0],\n      C = v[0] * w[3] - v[3] * w[0],\n      D = v[1] * w[2] - v[2] * w[1],\n      E = v[1] * w[3] - v[3] * w[1],\n      F = v[2] * w[3] - v[3] * w[2];\n  var G = u[0];\n  var H = u[1];\n  var I = u[2];\n  var J = u[3];\n  out[0] = H * F - I * E + J * D;\n  out[1] = -(G * F) + I * C - J * B;\n  out[2] = G * E - H * C + J * A;\n  out[3] = -(G * D) + H * B - I * A;\n  return out;\n}\n/**\n * Performs a linear interpolation between two vec4's\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the first operand\n * @param {ReadonlyVec4} b the second operand\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\n * @returns {vec4} out\n */\n\nexport function lerp(out, a, b, t) {\n  var ax = a[0];\n  var ay = a[1];\n  var az = a[2];\n  var aw = a[3];\n  out[0] = ax + t * (b[0] - ax);\n  out[1] = ay + t * (b[1] - ay);\n  out[2] = az + t * (b[2] - az);\n  out[3] = aw + t * (b[3] - aw);\n  return out;\n}\n/**\n * Generates a random vector with the given scale\n *\n * @param {vec4} out the receiving vector\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\n * @returns {vec4} out\n */\n\nexport function random(out, scale) {\n  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\n  // http://projecteuclid.org/euclid.aoms/1177692644;\n\n  var v1, v2, v3, v4;\n  var s1, s2;\n\n  do {\n    v1 = glMatrix.RANDOM() * 2 - 1;\n    v2 = glMatrix.RANDOM() * 2 - 1;\n    s1 = v1 * v1 + v2 * v2;\n  } while (s1 >= 1);\n\n  do {\n    v3 = glMatrix.RANDOM() * 2 - 1;\n    v4 = glMatrix.RANDOM() * 2 - 1;\n    s2 = v3 * v3 + v4 * v4;\n  } while (s2 >= 1);\n\n  var d = Math.sqrt((1 - s1) / s2);\n  out[0] = scale * v1;\n  out[1] = scale * v2;\n  out[2] = scale * v3 * d;\n  out[3] = scale * v4 * d;\n  return out;\n}\n/**\n * Transforms the vec4 with a mat4.\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyMat4} m matrix to transform with\n * @returns {vec4} out\n */\n\nexport function transformMat4(out, a, m) {\n  var x = a[0],\n      y = a[1],\n      z = a[2],\n      w = a[3];\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\n  return out;\n}\n/**\n * Transforms the vec4 with a quat\n *\n * @param {vec4} out the receiving vector\n * @param {ReadonlyVec4} a the vector to transform\n * @param {ReadonlyQuat} q quaternion to transform with\n * @returns {vec4} out\n */\n\nexport function transformQuat(out, a, q) {\n  var x = a[0],\n      y = a[1],\n      z = a[2];\n  var qx = q[0],\n      qy = q[1],\n      qz = q[2],\n      qw = q[3]; // calculate quat * vec\n\n  var ix = qw * x + qy * z - qz * y;\n  var iy = qw * y + qz * x - qx * z;\n  var iz = qw * z + qx * y - qy * x;\n  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat\n\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\n  out[3] = a[3];\n  return out;\n}\n/**\n * Set the components of a vec4 to zero\n *\n * @param {vec4} out the receiving vector\n * @returns {vec4} out\n */\n\nexport function zero(out) {\n  out[0] = 0.0;\n  out[1] = 0.0;\n  out[2] = 0.0;\n  out[3] = 0.0;\n  return out;\n}\n/**\n * Returns a string representation of a vector\n *\n * @param {ReadonlyVec4} a vector to represent as a string\n * @returns {String} string representation of the vector\n */\n\nexport function str(a) {\n  return \"vec4(\" + a[0] + \", \" + a[1] + \", \" + a[2] + \", \" + a[3] + \")\";\n}\n/**\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function exactEquals(a, b) {\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\n}\n/**\n * Returns whether or not the vectors have approximately the same elements in the same position.\n *\n * @param {ReadonlyVec4} a The first vector.\n * @param {ReadonlyVec4} b The second vector.\n * @returns {Boolean} True if the vectors are equal, false otherwise.\n */\n\nexport function equals(a, b) {\n  var a0 = a[0],\n      a1 = a[1],\n      a2 = a[2],\n      a3 = a[3];\n  var b0 = b[0],\n      b1 = b[1],\n      b2 = b[2],\n      b3 = b[3];\n  return Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));\n}\n/**\n * Alias for {@link vec4.subtract}\n * @function\n */\n\nexport var sub = subtract;\n/**\n * Alias for {@link vec4.multiply}\n * @function\n */\n\nexport var mul = multiply;\n/**\n * Alias for {@link vec4.divide}\n * @function\n */\n\nexport var div = divide;\n/**\n * Alias for {@link vec4.distance}\n * @function\n */\n\nexport var dist = distance;\n/**\n * Alias for {@link vec4.squaredDistance}\n * @function\n */\n\nexport var sqrDist = squaredDistance;\n/**\n * Alias for {@link vec4.length}\n * @function\n */\n\nexport var len = length;\n/**\n * Alias for {@link vec4.squaredLength}\n * @function\n */\n\nexport var sqrLen = squaredLength;\n/**\n * Perform some operation over an array of vec4s.\n *\n * @param {Array} a the array of vectors to iterate over\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\n * @param {Number} offset Number of elements to skip at the beginning of the array\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\n * @param {Function} fn Function to call for each vector in the array\n * @param {Object} [arg] additional argument to pass to fn\n * @returns {Array} a\n * @function\n */\n\nexport var forEach = function () {\n  var vec = create();\n  return function (a, stride, offset, count, fn, arg) {\n    var i, l;\n\n    if (!stride) {\n      stride = 4;\n    }\n\n    if (!offset) {\n      offset = 0;\n    }\n\n    if (count) {\n      l = Math.min(count * stride + offset, a.length);\n    } else {\n      l = a.length;\n    }\n\n    for (i = offset; i < l; i += stride) {\n      vec[0] = a[i];\n      vec[1] = a[i + 1];\n      vec[2] = a[i + 2];\n      vec[3] = a[i + 3];\n      fn(vec, vec, arg);\n      a[i] = vec[0];\n      a[i + 1] = vec[1];\n      a[i + 2] = vec[2];\n      a[i + 3] = vec[3];\n    }\n\n    return a;\n  };\n}();","import { Human } from '../Human'\nimport { vec3, mat4, vec4 } from 'gl-matrix'\nimport { getMatrix, get_normal } from './loadSkeleton'\nimport { Skeleton } from \"./Skeleton\"\n\nexport class Bone {\n    skeleton: Skeleton\n    name: string\n    index: number = -1;\n    headJoint: string\n    tailJoint: string\n    headPos = [0, 0, 0];\n    tailPos = [0, 0, 0];\n    roll: string | Array<string>\n    length = 0;\n    yvector4?: vec4 // direction vector of this bone\n\n    parent?: Bone\n    children: Bone[] = [];\n\n    level: number\n    reference_bones = [];\n\n    // user defined value\n    matPose: mat4\n\n    // calculated rest position\n    matRestGlobal?: mat4   // bone relative to world\n    matRestRelative?: mat4 // bone relative to parent\n    // calculated pose positions\n    matPoseGlobal?: mat4 // relative to world\n    matPoseVerts?: mat4 // relative to world and own rest pose, used for skinning\n\n    // shared/skeleton.py: 709\n    constructor(\n        skel: Skeleton,\n        name: string,\n        parentName: string | null,\n        headJoint: string,\n        tailJoint: string,\n        roll: string,\n        reference_bones?: any,\n        weight_reference_bones?: any) {\n        this.skeleton = skel\n        this.name = name\n        this.headJoint = headJoint\n        this.tailJoint = tailJoint\n        this.roll = roll\n\n        this.updateJointPositions(Human.getInstance())\n\n        if (parentName !== null) {\n            this.parent = this.skeleton.getBone(parentName)\n            this.parent!.children.push(this)\n        }\n\n        if (this.parent) {\n            this.level = this.parent.level + 1\n        } else {\n            this.level = 0\n        }\n\n        // self.reference_bones = []  # Used for mapping animations and poses\n        // if reference_bones is not None:\n        //     if not isinstance(reference_bones, list):\n        //         reference_bones = [ reference_bones ]\n        //     self.reference_bones.extend( set(reference_bones) )\n        // self._weight_reference_bones = None  # For mapping vertex weights (can be automatically set by c\n        // if weight_reference_bones is not None:\n        //     if not isinstance(weight_reference_bones, list):\n        //         weight_reference_bones = [ weight_reference_bones ]\n        //     self._weight_reference_bones = list( set(weight_reference_bones) )\n\n        this.matPose = mat4.identity(mat4.create()) // not posed yet\n    }\n\n    get planes(): Map<string, Array<string>> {\n        return this.skeleton.planes\n    }\n\n    // line 768\n    // Update the joint positions of this bone based on the current state\n    // of the human mesh.\n    // Remember to call build() after calling this method.\n    updateJointPositions(human: Human, in_rest: boolean = true) {\n        // if not human:\n        //   from core import G\n        //   human = G.app.selectedHuman\n        // self.headPos[:] = self.skeleton.getJointPosition(self.headJoint, human, in_rest)[:3] * self.skeleton.scale\n        // self.tailPos[:] = self.skeleton.getJointPosition(self.tailJoint, human, in_rest)[:3] * self.skeleton.scale\n        this.headPos = this.skeleton.getJointPosition(this.headJoint, human, in_rest)!\n        this.tailPos = this.skeleton.getJointPosition(this.tailJoint, human, in_rest)!\n    }\n\n    // line 826\n    // called from Skeleton.build(ref_skel), which is called from Skeleton.constructor()\n    // Calculate this bone's rest matrices and determine its local axis (roll\n    // or bone normal).\n    // Sets matPoseVerts, matPoseGlobal and matRestRelative.\n    // This method needs to be called everytime the skeleton structure is\n    // changed, the rest pose is changed or joint positions are updated.\n    // Pass a ref_skel to copy the bone normals from a reference skeleton\n    // instead of recalculating them (Recalculating bone normals generally\n    // only works if the skeleton is in rest pose).\n    build(ref_skel?: any) {\n        const head3 = vec3.fromValues(this.headPos[0], this.headPos[1], this.headPos[2])\n        const tail3 = vec3.fromValues(this.tailPos[0], this.tailPos[1], this.tailPos[2])\n\n        let normal\n        if (ref_skel) {\n            throw Error(\"not implemented yet\")\n        } else {\n            normal = this.get_normal()\n        }\n        this.matRestGlobal = getMatrix(head3, tail3, normal)\n        this.length = vec3.distance(head3, tail3)\n        if (this.parent === undefined) {\n            this.matRestRelative = this.matRestGlobal\n        } else {\n            this.matRestRelative =\n                mat4.mul(\n                    mat4.create(),\n                    mat4.invert(mat4.create(), this.parent.matRestGlobal!),\n                    this.matRestGlobal\n                )\n        }\n        this.yvector4 = vec4.fromValues(0, this.length, 0, 1)\n    }\n\n    // calculate matPoseGlobal & matPoseVerts\n    update() {\n        if (this.parent !== undefined) {\n            this.matPoseGlobal =\n                mat4.multiply(mat4.create(), this.parent.matPoseGlobal!,\n                    mat4.multiply(mat4.create(), this.matRestRelative!, this.matPose!))\n        } else {\n            this.matPoseGlobal = mat4.multiply(mat4.create(), this.matRestRelative!, this.matPose!)\n        }\n        this.matPoseVerts = mat4.multiply(mat4.create(), this.matPoseGlobal,\n            mat4.invert(mat4.create(), this.matRestGlobal!))\n    }\n\n    get_normal(): vec3 {\n        let normal\n        if (this.roll instanceof Array) {\n            throw Error(\"Not implemented yet\")\n            // # Average the normal over multiple planes\n            // count = 0\n            // normal = np.zeros(3, dtype=np.float32)\n            // for plane_name in self.roll:\n            //     norm = get_normal(self.skeleton, plane_name, self.planes)\n            //     if not np.allclose(norm, np.zeros(3), atol=1e-05):\n            //         count += 1\n            //         normal += norm\n            // if count > 0 and not np.allclose(normal, np.zeros(3), atol=1e-05):\n            //     normal /= count\n            // else:\n            //     normal = np.asarray([0.0, 1.0, 0.0], dtype=np.float32)\n        }\n        else if (typeof this.roll === \"string\") {\n            const plane_name = this.roll // TODO ugly.. why not call this something else than \"roll\"?\n            normal = get_normal(this.skeleton, plane_name, this.planes)\n            // if np.allclose(normal, np.zeros(3), atol=1e-05):\n            //     normal = np.asarray([0.0, 1.0, 0.0], dtype=np.float32)\n        } else {\n            normal = vec3.fromValues(0, 1, 0)\n        }\n        return normal\n    }\n}\n","import { Human } from '../Human'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\nimport { vec3, mat4 } from 'gl-matrix'\nimport { Skeleton } from './Skeleton'\n\nexport function loadSkeleton(filename: string) {\n    const root = parseSkeleton(\n        FileSystemAdapter.getInstance().readFile(filename),\n        filename)\n    console.log(`Loaded skeleton with ${root.bones.size} bones from file ${filename}`)\n    return root\n}\n\nexport function parseSkeleton(data: string, filename = 'memory') {\n    let json\n    try {\n        json = JSON.parse(data)\n    }\n    catch (error) {\n        console.log(`Failed to parse JSON in ${filename}:\\n${data.substring(0, 256)}`)\n        throw error\n    }\n    return new Skeleton(filename, json)\n}\n\nexport interface FileInformation {\n    name: string\n    version: string\n    tags?: string[]\n    description: string\n    copyright: string\n    license: string\n}\n\nfunction a2vec3(a: number[] | undefined) {\n    if (a === undefined) {\n        throw Error()\n    }\n    return vec3.fromValues(a[0], a[1], a[2])\n}\n\nexport function getMatrix(head: vec3, tail: vec3, normal: vec3): mat4 {\n    let bone_direction = vec3.subtract(vec3.create(), tail, head)\n    vec3.normalize(bone_direction, bone_direction)\n    const norm = vec3.normalize(vec3.create(), normal)\n    const z_axis = vec3.normalize(vec3.create(), vec3.cross(vec3.create(), norm, bone_direction))\n    const x_axis = vec3.normalize(vec3.create(), vec3.cross(vec3.create(), bone_direction, z_axis))\n    return mat4.fromValues(\n        x_axis[0], x_axis[1], x_axis[2], 0,                         // bone local X axis\n        bone_direction[0], bone_direction[1], bone_direction[2], 0, // bone local Y axis\n        z_axis[0], z_axis[1], z_axis[2], 0,                         // bone local Z axis\n        head[0], head[1], head[2], 1                                // head position as translation\n    )\n}\n\n// Return the normal of a triangle plane defined between three joint positions,\n// using counter-clockwise winding order (right-handed).\nexport function get_normal(skel: Skeleton, plane_name: string, plane_defs: Map<string, Array<string>>, human: Human | undefined = undefined) {\n    if (!plane_defs.has(plane_name)) {\n        console.warn(`No plane with name ${plane_name} defined for skeleton.`)\n        vec3.fromValues(0, 1, 0)\n    }\n    if (!human) {\n        human = Human.getInstance()\n    }\n    const joint_names = plane_defs.get(plane_name)!\n    const [j1, j2, j3] = joint_names\n    const p1 = vec3.scale(vec3.create(), a2vec3(skel.getJointPosition(j1, human)), skel.scale)\n    const p2 = vec3.scale(vec3.create(), a2vec3(skel.getJointPosition(j2, human)), skel.scale)\n    const p3 = vec3.scale(vec3.create(), a2vec3(skel.getJointPosition(j3, human)), skel.scale)\n    const pvec = vec3.normalize(vec3.create(), vec3.subtract(vec3.create(), p2, p1))\n    const yvec = vec3.normalize(vec3.create(), vec3.subtract(vec3.create(), p3, p2))\n    return vec3.normalize(vec3.create(), vec3.cross(vec3.create(), yvec, pvec))\n}\n\n// line 1368\n// Get the position of a joint from the human mesh.\n// This position is determined by the center of the joint helper with the\n// specified name.\n// Note: you probably want to use Skeleton.getJointPosition()\nexport function _getHumanJointPosition(human: Human, jointName: string, rest_coord = true): number[] {\n    throw Error(`NOT IMPLEMENTED: _getHumanJointPosition(..., jointName='${jointName}', rest_coord=${rest_coord})`)\n    // if (!jointName.startsWith(\"joint-\")) {\n    //     jointName = \"joint-\" + jointName\n    // }\n    const fg = human.meshData.getFaceGroup(jointName)\n    if (fg === undefined) {\n        console.warn(`Cannot find position for joint ${jointName}`)\n        console.log(human.meshData)\n        return [0, 0, 0]\n    }\n    console.log(`found face group for joint ${jointName}`)\n    // human.obj.group.get()\n    // fg = human.meshData.getFaceGroup(jointName)\n    // if fg is None:\n    //     log.warning('Cannot find position for joint %s', jointName)\n    //     return np.asarray([0,0,0], dtype=np.float32)\n    // v_idx = human.meshData.getVerticesForGroups([fg.name])\n    // if rest_coord:\n    //     verts = human.getRestposeCoordinates()[v_idx]\n    // else:\n    //     verts = human.meshData.getCoords(v_idx)\n    // return verts.mean(axis=0)\n}","import { FileInformation } from './loadSkeleton'\n\n// makehuman/shared/skeleton.py\n// General skeleton, rig or armature class.\n// A skeleton is a hierarchic structure of bones, defined between a head and tail\n// joint position. Bones can be detached from each other (their head joint doesn't\n// necessarily need to be at the same position as the tail joint of their parent\n// bone).\n// A pose can be applied to the skeleton by setting a pose matrix for each of the\n// bones, allowing static posing or animation playback.\n// The skeleton supports skinning of a mesh using a list of vertex-to-bone\n// assignments.\n// skeleton file\n//   data: bones, joints, planes, weights_file, plane_map_strategy\n//   info: name, version, tags, description, copyright, license\n// weights files\n//   data: weights\n//   info: name, version, description, copyright, license\n\n// Map<boneName, [vertexIndex[], vertexWeight[]]\n//                ^              ^\n//                |              how much the vertex is influenced by the bone\n//                index of vertex influenced by the bone\nexport type VertexBoneMapping = Map<string, Array<Array<number>>>\n\nexport class VertexBoneWeights {\n    info: FileInformation\n    _vertexCount!: number\n    _data: VertexBoneMapping\n    constructor(filename: string, data: any) {\n        // data.weights = []\n        console.log(`VertexBoneWeights: filename='${filename}', data=${data}`)\n        this.info = {\n            name: data.name,\n            version: data.version,\n            // tags: data.tags,\n            description: data.description,\n            copyright: data.copyright,\n            license: data.license,\n        }\n        this._data = this._build_vertex_weights_data(data.weights)\n        this._calculate_num_weights()\n    }\n\n    protected _build_vertex_weights_data(vertexWeightsDict: any, vertexCount: number | undefined = undefined, rootBone: string = \"root\"): VertexBoneMapping {\n        const WEIGHT_THRESHOLD = 1e-4 // Threshold for including bone weight\n\n        // first_entry = list(vertexWeightsDict.keys())[0] if len(vertexWeightsDict) > 0 else None\n        // if len(vertexWeightsDict) > 0 and \\\n        //    len(vertexWeightsDict[first_entry]) == 2 and \\\n        //    isinstance(vertexWeightsDict[first_entry], tuple) and \\\n        //    isinstance(vertexWeightsDict[first_entry][1], np.ndarray) and \\\n        //    isinstance(vertexWeightsDict[first_entry][2], np.ndarray):\n        //     # Input dict is already in the expected format, presume it does not\n        //     # need to be built again\n        //     if vertexCount is not None:\n        //         self._vertexCount = vertexCount\n        //     else:\n        //         self._vertexCount = max([vn for vg in list(vertexWeightsDict.values()) for vn in vg[0]])+1\n        //     return vertexWeightsDict\n\n        // calculate vertex count\n        let vcount: number\n        if (vertexCount !== undefined) {\n            vcount = vertexCount\n        } else {\n            vcount = 0\n            for (let bone_name of Object.getOwnPropertyNames(vertexWeightsDict)) {\n                const weight_list = vertexWeightsDict[bone_name]\n                weight_list.forEach((item: any) => {\n                    const vertex_index = item[0]\n                    vcount = Math.max(vcount, vertex_index)\n                })\n            }\n            ++vcount\n        }\n        this._vertexCount = vcount\n\n        // prepare to normalize weights by calculating the total weight for each bone\n        const totalWeightPerVertex = new Array<number>(vcount).fill(0)\n        for (let bone_name of Object.getOwnPropertyNames(vertexWeightsDict)) {\n            const weight_list = vertexWeightsDict[bone_name]\n            weight_list.forEach((item: any) => {\n                const vertex_index = item[0]\n                const vertex_weight = item[1]\n                totalWeightPerVertex[vertex_index] += vertex_weight\n            })\n        }\n\n        const boneWeights: VertexBoneMapping = new Map<string, any>()\n        for (let bname of Object.getOwnPropertyNames(vertexWeightsDict)) {\n            const vgroup = vertexWeightsDict[bname]\n            if (vgroup.length === 0) {\n                continue\n            }\n            let weights: number[] = [], verts: number[] = [], v_lookup = new Map<number, number>(), n = 0\n            for (let [vn, w] of vgroup) {\n                if (v_lookup.has(vn)) {\n                    const v_idx = v_lookup.get(vn)!\n                    weights[v_idx] + -w / totalWeightPerVertex[vn]\n                } else {\n                    v_lookup.set(vn, verts.length)\n                    verts.push(vn)\n                    weights.push(w / totalWeightPerVertex[vn])\n                }\n            }\n            // filter out weights under the threshold and sort by vertex index\n            const i_s = weights\n                .map((weight, index) => weight > WEIGHT_THRESHOLD ? index : undefined)\n                .filter(index => index !== undefined)\n                .sort((a, b) => verts[a!] - verts[b!]) \n            verts = i_s.map(i => verts[i!])\n            weights = i_s.map(i => weights[i!])\n            boneWeights.set(bname, [verts, weights])\n        }\n\n        // assign unweighted vertices to root bone with weight 1\n        let vs: number[], ws: number[]\n        if (!boneWeights.has(rootBone)) {\n            vs = []\n            ws = []\n        } else {\n            [vs, ws] = boneWeights.get(rootBone)!\n        }\n        const rw_i = totalWeightPerVertex\n            .map((value, index) => value === 0 ? index : -1)\n            .filter(index => index >= 0)\n        vs = vs.concat(rw_i)\n        ws = ws.concat(new Array<number>(rw_i.length).fill(1))\n        if (rw_i.length > 0) {\n            if (rw_i.length < 100) {\n                // To avoid spamming the log, only print vertex indices if there's less than 100\n                console.log(`Adding trivial bone weights to root bone ${rootBone} for ${rw_i.length} unweighted vertices. [${rw_i}]`) // ', '.join([str(s) for s in rw_i]))`)\n            } else {\n                console.log(`Adding trivial bone weights to root bone ${rootBone} for ${rw_i.length} unweighted vertices.`)\n            }\n        }\n        if (vs.length > 0) {\n            boneWeights.set(rootBone, [vs, ws])\n        }\n\n        return boneWeights\n    }\n\n    protected _calculate_num_weights() {\n    }\n}\n","import { Human } from '../Human'\nimport { Bone } from './Bone'\nimport { FileInformation, _getHumanJointPosition } from './loadSkeleton'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\nimport { VertexBoneWeights, VertexBoneMapping } from './VertexBoneWeights'\nimport { vec3, mat4, vec4 } from 'gl-matrix'\n\nexport class Skeleton {\n    info: FileInformation\n\n    bones = new Map<string, Bone>(); // Bone lookup list by name\n    boneslist?: Bone[] // Breadth-first ordered list of all bones\n    roots: Bone[] = []; // bones with no parents (aka root bones) of this skeleton, a skeleton can have multiple root bones.\n\n    joint_pos_idxs = new Map<string, Array<number>>(); // Lookup by joint name referencing vertex indices on the human, to determine joint position\n    planes = new Map<string, string[]>(); // Named planes defined between joints, used for calculating bone roll angle\n    plane_map_strategy?: number = 3; // The remapping strategy used by addReferencePlanes() for remapping orientation planes from a reference skeleton\n\n    vertexWeights?: VertexBoneWeights\n    // Source vertex weights, defined on the basemesh, for this skeleton\n    has_custom_weights = false; // True if this skeleton has its own .mhw file\n\n    scale: number = 1;\n\n    // makehuman/shared/skeleton.py:88 fromFile()\n    constructor(filename: string, data: any) {\n        this.info = {\n            name: data.name,\n            version: data.version,\n            tags: data.tags,\n            description: data.description,\n            copyright: data.copyright,\n            license: data.license,\n        }\n        this.plane_map_strategy = data.plane_map_strategy\n\n        //\n        // joint_pos_idxs[name] := vertex index\n        //\n        // console.log(Object.getOwnPropertyNames(data.joints).length)\n        for (let joint_name of Object.getOwnPropertyNames(data.joints)) {\n            // console.log(joint_name)\n            const v_idxs = data.joints[joint_name]\n            if (v_idxs && v_idxs.length > 0) {\n                this.joint_pos_idxs.set(joint_name, v_idxs)\n            }\n        }\n        console.log(`Skeleton.construction(): this.joint_pos_idxs.size = ${this.joint_pos_idxs.size}`)\n\n        // planes[name] = ...\n        for (let plane of Object.getOwnPropertyNames(data.planes)) {\n            this.planes.set(plane, data.planes[plane])\n        }\n\n        // Order bones breadth-first (parents preceed children)\n        const breadthfirst_bones_set = new Set<string>()\n        const breadthfirst_bones = new Array<string>()\n        let prev_len = -1 // anti-deadlock\n        while (breadthfirst_bones_set.size != data.bones.length && prev_len != breadthfirst_bones_set.size) {\n            prev_len = breadthfirst_bones_set.size\n            for (let bone_name of Object.getOwnPropertyNames(data.bones)) {\n                const bone_defs = data.bones[bone_name]\n                if (!breadthfirst_bones_set.has(bone_name)) {\n                    const parent = bone_defs[\"parent\"]\n                    if (parent !== null && typeof parent !== \"string\") {\n                        console.log(`Bone '${bone_name}' has invalid parent '${parent}'`)\n                        continue\n                    }\n                    if (parent === null) { // root bone\n                        breadthfirst_bones_set.add(bone_name)\n                        breadthfirst_bones.push(bone_name)\n                    }\n                    else if (breadthfirst_bones_set.has(parent)) { // parent has already been added\n                        breadthfirst_bones_set.add(bone_name)\n                        breadthfirst_bones.push(bone_name)\n                    }\n                }\n            }\n        }\n        if (breadthfirst_bones_set.size !== Object.getOwnPropertyNames(data.bones).length) {\n            let missing = []\n            for (let bname in data.bones) {\n                if (!breadthfirst_bones_set.has(bname)) {\n                    missing.push(bname)\n                }\n            }\n            console.log(`Some bones defined in file '${filename}' could not be added to skeleton '${this.info.name}', because they have an invalid parent bone (${missing})`)\n        }\n\n        console.log(`breadthfirst_bones.length: ${breadthfirst_bones.length}`)\n\n        // for bone_name in breadthfirst_bones:\n        //     bone_defs = skelData[\"bones\"][bone_name]\n        //     rotation_plane = bone_defs.get(\"rotation_plane\", 0) // is 0 the default?\n        //     if rotation_plane == [None, None, None]:\n        //         log.warning(\"Invalid rotation plane specified for bone %s. Please make sure that you edited the .mhskel file by hand to include roll plane joints.\" % bone_name)\n        //         rotation_plane = 0\n        //     self.addBone(bone_name, bone_defs.get(\"parent\", None), bone_defs[\"head\"], bone_defs[\"tail\"], rotation_plane, bone_defs.get(\"reference\",None), bone_defs.get(\"weights_reference\",None))\n        for (let bone_name of breadthfirst_bones) {\n            const bone_defs = data.bones[bone_name]\n            let rotation_plane = bone_defs.rotation_plane\n            // This data was intended to be filled by hand in file exported with \n            //   https://github.com/makehumancommunity/makehuman-utils/blob/master/io_mhrigging_mhskel/export_mh_rigging.py\n            // from Blender\n            // if rotation_plane == [None, None, None]\n            if (typeof rotation_plane !== \"string\") {\n                console.log(`Invalid rotation plane '${JSON.stringify(rotation_plane)}' specified for bone ${bone_name}. Please make sure that you edited the .mhskel file by hand to include roll plane joints.\"`)\n                rotation_plane = null\n            }\n            // console.log(`${bone_name}, parent=${bone_defs.parent}, head=${bone_defs.head}, tail=${bone_defs.tail}, rotation_plane=${rotation_plane}, reference=${bone_defs.reference}, weights_reference=${bone_defs.reference}`)\n            this.addBone(bone_name, bone_defs.parent, bone_defs.head, bone_defs.tail, rotation_plane, bone_defs.reference, bone_defs.weights_reference)\n        }\n\n        this.build()\n\n        const weights_file = data[\"weights_file\"]\n        if (weights_file !== undefined) {\n            // FIXME: copy'n pasted into Proxy\n            const filename = `data/rigs/${weights_file}`\n            const data = FileSystemAdapter.getInstance().readFile(filename)\n            let json\n            try {\n                json = JSON.parse(data)\n            }\n            catch (error) {\n                console.log(`Failed to parse JSON in ${filename}:\\n${data.substring(0, 256)}`)\n                throw error\n            }\n            this.vertexWeights = new VertexBoneWeights(filename, json)\n            this.has_custom_weights = true\n            console.log(`loaded weights...`)\n            //     weights_file = getpath.thoroughFindFile(weights_file, os.path.dirname(getpath.canonicalPath(filepath)), True)\n            //     self.vertexWeights = VertexBoneWeights.fromFile(weights_file, mesh.getVertexCount() if mesh else None, rootBone=self.roots[0].name)\n            //     self.has_custom_weights = True\n        }\n    }\n\n    // line 122: toFile(self, filename, ref_weights=None)\n    // line 192: getVertexWeights(self, referenceWeights=None, force_remap=False)\n    // line 266: hasCustomVertexWeights(self)\n    // line 269: autoBuildWeightReferences(self, referenceSkel)\n    // line 341: addReferencePlanes(self, referenceSkel)\n    // skeleton.py, line 421: getJointPosition(self, joint_name, human, rest_coord=True)\n    // Calculate the position of specified named joint from the current\n    // state of the human mesh. If this skeleton contains no vertex mapping\n    // for that joint name, it falls back to looking for a vertex group in the\n    // human basemesh with that joint name.\n    // okay, so in the .mhskel file, [\"joints\"][joint_name][\"head\"|\"tail\"] will point to a list of\n    // indices into mesh.coord, whose coords surround the head|tail position\n    getJointPosition(joint_name: string, human: Human, rest_coord = true): number[] {\n        if (this.joint_pos_idxs.has(joint_name)) {\n            // console.log(`Skeleton.getJointPosition(joint_name='${joint_name}', human=${human}, rest_coord=${rest_coord}) -> from skeleton`)\n            const v_idx = this.joint_pos_idxs.get(joint_name)!\n            // \n            let verts\n            if (rest_coord) {\n                const meshCoords = human.getRestposeCoordinates()\n                verts = v_idx.map(i => {\n                    i = i * 3\n                    return [meshCoords[i], meshCoords[i + 1], meshCoords[i + 2]]\n                })\n                // console.log(verts.length)\n                // console.log(verts)\n            } else {\n                throw Error(`NOT IMPLEMENTED YET`)\n                // verts = human.meshData.getCoords(v_idx)\n            }\n            // return verts.mean(axis=0)\n            let x = 0, y = 0, z = 0\n            verts.forEach(v => {\n                x += v[0]\n                y += v[1]\n                z += v[2]\n            })\n            x /= verts.length\n            y /= verts.length\n            z /= verts.length\n            return [x, y, z]\n        }\n        console.log(`Skeleton.getJointPosition(joint_name='${joint_name}', human=${human}, rest_coord=${rest_coord}) -> from base mesh`)\n        return _getHumanJointPosition(human, joint_name, rest_coord)\n    }\n\n    // makehuman/shared/skeleton.py:518\n    // Rebuild bone rest matrices and determine local bone orientation\n    // (roll or bone normal). Pass a ref_skel to copy the bone orientation from\n    // the reference skeleton to the bones of this skeleton.\n    build(ref_skel?: any) {\n        this.boneslist = undefined\n        for (const bone of this.getBones()) {\n            bone.build(ref_skel)\n        }\n    }\n\n    update() {\n        for (const bone of this.getBones()) {\n            bone.update()\n        }\n    }\n\n    updateJoints(human: Human) {\n        for (const bone of this.getBones()) {\n            bone.updateJointPositions(human)\n        }\n    }\n\n    // line 631\n    // Returns linear list of all bones in breadth-first order.\n    getBones(): Bone[] {\n        if (this.boneslist === undefined) {\n            this.boneslist = this.buildBoneList()\n        }\n        return this.boneslist\n    }\n\n    // makehuman/shared/skeleton.py:518: __cacheGetBones()\n    private buildBoneList(): Bone[] {\n        const result: Bone[] = []\n        let queue = [...this.roots]\n        while (queue.length > 0) {\n            const bone = queue.shift()!\n            bone.index = result.length\n            result.push(bone)\n            queue = queue.concat(...bone!.children)\n        }\n        return result\n    }\n\n    // line 509\n    addBone(\n        name: string,\n        parentName: string,\n        headJoint: string,\n        tailJoint: string,\n        roll: string,\n        reference_bones?: any,\n        weight_reference_bones?: any) {\n        // if name in list(self.bones.keys()):\n        //     raise RuntimeError(\"The skeleton %s already contains a bone named %s.\" % (self.__repr__(), name))\n        // bone = Bone(self, name, parentName, headJoint, tailJoint, roll, reference_bones, weight_reference_bones)\n        // self.bones[name] = bone\n        // if not parentName:\n        //     self.roots.append(bone)\n        // return bone\n        if (name in this.bones) {\n            throw Error(`The skeleton ${this.info.name} already contains a bone named ${name}.`)\n        }\n        const bone = new Bone(this, name, parentName, headJoint, tailJoint, roll, reference_bones, weight_reference_bones)\n        this.bones.set(name, bone)\n        if (!parentName) {\n            this.roots.push(bone)\n        }\n        return bone\n    }\n\n    // line 666\n    getBone(name: string): Bone {\n        const bone = this.bones.get(name)\n        if (bone === undefined) {\n            console.trace(`Skeleton.getBone(${name}): no such bone`)\n            throw Error(`Skeleton.getBone(${name}): no such bone`)\n        }\n        return bone\n    }\n\n    skinMesh(meshCoords: number[], vertBoneMapping: VertexBoneMapping): number[] {\n        const coords = new Array<number>(meshCoords.length).fill(0)\n        for (let [bname, mapping] of vertBoneMapping.entries()) {\n            const [verts, weights] = mapping\n            const bone = this.getBone(bname)\n            for (let i = 0; i < verts.length; ++i) {\n                const vert = verts[i] * 3\n                const weight = weights[i]\n                const vec = vec3.transformMat4(\n                    vec3.create(),\n                    vec3.fromValues(meshCoords[vert], meshCoords[vert + 1], meshCoords[vert + 2]),\n                    bone.matPoseVerts!)\n                coords[vert] += vec[0] * weight\n                coords[vert+1] += vec[1] * weight\n                coords[vert+2] += vec[2] * weight\n            }\n        }\n        return coords\n    }\n}\n","import { TargetRef } from './TargetRef'\n\n// {'data/targets/buttocks/buttocks-volume-decr.target': -0.0, 'data/targets/buttocks/buttocks-volume-incr.target': 0.5}\n\nexport function getTargetWeights(targets: TargetRef[], factors: Map<string, number>, value = 1.0, ignoreNotfound = false) {\n    // console.log(`getTargetWeights(..,..,${value}, ${ignoreNotfound})\"`)\n    const result = new Map<string, number>()\n    if (ignoreNotfound) {\n        targets.forEach((e) => {\n            // console.log([1, 2, 5].reduce( (a, v) => a*v))\n            // for factors in tfactors\n            let mul = 1\n            e.factorDependencies.forEach(factor => {\n                const f = factors.get(factor)\n                if (f !== undefined) {\n                    mul *= f\n                } else {\n                    console.log(`no factor for '${factor}'`)\n                }\n            })\n            result.set(e.targetPath, value * mul) \n        })\n        //     for (tpath, tfactors) in targets:\n        //         result[tpath] = value * reduce(operator.mul, [factors.get(factor, 1.0) for factor in tfactors])\n    } else {\n        targets.forEach((e) => {\n            // console.log([1, 2, 5].reduce( (a, v) => a*v))\n            // for factors in tfactors\n            let mul = 1\n            e.factorDependencies.forEach(factor => {\n                let f = factors.get(factor)\n                if (f === undefined) {\n                    console.log(`no factor for ${factor}`)\n                    f = 1/3\n                }\n                mul *= f || 0\n            })\n            result.set(e.targetPath, value * mul)\n        })\n    }\n    // console.log(result)\n    return result\n}\n","export class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map(a => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        while (element.childNodes.length > 0) {\n            element.removeChild(element.childNodes[element.childNodes.length - 1]);\n        }\n        this.appendTo(element);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== 'string') {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case 'children':\n                break;\n            case 'action':\n                element.setAction(value);\n                break;\n            case 'model':\n                element.setModel(value);\n                break;\n            case 'class':\n                element.classList.add(value);\n                break;\n            case 'style':\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case 'set':\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substr(2), value);\n                }\n                else {\n                    if (typeof value !== \"object\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        for (let child of props.children) {\n            if (typeof child === \"string\") {\n                element.appendChild(document.createTextNode(child));\n            }\n            else {\n                element.appendChild(child);\n            }\n        }\n    }\n}\nexport function createElement(nameOrConstructor, props, ...children) {\n    let key;\n    if (props !== null) {\n        if ('key' in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","export function css(strings, ...values) {\n    let str = strings[0];\n    values.forEach((s, i) => {\n        str = str.concat(s).concat(strings[i + 1]);\n    });\n    return str;\n}\nexport function element(type, children) {\n    const element = document.createElement(type);\n    for (let i = 0; i < children.length; ++i) {\n        let child = children[i];\n        if (child instanceof Array) {\n            children.splice(i, 1, ...child);\n            child = children[i];\n        }\n        if (typeof child === \"string\") {\n            element.appendChild(document.createTextNode(child));\n            continue;\n        }\n        element.appendChild(child);\n    }\n    return element;\n}\nexport function array(times, create) {\n    let a = [];\n    for (let i = 0; i < times; ++i) {\n        const c = create(i);\n        if (c instanceof Array) {\n            a.push(...c);\n        }\n        else {\n            a.push(c);\n        }\n    }\n    return a;\n}\nexport function text(text) { return document.createTextNode(text); }\nexport const div = (...children) => element(\"div\", children);\nexport const span = (...children) => element(\"span\", children);\nexport const slot = (...children) => element(\"slot\", children);\nexport const form = (...children) => element(\"form\", children);\nexport const input = (...children) => element(\"input\", children);\nexport const button = (...children) => element(\"button\", children);\nexport const ul = (...children) => element(\"ul\", children);\nexport const ol = (...children) => element(\"ol\", children);\nexport const li = (...children) => element(\"li\", children);\nexport const table = (...children) => element(\"table\", children);\nexport const thead = (...children) => element(\"thead\", children);\nexport const th = (...children) => element(\"th\", children);\nexport const tbody = (...children) => element(\"tbody\", children);\nexport const td = (...children) => element(\"td\", children);\nexport const tr = (...children) => element(\"tr\", children);\nconst ns = \"http://www.w3.org/2000/svg\";\nexport function svg(child) {\n    const s = document.createElementNS(ns, \"svg\");\n    if (child !== undefined) {\n        s.appendChild(child);\n    }\n    return s;\n}\nexport function path(d) {\n    const p = document.createElementNS(ns, \"path\");\n    if (d !== undefined) {\n        p.setAttributeNS(null, \"d\", d);\n    }\n    return p;\n}\nexport function rect(x, y, width, height, stroke, fill) {\n    const r = document.createElementNS(ns, \"rect\");\n    r.setAttributeNS(null, \"x\", `${x}`);\n    r.setAttributeNS(null, \"y\", `${y}`);\n    r.setAttributeNS(null, \"width\", `${width}`);\n    r.setAttributeNS(null, \"height\", `${height}`);\n    if (stroke !== undefined) {\n        r.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        r.setAttributeNS(null, \"fill\", fill);\n    }\n    return r;\n}\nexport function line(x1, y1, x2, y2, stroke, fill) {\n    const l = document.createElementNS(ns, \"line\");\n    l.setAttributeNS(null, \"x1\", `${x1}`);\n    l.setAttributeNS(null, \"y1\", `${y1}`);\n    l.setAttributeNS(null, \"x2\", `${x2}`);\n    l.setAttributeNS(null, \"y2\", `${y2}`);\n    if (stroke !== undefined) {\n        l.setAttributeNS(null, \"stroke\", stroke);\n    }\n    if (fill !== undefined) {\n        l.setAttributeNS(null, \"fill\", fill);\n    }\n    return l;\n}\nexport function svgAndUse(ref) {\n    const ns = \"http://www.w3.org/2000/svg\";\n    const s = document.createElementNS(ns, \"svg\");\n    const u = document.createElementNS(ns, \"use\");\n    u.setAttributeNS(ns, \"href\", ref);\n    u.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', ref);\n    s.appendChild(u);\n    return s;\n}\n//# sourceMappingURL=lsx.js.map","import { GenericModel } from \"./GenericModel.js\";\nexport class BooleanModel extends GenericModel {\n    constructor(value) {\n        super(value);\n    }\n}\n//# sourceMappingURL=BooleanModel.js.map","import { Model } from \"./Model.js\";\nexport class TextModel extends Model {\n    constructor(value = \"\") {\n        super();\n        this._value = value;\n    }\n    set promise(promise) {\n        this._value = promise;\n        this.modified.trigger();\n    }\n    get promise() {\n        if (typeof this._value === \"string\") {\n            return () => {\n                return this._value;\n            };\n        }\n        return this._value;\n    }\n    set value(value) {\n        if (this._value === value)\n            return;\n        if (typeof value !== \"string\") {\n            console.trace(`TextModel.set value(value: string): ${typeof value} is not type string`);\n            return;\n        }\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        switch (typeof this._value) {\n            case \"number\":\n            case \"string\":\n                this._value = `${this._value}`;\n                break;\n            case \"function\":\n                this._value = this._value();\n                break;\n        }\n        return this._value;\n    }\n}\n//# sourceMappingURL=TextModel.js.map","import { TextModel } from \"./TextModel.js\";\nexport class HtmlModel extends TextModel {\n    constructor(value) {\n        super(value);\n    }\n}\n//# sourceMappingURL=HtmlModel.js.map","import { Model } from \"./Model.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Action extends Model {\n    constructor(parent, title) {\n        super();\n        this.signal = new Signal();\n        this.title = title;\n        this._enabled = true;\n    }\n    set value(placeHolder) {\n        throw Error(\"Action.value can not be assigned a value\");\n    }\n    get value() {\n        throw Error(\"Action.value can not return a value\");\n    }\n    trigger(data) {\n        if (!this._enabled)\n            return;\n        this.signal.trigger(data);\n    }\n}\n//# sourceMappingURL=Action.js.map","export function instantiateTemplate(name) {\n    return tmpl(name);\n}\nexport function tmpl(name) {\n    let t = document.querySelector('template[id=\"' + name + '\"]');\n    if (!t) {\n        throw new Error(\"failed to find template '\" + name + \"'\");\n    }\n    let x = t;\n    let z = x.content;\n    let y = document.importNode(z, true);\n    return y;\n}\nexport function find(node, selector) {\n    return node.querySelector(selector);\n}\nexport function tag(name) { return document.createElement(name); }\nexport function txt(txt) { return document.createTextNode(txt); }\nexport function img(src) {\n    let img = document.createElement(\"img\");\n    img.src = src;\n    return img;\n}\nexport function add(n0, n1) { n0.appendChild(n1); }\nexport function remove(n) {\n    if (!n.parentNode)\n        throw Error(\"element has no parent\");\n    n.parentNode.removeChild(n);\n}\nexport function erase(n) {\n    n.replaceChildren();\n}\nexport function hasFocus(element) {\n    if (!document.hasFocus())\n        return false;\n    let active = document.activeElement;\n    while (active !== null) {\n        if (active === element) {\n            return true;\n        }\n        if (active.shadowRoot === null)\n            break;\n        active = active.shadowRoot.activeElement;\n    }\n    return false;\n}\nexport function grabMouse(event) {\n    let target = event.target;\n    let documentMouseMove = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mousemove\", event));\n        event.stopPropagation();\n    };\n    let documentMouseUp = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mouseup\", event));\n        document.removeEventListener(\"mousemove\", documentMouseMove, { capture: true });\n        document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n        document.body.style.pointerEvents = \"auto\";\n        event.stopPropagation();\n    };\n    document.addEventListener(\"mousemove\", documentMouseMove, { capture: true });\n    document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n    document.body.style.pointerEvents = \"none\";\n    event.preventDefault();\n    event.stopPropagation();\n}\nexport function attribute(element, name) {\n    let attribute = element.getAttribute(name);\n    if (attribute === null) {\n        console.log(\"missing attribute '\" + name + \"' in \", element);\n        throw Error(\"missing attribute '\" + name + \"' in \" + element.nodeName);\n    }\n    return attribute;\n}\nexport function attributeOrUndefined(element, name) {\n    let attribute = element.getAttribute(name);\n    return attribute === null ? undefined : attribute;\n}\nexport function isNodeBeforeNode(first, second) {\n    let node;\n    let firstPrevious = first;\n    node = first;\n    let parentsOfFirstNode = new Map();\n    while (true) {\n        firstPrevious = node;\n        node = node.parentNode;\n        if (!node)\n            break;\n        parentsOfFirstNode.set(node, firstPrevious);\n    }\n    let secondPrevious = second;\n    node = second;\n    while (node) {\n        secondPrevious = node;\n        node = node.parentNode;\n        if (!node) {\n            throw Error(`isNodeBeforeNode(first, second): nodes have no common parent`);\n        }\n        let lookup = parentsOfFirstNode.get(node);\n        if (lookup) {\n            firstPrevious = lookup;\n            break;\n        }\n    }\n    for (let child of node.childNodes) {\n        if (child === firstPrevious)\n            return true;\n        if (child === secondPrevious)\n            return false;\n    }\n    throw Error(\"isNodeBeforeNode(first, second): couldn't determine order of nodes\");\n}\nexport function pixelToNumber(pixel) {\n    if (pixel === \"\")\n        return 0;\n    if (pixel.substr(pixel.length - 2) !== \"px\")\n        throw Error(`pixelToNumber('${pixel}') expected 'px' suffix`);\n    return Number.parseFloat(pixel.substr(0, pixel.length - 2));\n}\nexport function getPropertyValue(element, propertyName) {\n    let elementStyle = window.getComputedStyle(element, undefined);\n    let property = elementStyle.getPropertyValue(propertyName);\n    return pixelToNumber(property);\n}\nexport function horizontalPadding(element) {\n    return getPropertyValue(element, \"padding-left\") + getPropertyValue(element, \"padding-right\");\n}\nexport function verticalPadding(element) {\n    return getPropertyValue(element, \"padding-top\") + getPropertyValue(element, \"padding-bottom\");\n}\n//# sourceMappingURL=dom.js.map","import { Controller } from \"./Controller.js\";\nexport let globalController = new Controller();\nexport function bindModel(modelId, model) {\n    globalController.bind(modelId, model);\n}\nexport function action(actionId, action) {\n    return globalController.registerAction(actionId, action);\n}\nexport function unbind() {\n    globalController.clear();\n}\nexport function text(modelId, value) {\n    return globalController.text(modelId, value);\n}\nexport function boolean(modelId, value) {\n    return globalController.boolean(modelId, value);\n}\n//# sourceMappingURL=globalController.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { Action } from \"../model/Action.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Controller {\n    constructor() {\n        this.modelId2Models = new Map();\n        this.modelId2Views = new Map();\n        this.view2ModelIds = new Map();\n        this.sigChanged = new Signal();\n    }\n    registerAction(actionId, callback) {\n        let action = new Action(undefined, actionId);\n        action.signal.add(callback);\n        this._registerModel(\"A:\" + actionId, action);\n        return action;\n    }\n    registerModel(modelId, model) {\n        this._registerModel(\"M:\" + modelId, model);\n    }\n    _registerModel(modelId, model) {\n        let modelsForModelId = this.modelId2Models.get(modelId);\n        if (!modelsForModelId) {\n            modelsForModelId = new Set();\n            this.modelId2Models.set(modelId, modelsForModelId);\n        }\n        modelsForModelId.add(model);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId)\n            return;\n        for (let view of viewsForModelId) {\n            view.setModel(model);\n        }\n    }\n    registerView(modelId, view) {\n        if (view.controller && view.controller !== this) {\n            console.log(\"error: attempt to register view more than once at different controllers\");\n            return;\n        }\n        view.controller = this;\n        let modelIdsForView = this.view2ModelIds.get(view);\n        if (!modelIdsForView) {\n            modelIdsForView = new Set();\n            this.view2ModelIds.set(view, modelIdsForView);\n        }\n        modelIdsForView.add(modelId);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId) {\n            viewsForModelId = new Set();\n            this.modelId2Views.set(modelId, viewsForModelId);\n        }\n        viewsForModelId.add(view);\n        let modelsForView = this.modelId2Models.get(modelId);\n        if (!modelsForView)\n            return;\n        for (let model of modelsForView) {\n            view.setModel(model);\n        }\n    }\n    unregisterView(view) {\n        if (!view.controller)\n            return;\n        if (view.controller !== this)\n            throw Error(\"attempt to unregister view from wrong controller\");\n        let modelIds = this.view2ModelIds.get(view);\n        if (!modelIds)\n            return;\n        for (let modelId of modelIds) {\n            let views = this.modelId2Views.get(modelId);\n            if (!views)\n                continue;\n            views.delete(view);\n            if (views.size === 0) {\n                this.modelId2Views.delete(modelId);\n            }\n            view.setModel(undefined);\n        }\n    }\n    clear() {\n        for (let entry of this.view2ModelIds) {\n            entry[0].setModel(undefined);\n        }\n        this.modelId2Models.clear();\n        this.modelId2Views.clear();\n        this.view2ModelIds.clear();\n    }\n    bind(modelId, model) {\n        this.registerModel(modelId, model);\n    }\n    action(actionId, callback) {\n        return this.registerAction(actionId, callback);\n    }\n    text(modelId, value) {\n        let model = new TextModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    html(modelId, value) {\n        let model = new HtmlModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    boolean(modelId, value) {\n        let model = new BooleanModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    number(modelId, value, options) {\n        let model = new NumberModel(value, options);\n        this.bind(modelId, model);\n        return model;\n    }\n}\n//# sourceMappingURL=Controller.js.map","export class AnimationBase {\n    constructor() {\n        this._stop = false;\n        this._firstFrame = this._firstFrame.bind(this);\n        this._animationFrame = this._animationFrame.bind(this);\n    }\n    start() {\n        this.prepare();\n        if (this._stop === true)\n            return;\n        this.requestAnimationFrame(this._firstFrame);\n    }\n    stop() {\n        this._stop = true;\n        if (this.animator?.current === this) {\n            this.animator.clearCurrent();\n        }\n    }\n    replace(animation) {\n        this.next = animation;\n        this.animationFrame(1);\n        this.lastFrame();\n        animation.prepare();\n    }\n    prepare() { }\n    firstFrame() { }\n    animationFrame(value) { }\n    lastFrame() { }\n    requestAnimationFrame(callback) {\n        window.requestAnimationFrame(callback);\n    }\n    _firstFrame(time) {\n        this.startTime = time;\n        this.firstFrame();\n        if (this._stop)\n            return;\n        this.animationFrame(0);\n        this.requestAnimationFrame(this._animationFrame);\n    }\n    _animationFrame(time) {\n        if (this.next) {\n            this.next._firstFrame(time);\n            return;\n        }\n        let elapsed = AnimationBase.animationFrameCount > 0 ? (time - this.startTime) / AnimationBase.animationFrameCount : 1;\n        elapsed = elapsed > 1 ? 1 : elapsed;\n        const value = this.ease(elapsed);\n        this.animationFrame(value);\n        if (this._stop) {\n            return;\n        }\n        if (value < 1.0) {\n            this.requestAnimationFrame(this._animationFrame.bind(this));\n        }\n        else {\n            this.lastFrame();\n            if (this.animator && this.animator._current === this) {\n                this.animator.clearCurrent();\n            }\n        }\n    }\n    ease(k) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n}\nAnimationBase.animationFrameCount = 468;\nclass AnimationWrapper extends AnimationBase {\n    constructor(animation) {\n        super();\n        this.animation = animation;\n    }\n    prepare() {\n        this.animation.prepare();\n    }\n    firstFrame() {\n        this.animation.firstFrame();\n    }\n    animationFrame(value) {\n        this.animation.animationFrame(value);\n    }\n    lastFrame() {\n        this.animation.lastFrame();\n    }\n}\nexport class Animator {\n    get current() {\n        if (this._current === undefined) {\n            return undefined;\n        }\n        if (this._current instanceof AnimationWrapper) {\n            return this._current.animation;\n        }\n        return this._current;\n    }\n    clearCurrent() {\n        this._current = undefined;\n    }\n    run(animation) {\n        let animationBase;\n        if (!(animation instanceof AnimationBase)) {\n            animationBase = new AnimationWrapper(animation);\n        }\n        else {\n            animationBase = animation;\n        }\n        const previousAnimation = this._current;\n        this._current = animationBase;\n        animationBase.animator = this;\n        if (previousAnimation) {\n            previousAnimation.animator = undefined;\n            previousAnimation.replace(animationBase);\n        }\n        else {\n            if (Animator.halt) {\n                return;\n            }\n            animationBase.start();\n        }\n    }\n}\nAnimator.halt = false;\n//# sourceMappingURL=animation.js.map","import { Model } from \"./Model.js\";\nexport class OptionModelBase extends Model {\n    constructor() {\n        super();\n        this._stringValue = \"\";\n    }\n    set stringValue(v) {\n        if (this._stringValue === v)\n            return;\n        this._stringValue = v;\n        this.modified.trigger();\n    }\n    get stringValue() {\n        return this._stringValue;\n    }\n    isValidStringValue(stringValue) {\n        return false;\n    }\n}\n//# sourceMappingURL=OptionModelBase.js.map","import { OptionModelBase } from \"./OptionModelBase.js\";\nexport class EnumModel extends OptionModelBase {\n    constructor(enumClass, value) {\n        super();\n        this.enumClass = enumClass;\n        if (value !== undefined) {\n            this._value = value;\n        }\n    }\n    get value() {\n        return this._value;\n    }\n    set value(value) {\n        this.setValue(value);\n    }\n    get stringValue() {\n        return this.toString();\n    }\n    set stringValue(value) {\n        this.fromString(value);\n    }\n    getValue() {\n        return this._value;\n    }\n    setValue(value) {\n        if (this._value === value) {\n            return;\n        }\n        this._value = value;\n        this.modified.trigger();\n    }\n    toString() {\n        return this.enumClass[this._value];\n    }\n    fromString(value) {\n        const x = this.enumClass[value];\n        if (x === undefined || typeof this.enumClass[x] !== \"string\") {\n            let allValidValues = \"\";\n            Object.keys(this.enumClass).forEach(key => {\n                const validValue = this.enumClass[key];\n                if (typeof validValue === \"string\") {\n                    if (allValidValues.length !== 0) {\n                        allValidValues = `${allValidValues}, ${validValue}`;\n                    }\n                    else {\n                        allValidValues = validValue;\n                    }\n                }\n            });\n            console.trace(`EnumModel<T>.fromString('${value}'): invalid value, must be one of ${allValidValues}`);\n            return;\n        }\n        if (this._value === x) {\n            return;\n        }\n        this._value = x;\n        this.modified.trigger();\n    }\n    isValidStringValue(value) {\n        const x = this.enumClass[value];\n        return x !== undefined && typeof this.enumClass[x] === \"string\";\n    }\n}\n//# sourceMappingURL=EnumModel.js.map","import { globalController } from \"../controller/globalController.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nexport class View extends HTMLElement {\n    static define(name, view, options) {\n        const element = window.customElements.get(name);\n        if (element === undefined) {\n            window.customElements.define(name, view, options);\n        }\n        else {\n            if (element !== view) {\n                console.trace(`View::define(${name}, ...): attempt to redefine view with different constructor`);\n            }\n        }\n    }\n    constructor(props) {\n        super();\n        setInitialProperties(this, props);\n    }\n    attachStyle(style) {\n        this.shadowRoot.appendChild(document.importNode(style, true));\n    }\n    setModel(model) {\n        console.trace(`Please note that View.setModel(model) has no implementation.`);\n    }\n    getModelId() {\n        if (!this.hasAttribute(\"model\"))\n            throw Error(\"no 'model' attribute\");\n        let modelId = this.getAttribute(\"model\");\n        if (!modelId)\n            throw Error(\"no model id\");\n        return \"M:\" + modelId;\n    }\n    getActionId() {\n        if (!this.hasAttribute(\"action\"))\n            throw Error(\"no 'action' attribute\");\n        let actionId = this.getAttribute(\"action\");\n        if (!actionId)\n            throw Error(\"no action id\");\n        return \"A:\" + actionId;\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        let modelId = \"\";\n        try {\n            modelId = this.getModelId();\n        }\n        catch (error) {\n        }\n        if (modelId != \"\")\n            globalController.registerView(modelId, this);\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n}\n//# sourceMappingURL=View.js.map","import { View } from \"./View.js\";\nexport class ModelView extends View {\n    constructor(init) {\n        super(init);\n        if (init?.model !== undefined) {\n            this.setModel(init.model);\n        }\n    }\n    updateModel() { }\n    updateView(data) { }\n    setModel(model) {\n        if (model === this.model)\n            return;\n        const view = this;\n        if (this.model)\n            this.model.modified.remove(view);\n        if (model)\n            model.modified.add((data) => view.updateView(data), view);\n        this.model = model;\n        if (this.isConnected) {\n            this.updateView(undefined);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model)\n            this.updateView(undefined);\n    }\n}\n//# sourceMappingURL=ModelView.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { Action } from \"../model/Action.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class ActionView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    connectedCallback() {\n        if (this.controller) {\n            this.updateView();\n            return;\n        }\n        try {\n            globalController.registerView(this.getActionId(), this);\n        }\n        catch (e) {\n        }\n        try {\n            globalController.registerView(this.getModelId(), this);\n        }\n        catch (e) {\n        }\n        this.updateView();\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.model)\n                this.model.modified.remove(this);\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n            this.model.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else {\n            throw Error(\"unexpected model of type \" + model.constructor.name);\n        }\n        this.updateView();\n    }\n    setAction(value) {\n        if (value instanceof Function) {\n            const action = new Action(undefined, \"\");\n            action.signal.add(value);\n            this.setModel(action);\n        }\n        else {\n            this.setModel(value);\n        }\n    }\n    isEnabled() {\n        return this.action !== undefined && this.action.enabled;\n    }\n}\n//# sourceMappingURL=ActionView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n:host {\n    display: inline-block;\n}\n\n.tx-text {\n    width: 100%;\n    box-shadow: none;\n    box-sizing: border-box;\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n\n    /* we'll use the border instead of an outline to indicate the focus */\n    outline: none;\n    border-width: var(--tx-border-width);\n    border-style: solid;\n    border-color: var(--tx-border-color);\n    border-radius: var(--tx-border-radius);\n\n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n\n    padding: 4px 8px 4px 8px;\n    text-indent: 0;\n    vertical-align: top;\n    margin: 0;\n    overflow: visible;\n    text-overflow: ellipsis;\n}\n.tx-text:hover {\n    border-color: var(--tx-border-color-hover);\n}\n.tx-text:disabled {\n    color: var(--tx-fg-color-disabled);\n    background-color: var(--tx-bg-color-disabled);\n    border-color: var(--tx-bg-color-disabled);\n}\n.tx-text::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n.tx-text:hover::placeholder {\n    color: var(--tx-placeholder-fg-color-hover);\n}\n.tx-text:focus {\n    border-color: var(--tx-outline-color);\n}\n`;\n//# sourceMappingURL=tx-text.js.map","import { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class Text extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = document.createElement(\"input\");\n        this.input.classList.add(\"tx-text\");\n        this.input.oninput = () => { this.updateModel(); };\n        this.wheel = this.wheel.bind(this);\n        this.input.onwheel = this.wheel;\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txText);\n        this.shadowRoot.appendChild(this.input);\n    }\n    wheel(e) {\n        if (this.model instanceof NumberModel) {\n            if (e.deltaY > 0) {\n                this.model.decrement();\n                e.preventDefault();\n            }\n            if (e.deltaY < 0) {\n                this.model.increment();\n                e.preventDefault();\n            }\n        }\n    }\n    focus() {\n        this.input.focus();\n    }\n    blur() {\n        this.input.blur();\n    }\n    static get observedAttributes() { return ['value']; }\n    attributeChangedCallback(name, oldValue, newValue) {\n        switch (name) {\n            case \"value\":\n                if (this.model && newValue !== undefined) {\n                    this.model.value = newValue;\n                }\n                break;\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.value;\n        }\n        this.setAttribute(\"value\", this.input.value);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        const strValue = `${this.model.value}`;\n        if (this.input.value !== strValue) {\n            this.input.value = strValue;\n            this.setAttribute(\"value\", this.input.value);\n        }\n    }\n    get value() {\n        return this.input.value;\n    }\n    set value(value) {\n        this.input.value = value;\n        this.updateModel();\n    }\n}\nText.define(\"tx-text\", Text);\n//# sourceMappingURL=Text.js.map","export let textAreaStyle = document.createElement(\"style\");\ntextAreaStyle.textContent = `\n\n/* try to follow material ui: when active render button labels in black, otherwise in gray */\nsvg .fill {\n  fill: var(--tx-gray-700);\n  stroke: var(--tx-gray-700);\n}\nsvg .stroke {\n  fill: none;\n  stroke: var(--tx-gray-700);\n}\nsvg .strokeFill {\n  fill: var(--tx-gray-200);\n  stroke: var(--tx-gray-700);\n}\n\n/*\nthese don't seem to be in use anymore\n.toolbar.active svg .fill {\n  fill: #000;\n  stroke: #000;\n}\n.toolbar.active svg .stroke {\n  fill: none;\n  stroke: #000;\n}\n.toolbar.active svg .strokeFill {\n  fill: #fff;\n  stroke: #000;\n}\n*/\n\n.toolbar button {\n    background: var(--tx-gray-75);\n    color: var(--tx-gray-800);\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    padding: 5;\n    margin: 0;\n    vertical-align: middle;\n    height: 22px;\n}\n\n.toolbar button:active:hover {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n}\n\n.toolbar button.left {\n    border-style: solid;\n    border-radius: 3px 0 0 3px;\n}\n\n.toolbar button.right {\n    border: 1px var(--tx-gray-400);\n    border-style: solid solid solid none;\n    border-radius: 0 3px 3px 0;\n}\n\n.toolbar button.active {\n    background: linear-gradient(to bottom, var(--tx-gray-600) 0%,var(--tx-gray-50) 100%,var(--tx-gray-500) 100%);\n    border: 1px var(--tx-global-blue-500) solid;\n    color: var(--tx-gray-900);\n}\n\ndiv.textarea {\n  font-family: var(--tx-font-family);\n  font-size: var(--tx-font-size);\n  border: 1px var(--tx-gray-400) solid;\n  border-radius: 3px;\n  margin: 2px;\n  padding: 4px 5px;\n  outline-offset: -2px;\n}\n\ndiv.textarea h1 {\n  font-size: 22px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h2 {\n  font-size: 18px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h3 {\n  font-size: 16px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h4 {\n  font-size: 14px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea div {\n  padding: 2px 0 2px 0;\n}\n`;\n//# sourceMappingURL=textAreaStyle.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { textAreaStyle } from \"./textAreaStyle.js\";\nexport class TextTool extends ModelView {\n    constructor() {\n        super();\n        TextTool.texttool = this;\n        let toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonH1 = _jsx(\"button\", { class: \"left\", children: \"H1\" });\n        this.buttonH1.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h1>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH1);\n        this.buttonH2 = _jsx(\"button\", { children: \"H2\" });\n        this.buttonH2.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h2>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH2);\n        this.buttonH3 = _jsx(\"button\", { children: \"H3\" });\n        this.buttonH3.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h3>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH3);\n        this.buttonH4 = _jsx(\"button\", { class: \"right\", children: \"H4\" });\n        this.buttonH4.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h4>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH4);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonBold = _jsx(\"button\", { class: \"left\", children: _jsx(\"b\", { children: \"B\" }) });\n        this.buttonBold.onclick = () => {\n            document.execCommand(\"bold\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonBold);\n        this.buttonItalic = _jsx(\"button\", { children: _jsx(\"i\", { children: \"I\" }) });\n        this.buttonItalic.onclick = () => {\n            document.execCommand(\"italic\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonItalic);\n        this.buttonUnderline = _jsx(\"button\", { children: _jsx(\"u\", { children: \"U\" }) });\n        this.buttonUnderline.onclick = () => {\n            document.execCommand(\"underline\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonUnderline);\n        this.buttonStrikeThrough = _jsx(\"button\", { children: _jsx(\"strike\", { children: \"S\" }) });\n        this.buttonStrikeThrough.onclick = () => {\n            document.execCommand(\"strikeThrough\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonStrikeThrough);\n        this.buttonSubscript = _jsx(\"button\", { children: \"x\\u2082\" });\n        this.buttonSubscript.onclick = () => {\n            document.execCommand(\"subscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSubscript);\n        this.buttonSuperscript = _jsx(\"button\", { class: \"right\", children: \"x\\u00B2\" });\n        this.buttonSuperscript.onclick = () => {\n            document.execCommand(\"superscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSuperscript);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonJustifyLeft = _jsx(\"button\", { class: \"left\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"2.5\", x2: \"6\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"6.5\", x2: \"6\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyLeft.onclick = () => {\n            document.execCommand(\"justifyLeft\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyLeft);\n        this.buttonJustifyCenter = _jsx(\"button\", { children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"2.5\", x2: \"8\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"8\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyCenter.onclick = () => {\n            document.execCommand(\"justifyCenter\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyCenter);\n        this.buttonJustifyRight = _jsx(\"button\", { class: \"right\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"2.5\", x2: \"10\", y2: \"2.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"6.5\", x2: \"10\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonJustifyRight.onclick = () => {\n            document.execCommand(\"justifyRight\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyRight);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textAreaStyle, true));\n        this.shadowRoot.appendChild(toolbar);\n    }\n    update() {\n        this.buttonH1.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h1\");\n        this.buttonH2.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h2\");\n        this.buttonH3.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h3\");\n        this.buttonH4.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h4\");\n        this.buttonBold.classList.toggle(\"active\", document.queryCommandState(\"bold\"));\n        this.buttonItalic.classList.toggle(\"active\", document.queryCommandState(\"italic\"));\n        this.buttonUnderline.classList.toggle(\"active\", document.queryCommandState(\"underline\"));\n        this.buttonStrikeThrough.classList.toggle(\"active\", document.queryCommandState(\"strikeThrough\"));\n        this.buttonSubscript.classList.toggle(\"active\", document.queryCommandState(\"subscript\"));\n        this.buttonSuperscript.classList.toggle(\"active\", document.queryCommandState(\"superscript\"));\n        this.buttonJustifyLeft.classList.toggle(\"active\", document.queryCommandState(\"justifyLeft\"));\n        this.buttonJustifyCenter.classList.toggle(\"active\", document.queryCommandState(\"justifyCenter\"));\n        this.buttonJustifyRight.classList.toggle(\"active\", document.queryCommandState(\"justifyRight\"));\n    }\n}\nTextTool.define(\"tx-texttool\", TextTool);\n//# sourceMappingURL=TextTool.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { TextTool } from \"./TextTool.js\";\nimport { style as txText } from \"../style/tx-text.js\";\nexport class TextArea extends ModelView {\n    constructor() {\n        super();\n        let content = document.createElement(\"div\");\n        this.content = content;\n        content.classList.add(\"tx-text\");\n        content.contentEditable = \"true\";\n        content.oninput = (event) => {\n            if (this.model instanceof HtmlModel) {\n                let firstChild = event.target.firstChild;\n                if (firstChild && firstChild.nodeType === 3) {\n                    document.execCommand(\"formatBlock\", false, `<div>`);\n                }\n                else if (content.innerHTML === \"<br>\") {\n                    content.innerHTML = \"\";\n                }\n            }\n            this.updateModel();\n        };\n        content.onkeydown = (event) => {\n            if (!(this.model instanceof HtmlModel)) {\n                return;\n            }\n            if (event.metaKey === true && event.key === \"b\") {\n                event.preventDefault();\n                document.execCommand(\"bold\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"i\") {\n                event.preventDefault();\n                document.execCommand(\"italic\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"u\") {\n                event.preventDefault();\n                document.execCommand(\"underline\", false);\n                this.updateTextTool();\n            }\n            else if (event.key === \"Tab\") {\n                event.preventDefault();\n            }\n            else if (event.key === \"Enter\" &&\n                event.shiftKey !== true &&\n                document.queryCommandValue(\"formatBlock\") === \"blockquote\") {\n                document.execCommand(\"formatBlock\", false, \"<p>\");\n            }\n        };\n        content.onkeyup = () => {\n            this.updateTextTool();\n        };\n        content.onmouseup = () => {\n            this.updateTextTool();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txText);\n        this.shadowRoot.appendChild(content);\n    }\n    updateTextTool() {\n        if (TextTool.texttool !== undefined)\n            TextTool.texttool.update();\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.promise = () => {\n                if (this.model instanceof HtmlModel) {\n                    return this.content.innerHTML;\n                }\n                else {\n                    return this.content.innerText;\n                }\n            };\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            if (this.content.innerHTML !== this.model.value) {\n                this.content.innerHTML = this.model.value;\n            }\n        }\n        else {\n            if (this.content.innerText !== this.model.value) {\n                this.content.innerText = this.model.value;\n            }\n        }\n    }\n}\nTextArea.define(\"tx-textarea\", TextArea);\n//# sourceMappingURL=TextArea.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nexport class Display extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.innerText = \"\";\n            return;\n        }\n        if (this.model instanceof TextModel) {\n            this.innerText = this.model.value;\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            this.innerHTML = this.model.value;\n            return;\n        }\n        if (this.model instanceof NumberModel) {\n            this.innerText = `${this.model.value}`;\n            return;\n        }\n    }\n}\nDisplay.define(\"tx-display\", Display);\n//# sourceMappingURL=Display.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n.tx-button {\n    padding: 2px 14px 2px 14px;\n    margin: 0;\n    color: var(--tx-gray-800);\n    transition: background-color 130ms ease-in-out;\n    background-color: var(--tx-gray-300);\n    border: 0 none;\n    height: 28px;\n    border-radius: 16px;\n    box-shadow: none;\n}\n\n:host(.tx-default) > .tx-button {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-800);\n}\n\n/* accent */\n\n:host(.tx-accent) > .tx-button {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-600);\n}\n\n:host(.tx-accent) > .tx-button:hover, :host(.tx-accent) > .tx-button:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-700);\n}\n:host(.tx-accent) > .tx-button:hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-blue-500);\n}\n\n/* negative */\n\n:host(.tx-negative) > .tx-button {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-600);\n}\n:host(.tx-negative) > :hover, :host(.tx-negative) > :active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-700);\n}\n:host(.tx-negative) > :hover:active {\n    color: var(--tx-static-white);\n    background-color: var(--tx-static-red-500);\n}\n\n.tx-button:hover, .tx-button:active {\n    color: var(--tx-gray-900);\n    background-color: var(--tx-gray-400);\n}\n:host(.tx-default) > .tx-button:hover, :host(.tx-default) > .tx-button:hover:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-button:hover:active {\n    color: var(--tx-gray-900);\n    background-color: var(--tx-gray-500);\n}\n\n.tx-button:hover:active > span {\n    transition: transform 130ms ease-in-out;\n    transform: translate(1px, 1px);\n}\n\n:host(.tx-default) > .tx-button:active {\n    color: var(--tx-gray-50);\n    background-color: var(--tx-gray-900);\n}\n\n.tx-label {\n    font-weight: bold;\n    padding: 4px 0 6px 0;\n    /* override parent flex/grid's align-items property to align in the center */\n    align-self: center;\n    /* adjust sides in container to look centered...? */\n    justify-self: center;\n    /* align children in the center */\n    text-align: center;\n}\n`;\n//# sourceMappingURL=tx-button.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ActionView } from \"./ActionView.js\";\nimport { button, span } from \"../util/lsx.js\";\nimport { style as txButton } from \"../style/tx-button.js\";\nexport class Button extends ActionView {\n    constructor(init) {\n        super(init);\n        this.button = button(this.label = span());\n        this.button.classList.add(\"tx-button\");\n        this.label.classList.add(\"tx-label\");\n        this.button.onclick = () => {\n            if (this.action)\n                this.action.trigger();\n        };\n        this.button.disabled = true;\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txButton);\n        this.shadowRoot.appendChild(this.button);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.children.length !== 0) {\n            return;\n        }\n        this._observer = new MutationObserver((record, observer) => {\n            if (this._timer !== undefined)\n                clearTimeout(this._timer);\n            this._timer = window.setTimeout(() => {\n                this._timer = undefined;\n                this.updateView();\n            }, 100);\n        });\n        this._observer.observe(this, {\n            childList: true,\n            subtree: true,\n            characterData: true\n        });\n    }\n    updateView() {\n        if (!this.isConnected)\n            return;\n        if (this.model && this.model.value) {\n            if (this.model instanceof HtmlModel)\n                this.label.innerHTML = this.model.value;\n            else\n                this.label.innerText = this.model.value;\n        }\n        else {\n            this.label.innerHTML = this.innerHTML;\n        }\n        this.button.disabled = !this.isEnabled();\n    }\n}\nButton.define(\"tx-button\", Button);\n//# sourceMappingURL=Button.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class BooleanView extends ModelView {\n    setModel(model) {\n        if (model !== undefined && !(model instanceof BooleanModel)) {\n            throw Error(`BooleanView.setModel(): model is not of type BooleanModel`);\n        }\n        super.setModel(model);\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.checked;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.value;\n        }\n    }\n}\n//# sourceMappingURL=BooleanView.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n:host(.tx-checkbox) {\n    display: inline-block;\n    position: relative;\n    box-shadow: none;\n    box-sizing: border-box;\n    padding: 0;\n    margin: 2px; /* leave space for the focus ring */\n    border: none 0;\n    height: 14px;\n    width: 14px;\n}\n\n:host(.tx-checkbox) > input {\n    box-sizing: border-box;\n    width: 14px;\n    height: 14px;\n    outline: none;\n    padding: 0;\n    margin: 0;\n    border: 2px solid;\n    border-radius: 2px;\n    border-color: var(--tx-gray-700);\n    /* border-radius: var(--tx-border-radius); */\n    color: var(--tx-edit-fg-color);\n    background-color: var(--tx-edit-bg-color);\n    -webkit-appearance: none;\n}\n\n/* this is a svg 2 feature, works with firefox, chrome and edge, but not safari */\n/* :host(.tx-checkbox) > svg > path {\n    d: path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\");\n} */\n\n/* focus ring */\n:host(.tx-checkbox) > input:focus-visible {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n:host(.tx-checkbox) > svg {\n    position: absolute;\n    left: 2px;\n    top: 2px;\n    stroke: none;\n    fill: var(--tx-edit-bg-color);\n    width: 10px;\n    height: 10px;\n    pointer-events: none;\n}\n\n:host(.tx-checkbox) > input:hover {\n    border-color: var(--tx-gray-800);\n}\n.tx-checkbox > input:focus {\n    border-color: var(--tx-outline-color);\n}\n\n:host(.tx-checkbox) > input:checked {\n    background-color: var(--tx-gray-700);\n}\n:host(.tx-checkbox) > input:hover:checked {\n    background-color: var(--tx-gray-800);\n}\n\n:host(.tx-checkbox) > input:disabled {\n    color: var(--tx-gray-400);\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-checkbox) > input:checked:disabled {\n    background-color: var(--tx-gray-400);\n}\n`;\n//# sourceMappingURL=tx-checkbox.js.map","import { BooleanView } from \"./BooleanView.js\";\nimport { input, svg, path } from \"../util/lsx.js\";\nimport { style as txCheckbox } from \"../style/tx-checkbox.js\";\nexport class Checkbox extends BooleanView {\n    constructor() {\n        super();\n        this.classList.add(\"tx-checkbox\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.input.onchange = () => {\n            this.updateModel();\n        };\n        const checkmark = svg(path(\"M3.5 9.5a.999.999 0 01-.774-.368l-2.45-3a1 1 0 111.548-1.264l1.657 2.028 4.68-6.01A1 1 0 019.74 2.114l-5.45 7a1 1 0 01-.777.386z\"));\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txCheckbox);\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(checkmark);\n    }\n}\nCheckbox.define(\"tx-checkbox\", Checkbox);\n//# sourceMappingURL=Checkbox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n.tx-search {\n    display: inline-block;\n    position: relative;\n}\n.tx-search > div {\n    display: inline-flex;\n    position: relative;\n}\n.tx-search > div > svg {\n    display: block;\n    position: absolute;\n    height: 18px;\n    width: 18px;\n    top: 7px;\n    left: 10px;\n    pointer-events: none;\n    overflow: hidden;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input {\n    box-sizing: border-box;\n    padding: 3px 12px 5px 35px;\n    margin: 0;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    -webkit-appearance: none;\n    outline-offset: -2px;\n    outline: none;\n    width: 100%;\n    height: 32px;\n    overflow: visible;\n    background: var(--tx-gray-50);\n\n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n}\n/* the button is transparent so that the border of the input field remains visible */\n.tx-search > button {\n    display: inline-flex;\n    position: absolute;\n    box-sizing: border-box;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 32px;\n    padding: 0;\n    margin: 1px;\n    border: none;\n    align-items: center;\n    justify-content: center;\n    overflow: visible;\n    vertical-align: top;\n    cursor: pointer;\n    border-radius: 0 4px 4px 0;\n    text-align: center;\n    outline: none;\n\n    background-color: var(--tx-gray-50);\n    border-radius: 0 4px 4px 0;\n\n}\n.tx-search > button > svg {\n    display: inline-block;\n    pointer-events: none;\n    height: 10px;\n    width: 10px;\n    padding: 0;\n    margin: 0;\n    border: none;\n    fill: var(--tx-gray-700);\n}\n.tx-search > div > input:hover {\n    border-color: var(--tx-gray-500);\n}\n\n.tx-search > div > input:focus {\n    border-color: var(--tx-outline-color);\n}\n.tx-search > button:focus > svg {\n    fill: var(--tx-outline-color);\n}\n\n.tx-search > div > input:disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled {\n    background-color: var(--tx-gray-200);\n}\n.tx-search > button:disabled > svg {\n    fill: var(--tx-gray-400);\n}`;\n//# sourceMappingURL=tx-search.js.map","import { ModelView } from \"./ModelView.js\";\nimport { form, input, button, svg, path, div } from \"../util/lsx.js\";\nimport { style as txSearch } from \"../style/tx-search.js\";\nexport class Search extends ModelView {\n    constructor() {\n        super();\n        let s0, s1, b, i, p;\n        const f = form(div(s0 = svg(p = path(\"M33.173 30.215L25.4 22.443a12.826 12.826 0 10-2.957 2.957l7.772 7.772a2.1 2.1 0 002.958-2.958zM6 15a9 9 0 119 9 9 9 0 01-9-9z\")), i = input()), b = button(s1 = svg(path(\"M6.548 5L9.63 1.917A1.094 1.094 0 008.084.371L5.001 3.454 1.917.37A1.094 1.094 0 00.371 1.917L3.454 5 .37 8.085A1.094 1.094 0 101.917 9.63l3.084-3.083L8.084 9.63a1.094 1.094 0 101.547-1.546z\"))));\n        s0.setAttributeNS(null, \"width\", \"100%\");\n        s0.setAttributeNS(null, \"height\", \"100%\");\n        p.setAttributeNS(null, \"transform\", \"scale(0.5, 0.5)\");\n        s1.setAttributeNS(null, \"width\", \"100%\");\n        s1.setAttributeNS(null, \"height\", \"100%\");\n        i.type = \"search\";\n        i.placeholder = \"Search\";\n        i.autocomplete = \"off\";\n        f.classList.add(\"tx-search\");\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txSearch);\n        this.shadowRoot.appendChild(f);\n    }\n}\nSearch.define(\"tx-search\", Search);\n//# sourceMappingURL=Search.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n/* a div on top serves as the container for elements used for the switch*/\n:host(.tx-switch) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n/* an invisible checkbox will overlay everything, handling input and state */\n:host(.tx-switch) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n/* the span provides the visual appearance */\n:host(.tx-switch) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 0;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 0px none;\n    border-radius: 7px;\n\n    width: 26px;\n    height: 14px;\n    background: var(--tx-gray-300);\n}\n\n/* focus ring */\n:host(.tx-switch) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n/* this is the knob on the switch */\n:host(.tx-switch) > span:before {\n    display: block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 14px;\n    height: 14px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: transform 130ms ease-in-out;\n}\n:host(.tx-switch) > input:hover + span:before {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked + span:before {\n    /* border-color: var(--tx-gray-700); */\n    transform: translateX(calc(100% - 2px));\n}\n\n:host(.tx-switch) > input:checked + span {\n    background: var(--tx-gray-700);\n}\n:host(.tx-switch) > input:checked:hover + span {\n    background: var(--tx-gray-900);\n}\n:host(.tx-switch) > input:hover + span + label {\n    color: var(--tx-gray-900);\n}\n\n:host(.tx-switch) > input:checked:disabled + span {\n    background: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span:before {\n    border-color: var(--tx-gray-400);\n}\n:host(.tx-switch) > input:disabled + span + label {\n    color: var(--tx-gray-400);\n}`;\n//# sourceMappingURL=tx-switch.js.map","import { input, span } from \"../util/lsx.js\";\nimport { BooleanView } from \"./BooleanView.js\";\nimport { style as txSwitch } from \"../style/tx-switch.js\";\nexport class Switch extends BooleanView {\n    constructor() {\n        super();\n        this.classList.add(\"tx-switch\");\n        this.input = input();\n        this.input.type = \"checkbox\";\n        this.input.onchange = () => {\n            this.updateModel();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txSwitch);\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(span());\n    }\n}\nSwitch.define(\"tx-switch\", Switch);\n//# sourceMappingURL=Switch.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n:host(.tx-radio) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n/* an invisible radiobutton will overlay everything, handling input and state */\n:host(.tx-radio) > input {\n    display: inline-block;\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    box-sizing: absolute;\n    margin: 0;\n    padding: 0;\n    opacity: 0;\n    z-index: 1;\n}\n\n/* the span provides the visual appearance */\n:host(.tx-radio) > span {\n    display: block;\n    position: relative;\n    left: 0;\n    top: 0;\n    box-sizing: border-box;\n    flex-grow: 0;\n    flex-shrink: 0;\n\n    border: 2px solid var(--tx-gray-700);\n    border-radius: 7px;\n\n    width: 14px;\n    height: 14px;\n    background: none;\n}\n\n/* focus ring */\n:host(.tx-radio) > input:focus-visible + span {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n/* this is the knob on the switch */\n:host(.tx-radio) > span:before {\n    display: block;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    width: 10px;\n    height: 10px;\n    background: var(--tx-gray-75);\n    border: 2px solid var(--tx-gray-75);\n    border-radius: 7px;\n    content: \"\";\n    box-sizing: border-box;\n\n    /* 'transform' usually can be GPU acclerated while 'left' can not */\n    transition: opacity 130ms ease-in-out;\n}\n:host(.tx-radio) > input:checked + span:before {\n    background: var(--tx-gray-700);\n}\n:host(.tx-radio) > input:checked:hover + span:before {\n    background: var(--tx-gray-900);\n}\n:host(.tx-radio) > input:hover + span {\n    border-color: var(--tx-gray-900);\n}\n\n:host(.tx-radio) > input:checked:disabled + span:before {\n    background: var(--tx-gray-500);\n}\n:host(.tx-radio) > input:disabled + span {\n    border-color: var(--tx-gray-500);\n}\n`;\n//# sourceMappingURL=tx-radio.js.map","import { ModelView } from \"./ModelView.js\";\nimport { input, span } from \"../util/lsx.js\";\nimport { style as txRadio } from \"../style/tx-radio.js\";\nexport class RadioButton extends ModelView {\n    constructor(init) {\n        super(init);\n        this.classList.add(\"tx-radio\");\n        this.input = input();\n        this.input.type = \"radio\";\n        this.input.value = this.getAttribute(\"value\");\n        let view = this;\n        this.input.onchange = () => {\n            view.updateModel();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txRadio);\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(span());\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.stringValue = this.input.value;\n        }\n    }\n    updateView() {\n        if (this.model) {\n            let radioGroup = RadioButton.radioGroups.get(this.model);\n            if (radioGroup === undefined) {\n                radioGroup = ++RadioButton.radioGroupCounter;\n                RadioButton.radioGroups.set(this.model, radioGroup);\n            }\n            this.input.name = `radioGroup${radioGroup}`;\n        }\n        else {\n            this.input.name = \"\";\n        }\n        if (!this.model || !this.model.enabled) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model) {\n            this.input.checked = this.model.stringValue === this.input.value;\n        }\n    }\n}\nRadioButton.radioGroupCounter = 0;\nRadioButton.radioGroups = new WeakMap();\nRadioButton.define(\"tx-radiobutton\", RadioButton);\n//# sourceMappingURL=RadioButton.js.map","export var MenuState;\n(function (MenuState) {\n    MenuState[MenuState[\"WAIT\"] = 0] = \"WAIT\";\n    MenuState[MenuState[\"DOWN\"] = 1] = \"DOWN\";\n    MenuState[MenuState[\"UP_N_HOLD\"] = 2] = \"UP_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_HOLD\"] = 3] = \"DOWN_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_OUTSIDE\"] = 4] = \"DOWN_N_OUTSIDE\";\n    MenuState[MenuState[\"DOWN_N_INSIDE_AGAIN\"] = 5] = \"DOWN_N_INSIDE_AGAIN\";\n})(MenuState || (MenuState = {}));\n//# sourceMappingURL=MenuState.js.map","import { View } from \"../view/View.js\";\nimport { MenuState } from \"./MenuState.js\";\nexport class MenuButtonContainer extends View {\n    constructor(props) {\n        super(props);\n        this.vertical = true;\n        this.closeOnClose = false;\n        this.state = MenuState.WAIT;\n    }\n}\n//# sourceMappingURL=MenuHelper.js.map","import { View } from \"../view/View.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nexport class PopupMenu extends MenuButtonContainer {\n    constructor(root, parent) {\n        super();\n        this.vertical = true;\n        this.root = root;\n        this.parentButton = parent;\n        this.popup = document.createElement(\"div\");\n        this.popup.classList.add(\"menu-popup\");\n        let node = root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.popup);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.appendChild(this.popup);\n        this.show();\n    }\n    show() {\n        if (!this.parentButton.master.vertical)\n            placePopupVertical(this.parentButton, this.popup);\n        else\n            placePopupHorizontal(this.parentButton, this.popup);\n        this.style.display = \"\";\n    }\n    hide() {\n        this.style.display = \"none\";\n    }\n}\nexport function placePopupVertical(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + \"px\";\n    popup.style.top = (parentBoundary.top + parentBoundary.height) + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + parentBoundary.height + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = (parentBoundary.top - popupBoundary.height) + \"px\";\n        }\n        let popupRight = parentBoundary.left + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = (parentBoundary.left + parentBoundary.width - popupBoundary.width) + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nexport function placePopupHorizontal(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = (parentBoundary.left + parentBoundary.width) + \"px\";\n    popup.style.top = parentBoundary.top + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = (parentBoundary.top + parentBoundary.height - popupBoundary.height) + \"px\";\n        }\n        let popupRight = parentBoundary.left + parentBoundary.width + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = (parentBoundary.left - popupBoundary.width) + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nView.define(\"tx-popupmenu\", PopupMenu);\n//# sourceMappingURL=PopupMenu.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n:host(.tx-combobox) {\n    display: inline-flex;\n    align-items: flex-start;\n    position: relative;\n    vertical-align: top;\n}\n:host(.tx-combobox) > input {\n    box-sizing: border-box;\n    width: 100%;\n    height: 32px;\n    margin: 0;\n    padding: 3px 32px 5px 11px;\n    vertical-align: top;\n    overflow: visible;\n    outline: none;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    background-color: var(--tx-gray-50);\n\n    color: var(--tx-gray-900);  \n    font-weight: var(--tx-edit-font-weight);\n    font-size: var(--tx-edit-font-size);\n    line-height: 18px;\n}\n:host(.tx-combobox) > input::placeholder {\n    color: var(--tx-placeholder-fg-color);\n    font-style: italic;\n    font-weight: 300;\n}\n\n:host(.tx-combobox) > button {\n    position: absolute;\n    right: 0;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    border-style: none;\n    box-sizing: border-box;\n    overflow: visible;\n    margin: 0;\n    text-transform: none;\n\n    width: 32px;\n    height: 32px;\n    background-color: var(--tx-gray-75);\n    border-radius: 0 4px 4px 0;\n    border: 1px solid var(--tx-gray-400);\n}\n:host(.tx-combobox) > button > svg {\n    fill: var(--tx-gray-700);\n    transform: rotate(90deg) translate(5px, 8px);\n}\n\n:host(.tx-combobox) > input:hover {\n    border-color: var(--tx-gray-500);\n}\n:host(.tx-combobox) > button:hover {\n    border-color: var(--tx-gray-500);\n    background-color: var(--tx-gray-50);\n}\n:host(.tx-combobox) > button:hover > svg {\n    fill: var(--tx-gray-900);\n}\n\n:host(.tx-combobox) > input:focus {\n    border-color: var(--tx-outline-color);\n}\n:host(.tx-combobox) > input:focus + button {\n    border-color: var(--tx-outline-color);\n}\n/* spectrum use a 1px focus ring when the focus was set by mouse\n * and a 2px focus ring when the focus was set by keyboard\n * no clue how to do that with css\n *\n/* :host(.tx-combobox) > input:focus-visible {\n    outline: 1px solid var(--tx-outline-color);\n}\n:host(.tx-combobox) > input:focus-visible + button {\n    outline: 1px solid var(--tx-outline-color);\n    border-left: none;\n} */\n\n:host(.tx-combobox) > input:disabled {\n    color: var(--tx-gray-700);\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > input:disabled + button {\n    background-color: var(--tx-gray-200);\n    border-color: var(--tx-gray-200);\n}\n:host(.tx-combobox) > input:disabled + button > svg {\n    fill: var(--tx-gray-400);\n}\n`;\n//# sourceMappingURL=tx-combobox.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n.tx-popover {\n    background-color: var(--tx-gray-50);\n    border: 1px solid var(--tx-gray-400);\n    border-radius: 4px;\n    display: inline-flex;\n    flex-direction: column;\n    filter: drop-shadow(rgba(0, 0, 0, 0.5) 0px 1px 4px);\n}\n.tx-menu {\n    display: inline-block;\n    padding: 0;\n    margin: 4px 0 4px 0;\n}\n.tx-menu > li {\n    cursor: pointer;\n    display: flex;\n    border: none;\n    border-left: 2px solid var(--tx-gray-50);\n    border-right: 2px solid var(--tx-gray-50);\n    padding: 7px 11px 7px 10px;\n    margin: 0;\n    font-weight: 500;\n    outline: none;\n}\n.tx-menu > li:hover {\n    background-color: var(--tx-gray-100);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li.tx-hover {\n    background-color: var(--tx-gray-100);\n    border-color: var(--tx-gray-100);\n}\n.tx-menu > li:focus {\n    border-left-color: var(--tx-outline-color);\n}\n.tx-menu > li[role=separator] {\n    display: block;\n    box-sizing: content-box;\n    overflow: visible;\n    cursor: default;\n    height: 2px;\n    padding: 0px;\n    margin: 1.5px 7px 1.5px 7px;\n    background-color: var(--tx-gray-100);\n    white-space: pre;\n    list-style-type: none;\n}\n.tx-menu > li.tx-disabled {\n    color: var(--tx-gray-500);\n}\n.tx-menu > li.tx-disabled:hover {\n    background-color: var(--tx-gray-50);\n}`;\n//# sourceMappingURL=tx-menu.js.map","import { ModelView } from \"./ModelView.js\";\nimport { OptionModelBase } from \"../model/OptionModelBase.js\";\nimport { input, button, svg, path, div, ul, li, array, text } from \"../util/lsx.js\";\nimport { placePopupVertical } from \"../menu/PopupMenu.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { style as txCombobox } from \"../style/tx-combobox.js\";\nimport { style as txMenu } from \"../style/tx-menu.js\";\nexport class Select extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = input();\n        this.input.type = \"text\";\n        this.asPopupMenu();\n        let view = this;\n        this.input.oninput = () => {\n            view.updateModel();\n        };\n        this.input.onblur = (ev) => {\n            if (this.hover === undefined) {\n                this.close();\n            }\n        };\n        let s;\n        const b = button(s = svg(path(\"M3 9.95a.875.875 0 01-.615-1.498L5.88 5 2.385 1.547A.875.875 0 013.615.302L7.74 4.377a.876.876 0 010 1.246L3.615 9.698A.872.872 0 013 9.95z\")));\n        this.button = b;\n        b.tabIndex = -1;\n        b.style.outline = \"none\";\n        s.style.width = \"100%\";\n        s.style.height = \"100%\";\n        b.onpointerdown = (ev) => {\n            if (this.popup) {\n                this.close();\n                return;\n            }\n            ev.preventDefault();\n            this.input.focus();\n            this.open();\n            b.setPointerCapture(ev.pointerId);\n        };\n        b.onpointermove = (ev) => {\n            if (this.popup === undefined) {\n                return;\n            }\n            const e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n            let newHover;\n            if (e instanceof HTMLLIElement) {\n                newHover = e;\n            }\n            else {\n                newHover = undefined;\n            }\n            if (this.hover !== newHover) {\n                if (this.hover) {\n                    this.hover.classList.remove(\"tx-hover\");\n                }\n                this.hover = newHover;\n                if (this.hover) {\n                    this.hover.classList.add(\"tx-hover\");\n                }\n            }\n        };\n        b.onpointerup = (ev) => {\n            if (this.hover) {\n                const idx = parseInt(this.hover.dataset[\"idx\"]);\n                this.close();\n                this.select(idx);\n                return;\n            }\n            const e = this.shadowRoot.elementFromPoint(ev.clientX, ev.clientY);\n            if (b.contains(e)) {\n                this.input.focus();\n                return;\n            }\n            this.close();\n        };\n        this.keydown = this.keydown.bind(this);\n        this.input.onkeydown = this.keydown;\n        this.wheel = this.wheel.bind(this);\n        this.input.onwheel = this.button.onwheel = this.wheel;\n        this.classList.add(\"tx-combobox\");\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txCombobox);\n        this.attachStyle(txMenu);\n        this.shadowRoot.appendChild(this.input);\n        this.shadowRoot.appendChild(b);\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        super.connectedCallback();\n        const text = this.getAttribute(\"text\");\n        if (text !== null) {\n            globalController.registerView(`M:${text}`, this);\n            this.asComboBox();\n            this.updateModel();\n        }\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.text) {\n                this.text.modified.remove(this);\n                this.text = undefined;\n            }\n            super.setModel(model);\n            return;\n        }\n        if (model instanceof OptionModelBase) {\n            super.setModel(model);\n        }\n        if (model instanceof TextModel) {\n            this.text = model;\n            this.text.modified.add(() => {\n                this.input.value = this.text.value;\n            }, this);\n        }\n    }\n    keydown(ev) {\n        if (this.input.readOnly) {\n            ev.preventDefault();\n        }\n        switch (ev.key) {\n            case \"ArrowUp\":\n                this.previousItem();\n                break;\n            case \"ArrowDown\":\n                this.nextItem();\n                break;\n        }\n    }\n    wheel(ev) {\n        ev.preventDefault();\n        this.input.focus();\n        if (ev.deltaY > 0) {\n            this.nextItem();\n        }\n        if (ev.deltaY < 0) {\n            this.previousItem();\n        }\n    }\n    asPopupMenu() {\n        this.input.readOnly = true;\n        for (let property of [\"user-select\", \"-webkit-user-select\", \"-webkit-touch-callout\", \"-khtml-user-select\"]) {\n            this.input.style.setProperty(property, \"none\");\n        }\n    }\n    asComboBox() {\n        this.input.readOnly = false;\n        for (let property of [\"user-select\", \"-webkit-user-select\", \"-webkit-touch-callout\", \"-khtml-user-select\"]) {\n            this.input.style.removeProperty(property);\n        }\n    }\n    updateModel() {\n        if (this.text) {\n            this.text.value = this.input.value;\n        }\n    }\n    updateView() {\n        if (!this.model || !this.model.enabled) {\n            this.input.setAttribute(\"disabled\", \"\");\n        }\n        else {\n            this.input.removeAttribute(\"disabled\");\n        }\n        if (this.model !== undefined) {\n            this.input.value = this.displayName(this.model.stringValue);\n            this.updateModel();\n        }\n    }\n    displayName(value) {\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (child.nodeName === \"OPTION\") {\n                const option = child;\n                if (option.value === value) {\n                    return option.text;\n                }\n            }\n        }\n        let all = \"\";\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (child.nodeName === \"OPTION\") {\n                const option = child;\n                all = `${all} '${option.value}'`;\n            }\n        }\n        if (all.length === 0) {\n            all = \" empty option list\";\n        }\n        console.log(`'${value}' is not in${all} of <tx-select model=\"${this.getAttribute(\"model\")}\">`);\n        console.trace(this);\n        return \"\";\n    }\n    open() {\n        let view = this;\n        let u;\n        this.popup = div(u = ul(...array(this.children.length, (idx) => {\n            const l = li(text(this.children.item(idx).innerText));\n            l.tabIndex = 0;\n            l.ariaRoleDescription = \"option\";\n            l.dataset[\"idx\"] = `${idx}`;\n            l.onpointerdown = (ev) => {\n                this.button.setPointerCapture(ev.pointerId);\n                this.hover = l;\n                ev.preventDefault();\n            };\n            l.onclick = () => {\n                view.select(idx);\n            };\n            this.children[idx];\n            return l;\n        })));\n        this.popup.classList.add(\"tx-popover\");\n        this.popup.style.position = \"fixed\";\n        this.popup.style.zIndex = \"99\";\n        u.ariaRoleDescription = \"listbox\";\n        u.classList.add(\"tx-menu\");\n        this.shadowRoot.appendChild(this.popup);\n        placePopupVertical(this, this.popup);\n    }\n    close() {\n        this.hover = undefined;\n        if (this.popup !== undefined) {\n            this.shadowRoot.removeChild(this.popup);\n            this.popup = undefined;\n        }\n    }\n    select(index) {\n        if (this.model === undefined) {\n            console.log(`<tx-select model='${this.getAttribute(\"model\")}'> has no model`);\n            return;\n        }\n        this.close();\n        const option = this.children[index];\n        if (!(option instanceof HTMLOptionElement)) {\n            console.log(`<tx-select>: unpexected element <${option.nodeName.toLowerCase()}> instead of <option>`);\n            return;\n        }\n        this.model.stringValue = option.value;\n    }\n    getIndex() {\n        const v = this.model?.stringValue;\n        for (let i = 0; i < this.children.length; ++i) {\n            if (this.children[i].value === v)\n                return i;\n        }\n        return undefined;\n    }\n    nextItem() {\n        let index = this.getIndex();\n        if (index === undefined) {\n            index = 0;\n        }\n        else {\n            ++index;\n        }\n        if (index >= this.children.length) {\n            return;\n        }\n        this.select(index);\n    }\n    previousItem() {\n        let index = this.getIndex();\n        if (index === undefined) {\n            index = this.children.length - 1;\n        }\n        else {\n            --index;\n        }\n        if (index < 0) {\n            return;\n        }\n        this.select(index);\n    }\n}\nSelect.define(\"tx-select\", Select);\n//# sourceMappingURL=Select.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n\n:host(.tx-slider) {\n    height: 14px;\n    position: relative;\n    width: 100%;\n    display: inline-block;\n}\n:host(.tx-slider) > input {\n    position: absolute;\n    top: 4px;\n    -webkit-appearance: none;\n    width: 100%;\n    height: 2px;\n    border: none;\n    background: var(--tx-gray-700); /* track */\n    outline: none;\n}\n\n:host(.tx-slider) > input::-webkit-slider-thumb {\n    -webkit-appearance: none;\n    appearance: none;\n    width: 14px;\n    height: 14px;\n    border: 2px solid var(--tx-gray-700); /* knob border */\n    border-radius: 50%;\n    background: var(--tx-gray-75); /* inside knob */\n    cursor: pointer;\n    box-sizing: border-box;\n}\n:host(.tx-slider) > input::-moz-range-thumb {\n    width: 14px;\n    height: 14px;\n    border: 2px solid var(--tx-gray-700); /* knob border */\n    border-radius: 50%;\n    background: var(--tx-gray-75); /* inside knob */\n    box-sizing: border-box;\n}\n\n/* focus ring */\n:host(.tx-slider) > input:focus::-webkit-slider-thumb {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n:host(.tx-slider) > input:focus::-moz-range-thumb {\n    outline: 2px solid;\n    outline-color: var(--tx-outline-color);\n    outline-offset: 2px;\n}\n\n:host(.tx-slider) > input::-moz-focus-outer {\n    border: 0;\n}\n\n:host(.tx-slider) > input:hover {\n    background: var(--tx-gray-800); /* track */\n}\n:host(.tx-slider) > input:hover::-webkit-slider-thumb {\n    border: 2px solid var(--tx-gray-800); /* knob border */\n}\n:host(.tx-slider) > input:hover::-moz-range-thumb {\n    border: 2px solid var(--tx-gray-800); /* knob border */\n}\n\n:host(.tx-slider) > input:disabled {\n    background: var(--tx-gray-500); /* track */\n}\n:host(.tx-slider) > input:disabled::-webkit-slider-thumb {\n    border: 2px solid var(--tx-gray-500); /* knob border */\n}\n:host(.tx-slider) > input:disabled::-moz-range-thumb {\n    border: 2px solid var(--tx-gray-500); /* knob border */\n}\n`;\n//# sourceMappingURL=tx-slider.js.map","import { ModelView } from \"./ModelView.js\";\nimport { style as txSlider } from \"../style/tx-slider.js\";\nexport class Slider extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = document.createElement(\"input\");\n        this.input.type = \"range\";\n        let view = this;\n        this.input.oninput = () => {\n            view.updateModel();\n        };\n        this.classList.add(\"tx-slider\");\n        this.attachShadow({ mode: 'open' });\n        this.attachStyle(txSlider);\n        this.shadowRoot.appendChild(this.input);\n    }\n    updateModel() {\n        if (this.model)\n            this.model.value = Number.parseFloat(this.input.value);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        if (this.model.step === undefined && this.model.min !== undefined && this.model.max !== undefined)\n            this.input.step = `${(this.model.max - this.model.min) / 100}`;\n        else\n            this.input.step = String(this.model.step);\n        this.input.min = String(this.model.min);\n        this.input.max = String(this.model.max);\n        this.input.value = String(this.model.value);\n    }\n}\nSlider.define(\"tx-slider\", Slider);\n//# sourceMappingURL=Slider.js.map","import { View } from \"./View.js\";\nexport class GenericTool extends View {\n    static focusIn(view) {\n        const viewParents = new Map();\n        for (let parent = view.parentElement, distance = 0; parent !== null; parent = parent.parentElement, ++distance) {\n            viewParents.set(parent, distance);\n        }\n        let closestToolDistance = Number.MAX_SAFE_INTEGER;\n        let closestParent;\n        let closestToolList = new Array();\n        for (const tool of this.allTools.values()) {\n            if (!tool.canHandle(view))\n                continue;\n            for (let toolParent = tool.parentElement, depth = 0; toolParent !== null; toolParent = toolParent.parentElement, ++depth) {\n                const toolDistance = viewParents.get(toolParent);\n                if (toolDistance === undefined)\n                    continue;\n                if (closestToolDistance < toolDistance)\n                    continue;\n                if (closestToolDistance > toolDistance) {\n                    closestToolList.length = 0;\n                }\n                closestToolDistance = toolDistance;\n                closestParent = toolParent;\n                closestToolList.push(tool);\n            }\n        }\n        if (!closestParent) {\n            return;\n        }\n        let closestTool;\n        const viewIndex = GenericTool.getIndex(view, closestParent);\n        let closestNextSiblingIndex = Number.MIN_SAFE_INTEGER;\n        for (let tool of closestToolList) {\n            const toolIndex = GenericTool.getIndex(tool, closestParent);\n            if (toolIndex < viewIndex && toolIndex > closestNextSiblingIndex) {\n                closestNextSiblingIndex = toolIndex;\n                closestTool = tool;\n            }\n        }\n        this.setActive(closestTool, view);\n    }\n    static getIndex(view, parent) {\n        if (parent === undefined) {\n            console.trace(`GenericTool.getIndex(${view}, ${parent})`);\n        }\n        let element = view;\n        while (element.parentElement !== parent)\n            element = element.parentElement;\n        return Array.from(parent.childNodes).indexOf(element);\n    }\n    static setActive(tool, view) {\n        if (this.activeTool)\n            this.activeTool.deactivate();\n        this.activeTool = tool;\n        this.activeView = view;\n        if (tool)\n            tool.activate();\n    }\n    static focusOut(view) {\n        if (this.activeView === view) {\n            this.setActive(undefined, undefined);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        GenericTool.allTools.add(this);\n    }\n    disconnectedCallback() {\n        if (GenericTool.activeTool === this) {\n            GenericTool.setActive(undefined, undefined);\n        }\n        GenericTool.allTools.delete(this);\n        super.disconnectedCallback();\n    }\n}\nGenericTool.allTools = new Set();\nwindow.addEventListener(\"focusin\", (event) => {\n    if (event.target instanceof GenericTool)\n        return;\n    if (event.relatedTarget instanceof View) {\n        GenericTool.focusOut(event.relatedTarget);\n    }\n    if (event.target instanceof View) {\n        GenericTool.focusIn(event.target);\n    }\n});\n//# sourceMappingURL=GenericTool.js.map","import { ModelView } from \"./ModelView.js\";\nlet toolbuttonStyle = document.createElement(\"style\");\ntoolbuttonStyle.textContent = `\n:host {\n    display: inline-block;\n    overflow: hidden;\n    box-sizing: border-box;\n    border: 1px solid #e3dbdb;\n    border-radius: 3px;\n    background: #e3dbdb;\n    width: 32px;\n    height: 32px;\n    margin: 0;\n    padding: 0;\n}\n\n:host([selected]) {\n    background: #ac9393;\n}\n\n:host([disabled]) {\n    opacity: 0.5;\n}\n\n:host([disabled]) img {\n    opacity: 0.5;\n}\n\n:host([checked][disabled]) {\n}\n`;\nexport class ToolButton extends ModelView {\n    constructor(init) {\n        super(init);\n        if (!init) {\n            init = {\n                value: this.getAttribute(\"value\"),\n                img: this.getAttribute(\"img\"),\n                disabled: this.hasAttribute(\"disabled\")\n            };\n        }\n        else {\n            this.setAttribute(\"value\", init.value);\n            this.setAttribute(\"img\", init.img);\n            if (init.disabled === true)\n                this.setAttribute(\"disabled\", \"disabled\");\n        }\n        this.onmousedown = (event) => {\n            if (this.hasAttribute(\"disabled\")) {\n                return;\n            }\n            this.focus();\n            event.preventDefault();\n            if (this.model !== undefined) {\n                this.model.stringValue = this.getValue();\n            }\n        };\n        let img = document.createElement(\"img\");\n        img.src = init.img;\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(toolbuttonStyle, true));\n        this.shadowRoot.appendChild(img);\n    }\n    getValue() {\n        let value = this.getAttribute(\"value\");\n        if (value === null)\n            throw Error(\"no value\");\n        return value;\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model === undefined)\n            this.setAttribute(\"disabled\", \"\");\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n            this.removeAttribute(\"selected\");\n            return;\n        }\n        let value = this.getValue();\n        if (this.model.isValidStringValue(value)) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"\");\n        }\n        if (this.model.stringValue === value) {\n            this.setAttribute(\"selected\", \"\");\n        }\n        else {\n            this.removeAttribute(\"selected\");\n        }\n    }\n}\nToolButton.define(\"tx-toolbutton\", ToolButton);\n//# sourceMappingURL=ToolButton.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class SlotView extends ModelView {\n    constructor() { super(); }\n    updateView() {\n        if (!this.model)\n            return;\n        let value = this.model.value === undefined ? \"\" : this.model.value;\n        if (this.model instanceof HtmlModel)\n            this.innerHTML = value;\n        else\n            this.innerText = value;\n    }\n}\nSlotView.define(\"tx-slot\", SlotView);\n//# sourceMappingURL=SlotView.js.map","import { ModelView } from \"./ModelView.js\";\nexport class ToadIf extends ModelView {\n    updateView() {\n        if (this.model) {\n            this.style.display = this.model.value ? \"\" : \"none\";\n        }\n    }\n}\nToadIf.define(\"tx-if\", ToadIf);\n//# sourceMappingURL=ToadIf.js.map","import { css } from \"../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n/*\n  tabs, line, content\n*/\n:host(.tx-tabs) {\n    position: relative;\n    display: flex;\n    flex-wrap: nowrap;\n    box-sizing: border-box;\n}\n:host(.tx-tabs:not(.tx-vertical)) {\n    flex-direction: column;\n}\n:host(.tx-tabs.tx-vertical) {\n    flex-direction: row;\n}\n\n/*\n * tabs\n */\n:host(.tx-tabs) > ul {\n    display: flex;\n    flex-wrap: nowrap;\n    list-style: none;\n    box-sizing: border-box;\n    padding: 0;\n    margin: 0;\n}\n:host(.tx-tabs:not(.tx-vertical)) > ul {\n    flex-direction: row;\n    border-bottom: 2px solid var(--tx-gray-200);\n}\n:host(.tx-tabs.tx-vertical) > ul {\n    border-left: 2px solid var(--tx-gray-200);\n    flex-direction: column;\n}\n:host(.tx-tabs) > ul > li {\n    box-sizing: border-box;\n    list-style: none;\n}\n\n/*\n * label\n */\n:host(.tx-tabs) > ul > li > span {\n    display: block;\n    list-style: none;\n    font-weight: 500;\n    margin: 8px 12px 8px 12px;\n    color: var(--tx-gray-700);\n    cursor: pointer;\n}\n:host(.tx-tabs.tx-vertical) > ul > li > span {\n    margin: 0;\n    padding: 12px 8px 12px 8px;\n}\n:host(.tx-tabs) > ul > li > span.active {\n    color: var(--tx-gray-900);\n}\n:host(.tx-tabs) > ul > li > span:hover {\n    color: var(--tx-gray-900);\n}\n\n/*\n * line\n */\n:host(.tx-tabs) > div.line {\n    background-color: var(--tx-gray-900);\n    pointer-events: none;\n}\n:host(.tx-tabs:not(.tx-vertical)) > div.line  {\n    transition: left 0.5s ease-in-out, width 0.5s 0.10s;\n    position: relative; /* below labels */\n    top: 0px;\n    height: 2px;\n    left: 12px;\n    width: 0px;\n}\n:host(.tx-tabs.tx-vertical) > div.line  {\n    transition: top 0.5s ease-in-out, width 0.5s 0.10s;\n    position: absolute; left: 0; /* before labels */\n    height: 0px;\n    width: 2px;\n}\n\n.content {\n    flex-grow: 1;\n}\n\n`;\n//# sourceMappingURL=tx-tabs.js.map","import { View } from \"../view/View.js\";\nimport { ul, li, span, text, div, slot } from \"../util/lsx.js\";\nimport { style as txTabs } from \"../style/tx-tabs.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class Tabs extends ModelView {\n    constructor(init) {\n        super(init);\n        this.setTab = this.setTab.bind(this);\n        this.classList.add(\"tx-tabs\");\n        if (this.hasAttribute(\"vertical\")) {\n            this.classList.add(\"tx-vertical\");\n        }\n        this.content = div(slot());\n        this.content.classList.add(\"content\");\n        const tabContainer = ul();\n        for (let i = 0; i < this.children.length; ++i) {\n            const child = this.children[i];\n            if (child.nodeName !== \"TX-TAB\") {\n                console.log(`unexpected <${child.nodeName.toLowerCase()}> within <tabs>`);\n                continue;\n            }\n            const tab = child;\n            let tabLabel;\n            tabContainer.appendChild(li(tabLabel = span(text(tab.getAttribute(\"label\")))));\n            tabLabel.onpointerdown = (ev) => {\n                ev.stopPropagation();\n                ev.preventDefault();\n                ev.cancelBubble = true;\n                this.setTab(tabLabel, tab);\n            };\n            if (this.activeTab === undefined) {\n                this.activeTab = tabLabel;\n                this.activePanel = tab;\n            }\n            else {\n                tab.style.display = \"none\";\n            }\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(txTabs, true));\n        this.shadowRoot.appendChild(tabContainer);\n        this.shadowRoot.appendChild(this.markerLine = div());\n        this.shadowRoot.appendChild(this.content);\n        this.markerLine.classList.add(\"line\");\n        if (this.activeTab) {\n            this.setTab(this.activeTab, this.activePanel);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.adjustLine();\n    }\n    setTab(tab, panel) {\n        this.activeTab.classList.remove(\"active\");\n        this.activeTab = tab;\n        this.activeTab.classList.add(\"active\");\n        this.activePanel.style.display = \"none\";\n        this.activePanel = panel;\n        this.activePanel.style.display = \"\";\n        this.adjustLine();\n        if (this.model && panel.value) {\n            this.model.stringValue = panel.value;\n        }\n    }\n    adjustLine() {\n        const line = this.markerLine;\n        const tab = this.activeTab;\n        if (tab !== undefined) {\n            if (this.hasAttribute(\"vertical\")) {\n                line.style.top = `${tab.offsetTop}px`;\n                line.style.height = `${tab.clientHeight}px`;\n            }\n            else {\n                line.style.top = `-2px`;\n                line.style.left = `${tab.offsetLeft}px`;\n                line.style.width = `${tab.clientWidth}px`;\n            }\n        }\n    }\n}\nTabs.define(\"tx-tabs\", Tabs);\nexport class Tab extends View {\n    constructor(init) {\n        super(init);\n        this.label = init?.label;\n        this.value = init?.value;\n    }\n}\nView.define(\"tx-tab\", Tab);\n//# sourceMappingURL=Tab.js.map","export const menuStyle = document.createElement(\"style\");\nmenuStyle.textContent = `\n  :host(.menu-button) {\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-edit-font-size);\n    font-weight: var(--tx-edit-font-weight);\n    padding: 7px;\n    vertical-align: center;\n  \n    background: var(--tx-gray-200);\n    color: var(--tx-gray-900);\n    cursor: default;\n  }\n  :host(.menu-button:hover) {\n    background: var(--tx-gray-300);\n  }\n  :host(.menu-button.active) {\n    background: var(--tx-gray-400);\n    color: var(--tx-gray-900);\n  }\n  :host(.menu-button.disabled) {\n    color: var(--tx-gray-500);\n  }\n  :host(.menu-button.active.disabled) {\n    color: var(--tx-gray-700);\n  }\n  :host(.menu-button.menu-down) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-down) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.menu-side) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-side) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  .menu-bar {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n    background-color: var(--tx-gray-200);\n  }\n  .menu-popup {\n    position: fixed;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 2px 2px 5px var(--tx-gray-50);\n  }\n`;\n//# sourceMappingURL=menuStyle.js.map","import { Action } from \"../model/Action.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nimport { MenuState } from \"./MenuState.js\";\nimport { PopupMenu } from \"./PopupMenu.js\";\nexport class MenuButton extends ModelView {\n    constructor(master, node) {\n        super();\n        this.master = master;\n        this.node = node;\n        let menuButton = this;\n        this.classList.add(\"menu-button\");\n        if (node.down) {\n            if (master.vertical)\n                this.classList.add(\"menu-side\");\n            else\n                this.classList.add(\"menu-down\");\n        }\n        this.updateView();\n        this.onmousedown = (event) => {\n            event.stopPropagation();\n            let documentMouseUp = function (event) {\n                document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n                event.preventDefault();\n                setTimeout(() => {\n                    if (MenuButton.buttonDown)\n                        menuButton.dispatchEvent(new MouseEvent(\"mouseup\", event));\n                }, 0);\n            };\n            document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n            MenuButton.buttonDown = true;\n            if (!this.master)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                    this.master.state = MenuState.DOWN;\n                    this.activate();\n                    break;\n                case MenuState.UP_N_HOLD:\n                    if (this.master.active !== this) {\n                        this.master.state = MenuState.DOWN;\n                        this.activate();\n                    }\n                    else {\n                        this.master.state = MenuState.DOWN_N_HOLD;\n                    }\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseup = (event) => {\n            event.stopPropagation();\n            if (!MenuButton.buttonDown)\n                return;\n            MenuButton.buttonDown = false;\n            if (!this.master)\n                throw Error(\"yikes\");\n            if (!this.node)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                    if (this.node.isEnabled() && !this.node.down) {\n                        this.trigger();\n                        this.master.state = MenuState.WAIT;\n                    }\n                    else {\n                        this.master.state = MenuState.UP_N_HOLD;\n                        if (MenuButton.documentMouseDown) {\n                            document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                        }\n                        MenuButton.documentMouseDown = function (event) {\n                            if (MenuButton.documentMouseDown)\n                                document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                            MenuButton.documentMouseDown = undefined;\n                            let tagName = event.target.tagName;\n                            if (tagName !== \"TOAD-MENUBUTTON\") {\n                                menuButton.collapse();\n                            }\n                        };\n                        document.addEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                    }\n                    break;\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                    this.master.state = MenuState.WAIT;\n                    this.deactivate();\n                    this.collapse();\n                    if (this.master.closeOnClose) {\n                    }\n                    break;\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.trigger();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseout = (event) => {\n            event.stopPropagation();\n            if (!this.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = undefined;\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                    break;\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.master.state = MenuState.DOWN_N_OUTSIDE;\n                    this.updateView();\n                    break;\n                default:\n                    throw Error(\"unexpected state\");\n            }\n            return false;\n        };\n        this.onmouseover = (event) => {\n            event.stopPropagation();\n            if (!menuButton.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = menuButton;\n            switch (menuButton.master.state) {\n                case MenuState.WAIT:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    if (!MenuButton.buttonDown)\n                        break;\n                    if (!this.master)\n                        throw Error(\"yikes\");\n                    if (this.master.active)\n                        this.master.active.deactivate();\n                    this.master.state = MenuState.DOWN_N_INSIDE_AGAIN;\n                    this.activate();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + menuButton.master.state);\n            }\n            return false;\n        };\n        this.attachShadow({ mode: 'open' });\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        this.shadowRoot.appendChild(document.importNode(menuStyle, true));\n        if (!this.node.modelId)\n            this.shadowRoot.appendChild(document.createTextNode(node.label));\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        if (this.node.down === undefined) {\n            let actionId = this.node.title;\n            for (let node = this.node.parent; node; node = node.parent) {\n                if (!node.title.length)\n                    break;\n                actionId = node.title + \"|\" + actionId;\n            }\n            actionId = \"A:\" + actionId;\n            globalController.registerView(actionId, this);\n        }\n        if (this.node.modelId !== undefined) {\n            if (typeof this.node.modelId === \"string\") {\n                let modelId = \"M:\" + this.node.modelId;\n                globalController.registerView(modelId, this);\n            }\n            else {\n                this.setModel(this.node.modelId);\n            }\n        }\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n        }\n        else {\n            throw Error(\"unexpected model of type \" + model.constructor.name);\n        }\n        this.updateView();\n    }\n    updateView() {\n        if (this.model && this.model.value) {\n            if (!this.shadowRoot)\n                throw Error(\"yikes\");\n            let span = document.createElement(\"span\");\n            if (this.model instanceof HtmlModel)\n                span.innerHTML = this.model.value;\n            else\n                span.innerText = this.model.value;\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.removeChild(this.shadowRoot.children[1]);\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.insertBefore(span, this.shadowRoot.children[1]);\n            else\n                this.shadowRoot.appendChild(span);\n        }\n        if (!this.master)\n            throw Error(\"yikes\");\n        let active = false;\n        if (this.master.active == this) {\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    active = true;\n                    break;\n                case MenuState.DOWN_N_OUTSIDE:\n                    if (!this.node)\n                        throw Error(\"yikes\");\n                    active = this.node.down !== undefined && this.node.isEnabled();\n                    break;\n            }\n        }\n        this.classList.toggle(\"active\", active);\n        this.classList.toggle(\"disabled\", !this.isEnabled());\n    }\n    isEnabled() {\n        if (this.node.down !== undefined)\n            return true;\n        return this.action !== undefined && this.action.enabled;\n    }\n    trigger() {\n        this.collapse();\n        if (!this.action)\n            return;\n        this.action.trigger();\n    }\n    collapse() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.parentButton)\n            this.master.parentButton.collapse();\n        else\n            this.deactivate();\n    }\n    openPopup() {\n        if (!this.node)\n            return;\n        if (!this.node.down)\n            return;\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        if (!this.popup) {\n            this.popup = new PopupMenu(this.node, this);\n            this.shadowRoot.appendChild(this.popup);\n        }\n        else {\n            this.popup.show();\n        }\n    }\n    closePopup() {\n        if (!this.popup)\n            return;\n        if (this.popup.active)\n            this.popup.active.deactivate();\n        this.popup.hide();\n    }\n    activate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (!this.node)\n            throw Error(\"yikes\");\n        let oldActive = this.master.active;\n        this.master.active = this;\n        if (oldActive && oldActive !== this) {\n            oldActive.closePopup();\n            oldActive.updateView();\n        }\n        this.updateView();\n        this.openPopup();\n    }\n    deactivate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.active !== this)\n            return;\n        this.master.active.closePopup();\n        this.master.active = undefined;\n        this.master.state = MenuState.WAIT;\n        this.updateView();\n    }\n}\nMenuButton.define(\"tx-menubutton\", MenuButton);\n//# sourceMappingURL=MenuButton.js.map","import { MenuButton } from \"./MenuButton.js\";\nexport class MenuNode {\n    constructor(title, label, shortcut, type, modelId) {\n        this.title = title;\n        this.label = label;\n        this.shortcut = shortcut;\n        this.type = type ? type : \"entry\";\n        this.modelId = modelId;\n    }\n    isEnabled() {\n        return true;\n    }\n    isAvailable() {\n        return true;\n    }\n    createWindowAt(parent, parentView) {\n        if (this.type == \"spacer\") {\n            let span = document.createElement(\"span\");\n            span.style.flexGrow = \"1\";\n            parentView.appendChild(span);\n            return;\n        }\n        this.view = new MenuButton(parent, this);\n        parentView.appendChild(this.view);\n    }\n    deleteWindow() {\n    }\n}\n//# sourceMappingURL=MenuNode.js.map","import * as dom from \"../util/dom.js\";\nimport { MenuNode } from \"./MenuNode.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nexport class Menu extends MenuButtonContainer {\n    constructor(props) {\n        super(props);\n        this.config = props?.config;\n        this.vertical = false;\n        this.root = new MenuNode(\"\", \"\", undefined, undefined);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.tabIndex = 0;\n        if (this.config) {\n            this.config2nodes(this.config, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n            return;\n        }\n        if (this.children.length === 0) {\n            this._observer = new MutationObserver((record, observer) => {\n                if (this._timer !== undefined)\n                    clearTimeout(this._timer);\n                this._timer = window.setTimeout(() => {\n                    this._timer = undefined;\n                    this.layout2nodes(this.children, this.root);\n                    this.referenceActions();\n                    this.createShadowDOM();\n                }, 100);\n            });\n            this._observer.observe(this, {\n                childList: true,\n                subtree: true\n            });\n        }\n        else {\n            this.layout2nodes(this.children, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n        }\n    }\n    layout2nodes(children, parent) {\n        let node = parent.down;\n        for (let child of children) {\n            let newnode = undefined;\n            switch (child.nodeName) {\n                case \"TX-MENUSPACER\":\n                    newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n                    break;\n                case \"TX-MENUENTRY\":\n                    newnode = new MenuNode(dom.attribute(child, \"name\"), dom.attribute(child, \"label\"), dom.attributeOrUndefined(child, \"shortcut\"), dom.attributeOrUndefined(child, \"type\"), dom.attributeOrUndefined(child, \"model\"));\n                    break;\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            this.layout2nodes(child.children, node);\n        }\n    }\n    config2nodes(config, parent) {\n        let node = parent.down;\n        for (let child of config) {\n            let newnode = undefined;\n            if (child.space === true) {\n                newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n            }\n            else {\n                newnode = new MenuNode(child.name, child.label, child.shortcut, child.type, child.model);\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            if (child.sub)\n                this.config2nodes(child.sub, node);\n        }\n    }\n    referenceActions() {\n    }\n    findNode(str, parent) {\n        let strpos = str.indexOf(\"|\");\n        let left = strpos == -1 ? str : str.substr(0, strpos);\n        let right = strpos == -1 ? \"\" : str.substr(strpos + 1);\n        if (!parent)\n            parent = this.root;\n        for (let n = parent.down; n; n = n.next) {\n            if (n.title == left) {\n                if (!n.down) {\n                    return n;\n                }\n                return this.findNode(right, n);\n            }\n        }\n        return undefined;\n    }\n    createShadowDOM() {\n        this.view = document.createElement(\"div\");\n        this.view.classList.add(\"menu-bar\");\n        let node = this.root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.view);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(menuStyle, true));\n        this.shadowRoot.appendChild(this.view);\n    }\n}\nMenu.define(\"tx-menu\", Menu);\n//# sourceMappingURL=Menu.js.map","import { View } from \"../view/View.js\";\nexport class MenuSpacer extends HTMLElement {\n}\nView.define(\"tx-menuspacer\", MenuSpacer);\n//# sourceMappingURL=MenuSpacer.js.map","import { Model } from \"../../model/Model.js\";\nexport class TableModel extends Model {\n    isEmpty() { return this.colCount === 0 && this.rowCount === 0; }\n}\n//# sourceMappingURL=TableModel.js.map","export var TableEditMode;\n(function (TableEditMode) {\n    TableEditMode[TableEditMode[\"EDIT_CELL\"] = 0] = \"EDIT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_CELL\"] = 1] = \"SELECT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_ROW\"] = 2] = \"SELECT_ROW\";\n})(TableEditMode || (TableEditMode = {}));\n//# sourceMappingURL=TableEditMode.js.map","import { TypedTableModel } from \"../model/TypedTableModel.js\";\nexport var EditMode;\n(function (EditMode) {\n    EditMode[EditMode[\"EDIT_ON_FOCUS\"] = 0] = \"EDIT_ON_FOCUS\";\n    EditMode[EditMode[\"EDIT_ON_ENTER\"] = 1] = \"EDIT_ON_ENTER\";\n})(EditMode || (EditMode = {}));\nexport class TableAdapterConfig {\n    constructor() {\n        this.editMode = EditMode.EDIT_ON_FOCUS;\n        this.seamless = false;\n        this.expandColumn = false;\n        this.expandRow = false;\n    }\n}\nexport class TableAdapter {\n    constructor(model) {\n        this.config = new TableAdapterConfig();\n        this.model = model;\n    }\n    get colCount() { return this.model === undefined ? 0 : this.model.colCount; }\n    get rowCount() { return this.model === undefined ? 0 : this.model.rowCount; }\n    getColumnHead(col) { return undefined; }\n    getRowHead(row) { return undefined; }\n    showCell(pos, cell) { }\n    saveCell(pos, cell) { }\n    editCell(pos, cell) { }\n    isViewCompact() { return false; }\n    static register(adapter, model, data) {\n        let typeToModel = TableAdapter.modelToAdapter.get(model);\n        if (typeToModel === undefined) {\n            typeToModel = new Map();\n            TableAdapter.modelToAdapter.set(model, typeToModel);\n        }\n        if (data !== undefined) {\n            if (typeToModel.has(data)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(data, adapter);\n        }\n        else {\n            if (typeToModel.has(null)) {\n                throw Error(`attempt to redefine existing table adapter`);\n            }\n            typeToModel.set(null, adapter);\n        }\n    }\n    static unbind() {\n        TableAdapter.modelToAdapter.clear();\n    }\n    static lookup(model) {\n        let dataType;\n        if (model instanceof TypedTableModel) {\n            dataType = model.nodeClass;\n        }\n        else {\n            dataType = null;\n        }\n        const typeToAdapter = TableAdapter.modelToAdapter.get(Object.getPrototypeOf(model).constructor);\n        let adapter = typeToAdapter?.get(dataType);\n        if (adapter === undefined) {\n            for (let baseClass of TableAdapter.modelToAdapter.keys()) {\n                if (model instanceof baseClass) {\n                    adapter = TableAdapter.modelToAdapter.get(baseClass)?.get(dataType);\n                    break;\n                }\n            }\n        }\n        if (adapter === undefined) {\n            let msg = `TableAdapter.lookup(): Did not find an adapter for model of type ${model.constructor.name}`;\n            msg += `\\n    Requested adapter: model=${model.constructor.name}, type=${dataType?.name}\\n    Available adapters:`;\n            if (TableAdapter.modelToAdapter.size === 0) {\n                msg += \" none.\";\n            }\n            else {\n                for (const [modelX, typeToAdapterX] of TableAdapter.modelToAdapter) {\n                    for (const [typeX, adapterX] of typeToAdapterX) {\n                        msg += `\\n        model=${modelX.name}`;\n                        if (typeX !== undefined && typeX !== null) {\n                            msg += `, type=${typeX.name}`;\n                        }\n                    }\n                }\n            }\n            throw Error(msg);\n        }\n        return adapter;\n    }\n}\nTableAdapter.modelToAdapter = new Map();\n//# sourceMappingURL=TableAdapter.js.map","export var TableEventType;\n(function (TableEventType) {\n    TableEventType[TableEventType[\"INSERT_ROW\"] = 0] = \"INSERT_ROW\";\n    TableEventType[TableEventType[\"REMOVE_ROW\"] = 1] = \"REMOVE_ROW\";\n    TableEventType[TableEventType[\"INSERT_COL\"] = 2] = \"INSERT_COL\";\n    TableEventType[TableEventType[\"REMOVE_COL\"] = 3] = \"REMOVE_COL\";\n    TableEventType[TableEventType[\"CELL_CHANGED\"] = 4] = \"CELL_CHANGED\";\n    TableEventType[TableEventType[\"RESIZE_ROW\"] = 5] = \"RESIZE_ROW\";\n    TableEventType[TableEventType[\"RESIZE_COL\"] = 6] = \"RESIZE_COL\";\n    TableEventType[TableEventType[\"CHANGED\"] = 7] = \"CHANGED\";\n})(TableEventType || (TableEventType = {}));\n//# sourceMappingURL=TableEventType.js.map","export class TablePos {\n    constructor(col, row) {\n        this.col = col;\n        this.row = row;\n    }\n    toString() {\n        return `TablePos { col:${this.col}, row:${this.row} }`;\n    }\n}\n//# sourceMappingURL=TablePos.js.map","import { Model } from \"../../model/Model.js\";\nimport { TableEditMode } from \"../TableEditMode.js\";\nimport { TablePos } from \"../TablePos.js\";\nexport class SelectionModel extends Model {\n    constructor(mode = TableEditMode.EDIT_CELL) {\n        super();\n        this.mode = mode;\n        this._value = new TablePos(0, 0);\n    }\n    set col(col) {\n        if (this._value.col === col)\n            return;\n        this._value.col = col;\n        this.modified.trigger();\n    }\n    get col() {\n        return this._value.col;\n    }\n    set row(row) {\n        if (this._value.row === row)\n            return;\n        this._value.row = row;\n        this.modified.trigger();\n    }\n    get row() {\n        return this._value.row;\n    }\n    set value(value) {\n        if (this._value.col === value.col && this._value.row === value.row)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n    toString() {\n        return `SelectionModel {enabled: ${this._enabled}, mode: ${TableEditMode[this.mode]}, value: ${this._value}}`;\n    }\n}\n//# sourceMappingURL=SelectionModel.js.map","import { TableModel } from \"./TableModel.js\";\nexport class TypedTableModel extends TableModel {\n    constructor(nodeClass, root) {\n        super();\n        this.nodeClass = nodeClass;\n    }\n}\n//# sourceMappingURL=TypedTableModel.js.map","export class TableFriend {\n    constructor(table) {\n        this.table = table;\n    }\n    get adapter() {\n        return this.table.adapter;\n    }\n    get root() {\n        return this.table.root;\n    }\n    get measure() {\n        return this.table.measure;\n    }\n    getStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.bodyStaging;\n    }\n    getHeadStaging() {\n        const animator = this.table.animator;\n        if (animator.current === undefined)\n            return undefined;\n        const animation = animator.current;\n        return animation.headStaging;\n    }\n    get body() {\n        return this.table.body;\n    }\n    get splitBody() {\n        return this.table.splitBody;\n    }\n    get colHeads() {\n        return this.table.colHeads;\n    }\n    set colHeads(div) {\n        this.table.colHeads = div;\n    }\n    get rowHeads() {\n        return this.table.rowHeads;\n    }\n    set rowHeads(div) {\n        this.table.rowHeads = div;\n    }\n    get colResizeHandles() {\n        return this.table.colResizeHandles;\n    }\n    set colResizeHandles(div) {\n        this.table.colResizeHandles = div;\n    }\n    get rowResizeHandles() {\n        return this.table.rowResizeHandles;\n    }\n    set rowResizeHandles(div) {\n        this.table.rowResizeHandles = div;\n    }\n    set animationDone(animationDone) {\n        this.table.animationDone = animationDone;\n    }\n    get selection() {\n        return this.table.selection;\n    }\n    get style() {\n        return this.table.style;\n    }\n    setCellSize(span, x, y, w, h) {\n        this.table.setCellSize(span, x, y, w, h);\n    }\n    clearAnimation() {\n        this.table.animation = undefined;\n    }\n}\n//# sourceMappingURL=TableFriend.js.map","import { Table } from \"../Table.js\";\nimport { TableFriend } from \"./TableFriend.js\";\nimport { div, span } from \"../../util/lsx.js\";\nexport class TableAnimation extends TableFriend {\n    constructor(table) {\n        super(table);\n    }\n    prepareStagingWithRows() {\n        this.prepareBodyStaging();\n        this.prepareRowHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareStagingWithColumns() {\n        this.prepareBodyStaging();\n        this.prepareColHeadStaging();\n        this.table.addStaging(this.bodyStaging, this.headStaging);\n        this.scrollStaging();\n    }\n    prepareBodyStaging() {\n        this.bodyStaging = div();\n        this.bodyStaging.className = \"staging\";\n        this.bodyStaging.style.left = this.body.style.left;\n        this.bodyStaging.style.top = this.body.style.top;\n    }\n    prepareRowHeadStaging() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.style.top = this.rowHeads.style.top;\n        this.headStaging.style.width = this.rowHeads.style.width;\n    }\n    prepareColHeadStaging() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging = div();\n        this.headStaging.classList.add(\"staging\");\n        this.headStaging.classList.add(\"colHack\");\n        this.headStaging.style.left = this.colHeads.style.left;\n        this.headStaging.style.height = this.colHeads.style.height;\n    }\n    disposeStaging() {\n        this.table.removeStaging(this.bodyStaging, this.headStaging);\n    }\n    scrollStaging() {\n    }\n    makeRowMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.top = `${start}px`;\n        mask.style.height = `${size}px`;\n        mask.style.left = `0`;\n        mask.style.right = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n    makeColumnMask(start, size) {\n        const mask = span();\n        mask.style.boxSizing = `content-box`;\n        mask.style.left = `${start}px`;\n        mask.style.width = `${size}px`;\n        mask.style.top = `0`;\n        mask.style.bottom = `0`;\n        mask.style.border = 'none';\n        mask.style.backgroundColor = Table.maskColor;\n        return mask;\n    }\n}\n//# sourceMappingURL=TableAnimation.js.map","import { TableAnimation } from \"./TableAnimation.js\";\nexport class InsertAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.event = event;\n    }\n    prepare() {\n        this.prepareCellsToBeMeasured();\n        this.prepareStaging();\n    }\n    firstFrame() {\n        this.arrangeInStaging();\n        this.split();\n    }\n    animationFrame(n) {\n        this.animate(this.animationStart + n * this.totalSize);\n    }\n    lastFrame() {\n        this.animate(this.animationStart + this.totalSize);\n        this.join();\n        this.disposeStaging();\n    }\n    join() {\n        if (this.done) {\n            return;\n        }\n        this.done = true;\n        this.joinHeader();\n        this.joinBody();\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n}\n//# sourceMappingURL=InsertAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nimport { span, div } from \"../../util/lsx.js\";\nexport class InsertRowAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.join = this.join.bind(this);\n        this.initialRowCount = this.adapter.rowCount - event.size;\n        InsertRowAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithRows();\n    }\n    animate(pos) {\n        this.splitBody.style.top = `${pos}px`;\n        this.mask.style.top = `${pos}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${pos}px`;\n            this.headMask.style.top = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let rowHeaders = new Array(this.event.size);\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row - this.event.index] = content;\n        }\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.colHeads === undefined && this.adapter.colCount === this.event.size) {\n            let colHeaders = new Array(this.adapter.colCount);\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const content = this.adapter.getColumnHead(col);\n                if (this.colHeads === undefined && content !== undefined) {\n                    this.colHeads = div();\n                    this.colHeads.className = \"cols\";\n                    this.root.appendChild(this.colHeads);\n                    this.colResizeHandles = div();\n                    this.colResizeHandles.className = \"cols\";\n                    this.root.appendChild(this.colResizeHandles);\n                }\n                colHeaders[col] = content;\n            }\n            if (this.colHeads !== undefined) {\n                for (let col = 0; col < this.adapter.colCount; ++col) {\n                    const cell = span(colHeaders[col]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let row = this.event.index; row < this.event.index + this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.table.createCell();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let top = 0;\n        let idx = this.event.index * this.adapter.colCount;\n        if (this.body.children.length !== 0) {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                top = px2float(cell.style.top);\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                top = px2float(cell.style.top) + b.height - overlap;\n            }\n        }\n        let colWidth = new Array(this.adapter.colCount);\n        if (this.body.children.length > 0) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.body.children[col];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = bounds.width;\n                if (this.adapter.config.seamless) {\n                    colWidth[col] += 2;\n                }\n            }\n        }\n        else {\n            colWidth.fill(this.table.minCellWidth);\n        }\n        let rowHeadWidth = this.table.minCellWidth;\n        if (this.rowHeads && this.rowHeads.children.length > 0) {\n            const cell = this.rowHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            if (this.adapter.config.seamless) {\n                rowHeadWidth += 2;\n            }\n        }\n        let rowHeight = new Array(this.event.size);\n        rowHeight.fill(this.table.minCellHeight);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        let colHeadHeight = 0;\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            colHeadHeight = this.table.minCellHeight;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width - this.table.WIDTH_ADJUST);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height - this.table.HEIGHT_ADJUST);\n            }\n        }\n        else {\n            if (this.colHeads !== undefined) {\n                const b = this.colHeads.children[0].getBoundingClientRect();\n                colHeadHeight = b.height - this.table.HEIGHT_ADJUST;\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        if (this.rowHeads) {\n            if (colHeadHeight === 0) {\n                this.rowHeads.style.top = `0px`;\n            }\n            else {\n                this.rowHeads.style.top = `${colHeadHeight + this.table.HEIGHT_ADJUST - overlap}px`;\n            }\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n        }\n        for (let row = 0; row < this.event.size; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height);\n                if (this.adapter.config.expandColumn) {\n                    colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width));\n                }\n                else {\n                    if (row === 0 && this.body.children.length === 0) {\n                        colWidth[col] = Math.ceil(bounds.width);\n                    }\n                }\n            }\n            this.totalSize += rowHeight[row] - overlap;\n        }\n        if (this.adapter.config.expandColumn) {\n            idx = 0;\n            let x = 0;\n            let col = 0;\n            while (idx < this.body.children.length) {\n                const cell = this.body.children[idx];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n                ++col;\n                ++idx;\n                if (col >= this.adapter.colCount) {\n                    x = 0;\n                    col = 0;\n                }\n            }\n        }\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let y = top;\n        if (this.rowHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, 0, y, rowHeadWidth, rowHeight[row]);\n                this.headStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n        }\n        if (this.colHeads !== undefined && this.colHeads.children.length === 0 && this.adapter.rowCount == this.event.size) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                cell.style.left = `${x}px`;\n                cell.style.width = `${colWidth[col] - this.table.WIDTH_ADJUST}px`;\n                cell.style.height = `${colHeadHeight}px`;\n                this.colHeads.appendChild(cell);\n                x += colWidth[col] - overlap;\n            }\n            colHeadHeight += this.table.HEIGHT_ADJUST;\n            this.body.style.top = `${colHeadHeight - overlap}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.headStaging.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n        }\n        y = top;\n        for (let row = 0; row < this.event.size; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, colWidth[col], rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n            y += rowHeight[row] - overlap;\n            if (this.adapter.config.seamless) {\n                y -= 2;\n            }\n        }\n        this.mask = this.makeRowMask(top, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads !== undefined) {\n            this.headMask = this.makeRowMask(top, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n        if (this.initialRowCount !== 0) {\n            const overlap = this.adapter.config.seamless ? 0 : 1;\n            this.totalSize -= overlap;\n        }\n    }\n    split() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.animationStart = px2float(this.splitBody.style.top);\n    }\n    joinHeader() {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.rowHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.rowHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let top = px2float(this.splitHead.style.top);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.rowHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        while (this.bodyStaging.children.length > 0) {\n            this.body.appendChild(this.bodyStaging.children[0]);\n        }\n        if (this.splitBody.children.length > 0) {\n            let top = px2float(this.splitBody.style.top);\n            while (this.splitBody.children.length > 0) {\n                const cell = this.splitBody.children[0];\n                cell.style.top = `${px2float(cell.style.top) + top}px`;\n                this.body.appendChild(cell);\n            }\n        }\n    }\n}\n//# sourceMappingURL=InsertRowAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveRowAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.event = event;\n        this.joinHorizontal = this.joinHorizontal.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialHeight = 0;\n        }\n        else {\n            const bottomCell = this.body.children[this.body.children.length - 1];\n            const top = px2float(bottomCell.style.top);\n            const bounds = bottomCell.getBoundingClientRect();\n            this.initialHeight = top + bounds.height;\n        }\n        this.overlap = this.adapter.config.seamless ? 0 : 1;\n        this.removeAll = this.event.index >= this.adapter.rowCount;\n        RemoveRowAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithRows();\n        this.arrangeRowsInStaging();\n        this.splitHorizontal();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        this.splitBody.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n        this.mask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        if (this.rowHeads !== undefined) {\n            this.splitHead.style.top = `${this.topSplitBody - n * this.animationHeight}px`;\n            this.headMask.style.top = `${this.topMask - n * this.animationHeight}px`;\n        }\n    }\n    lastFrame() {\n        this.joinHorizontal();\n        this.disposeStaging();\n    }\n    arrangeRowsInStaging() {\n        const idx = this.event.index * this.adapter.colCount;\n        const cellCount = this.event.size * this.adapter.colCount;\n        const start = px2float(this.body.children[idx].style.top);\n        for (let i = 0; i < cellCount; ++i) {\n            this.bodyStaging.appendChild(this.body.children[idx]);\n        }\n        let bottomOfStaging;\n        if (idx < this.body.children.length) {\n            bottomOfStaging = px2float(this.body.children[idx].style.top);\n        }\n        else {\n            const cell = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n            bottomOfStaging = px2float(cell.style.top) + px2float(cell.style.height) + this.table.HEIGHT_ADJUST;\n        }\n        this.animationHeight = bottomOfStaging - start;\n        this.mask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.rowHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeRowMask(bottomOfStaging, this.animationHeight);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitHorizontal() {\n        this.table.splitHorizontalNew(this.event.index);\n        if (this.rowHeads !== undefined) {\n            this.splitHead = this.rowHeads.lastElementChild;\n        }\n        this.topSplitBody = px2float(this.splitBody.style.top);\n        this.topMask = px2float(this.mask.style.top);\n    }\n    joinHorizontal() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.rowHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.rowHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitHead.style.top);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.rowHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let top = px2float(this.splitBody.style.top);\n        while (this.splitBody.children.length > 0) {\n            const cell = this.splitBody.children[0];\n            cell.style.top = `${px2float(cell.style.top) + top}px`;\n            this.body.appendChild(cell);\n        }\n    }\n}\n//# sourceMappingURL=RemoveRowAnimation.js.map","import { TablePos } from \"../TablePos.js\";\nimport { span, div } from \"../../util/lsx.js\";\nimport { px2int, px2float } from \"../Table.js\";\nimport { InsertAnimation } from \"./InsertAnimation.js\";\nexport class InsertColumnAnimation extends InsertAnimation {\n    constructor(table, event) {\n        super(table, event);\n        this.event = event;\n        this.join = this.join.bind(this);\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        InsertColumnAnimation.current = this;\n    }\n    prepareStaging() {\n        this.prepareStagingWithColumns();\n    }\n    animate(pos) {\n        this.mask.style.left = `${pos}px`;\n        this.splitBody.style.left = `${pos}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${pos}px`;\n            this.headMask.style.left = `${pos}px`;\n        }\n    }\n    prepareCellsToBeMeasured() {\n        this.table.prepareMinCellSize();\n        let colHeaders = new Array(this.event.size);\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            colHeaders[col - this.event.index] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let row = 0; row < this.event.size; ++row) {\n                const cell = span(colHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n        if (this.rowHeads === undefined && this.adapter.rowCount === this.event.size) {\n            let rowHeaders = new Array(this.adapter.rowCount);\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const content = this.adapter.getRowHead(row);\n                if (this.rowHeads === undefined && content !== undefined) {\n                    this.rowHeads = div();\n                    this.rowHeads.className = \"rows\";\n                    this.root.appendChild(this.rowHeads);\n                    this.rowResizeHandles = div();\n                    this.rowResizeHandles.className = \"rows\";\n                    this.root.appendChild(this.rowResizeHandles);\n                }\n                rowHeaders[row] = content;\n            }\n            if (this.rowHeads !== undefined) {\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    const cell = span(rowHeaders[row]);\n                    cell.className = \"head\";\n                    this.measure.appendChild(cell);\n                }\n            }\n        }\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = span();\n                this.table.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    arrangeInStaging() {\n        this.table.calculateMinCellSize();\n        const previousColCount = this.colCount - this.event.size;\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        let left;\n        let idx = this.event.index;\n        if (idx < previousColCount) {\n            let cell = this.body.children[idx];\n            left = px2int(cell.style.left);\n        }\n        else {\n            if (this.body.children.length === 0) {\n                left = 0;\n            }\n            else {\n                const cell = this.body.children[previousColCount - 1];\n                left = px2int(cell.style.left) + px2int(cell.style.width) + this.table.WIDTH_ADJUST - overlap;\n            }\n        }\n        this.animationStart = left;\n        let rowHeight = new Array(this.adapter.rowCount);\n        if (this.body.children.length !== 0) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.body.children[row * previousColCount];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = bounds.height;\n                if (this.adapter.config.seamless) {\n                    rowHeight[row] += 2;\n                }\n            }\n        }\n        else {\n            rowHeight.fill(this.table.minCellHeight);\n        }\n        let colHeadHeight = this.table.minCellHeight;\n        if (this.colHeads && this.colHeads.children.length > 0) {\n            const cell = this.colHeads.children[0];\n            const bounds = cell.getBoundingClientRect();\n            colHeadHeight = bounds.height;\n            if (this.adapter.config.seamless) {\n                colHeadHeight += 2;\n            }\n        }\n        let colWidth = new Array(this.event.size);\n        colWidth.fill(this.table.minCellWidth);\n        this.totalSize = 0;\n        idx = 0;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.max(colWidth[col], bounds.width);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let rowHeadWidth = 0;\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            rowHeadWidth = this.table.minCellWidth;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                rowHeight[row] = Math.max(rowHeight[row], bounds.height - this.table.HEIGHT_ADJUST);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width - this.table.WIDTH_ADJUST);\n            }\n        }\n        else {\n            if (this.rowHeads !== undefined) {\n                const b = this.rowHeads.children[0].getBoundingClientRect();\n                rowHeadWidth = b.width - this.table.WIDTH_ADJUST;\n            }\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        if (this.colHeads) {\n            if (rowHeadWidth === 0) {\n                this.colHeads.style.left = `0px`;\n            }\n            else {\n                this.colHeads.style.left = `${rowHeadWidth + this.table.WIDTH_ADJUST + 2 - overlap}px`;\n            }\n            this.colHeads.style.right = `0px`;\n            this.colHeads.style.height = `${colHeadHeight}px`;\n            this.body.style.top = `${colHeadHeight - 1}px`;\n            this.bodyStaging.style.top = `${colHeadHeight - 1}px`;\n        }\n        for (let col = 0; col < this.event.size; ++col) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[idx++];\n                const bounds = cell.getBoundingClientRect();\n                colWidth[col] = Math.ceil(Math.max(colWidth[col], bounds.width) - 2);\n                if (this.adapter.config.expandRow) {\n                    rowHeight[col] = Math.ceil(Math.max(rowHeight[row], bounds.height));\n                }\n                else {\n                    if (col === 0 && this.body.children.length === 0) {\n                        rowHeight[row] = Math.ceil(bounds.height);\n                    }\n                }\n            }\n            this.totalSize += colWidth[col] - overlap;\n        }\n        colWidth.forEach((v, i) => colWidth[i] = v + 4);\n        this.totalSize += overlap;\n        if (this.adapter.config.seamless) {\n            this.totalSize -= 2 * this.event.size;\n        }\n        let x = left;\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.event.size; ++col) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, 0, colWidth[col], colHeadHeight);\n                this.headStaging.appendChild(cell);\n                x += colWidth[col] - overlap;\n                if (this.adapter.config.seamless) {\n                    x -= 2;\n                }\n            }\n        }\n        if (this.rowHeads !== undefined && this.rowHeads.children.length === 0 && this.adapter.colCount == this.event.size) {\n            let y = 0;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                cell.style.top = `${y}px`;\n                cell.style.height = `${rowHeight[row] - this.table.HEIGHT_ADJUST}px`;\n                cell.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.appendChild(cell);\n                y += rowHeight[row] - overlap;\n            }\n            rowHeadWidth += this.table.WIDTH_ADJUST;\n            this.body.style.left = `${rowHeadWidth - overlap}px`;\n            this.bodyStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.headStaging.style.left = `${rowHeadWidth - overlap}px`;\n            this.colHeads.style.left = `${rowHeadWidth - overlap}px`;\n            this.rowHeads.style.top = `${colHeadHeight - overlap}px`;\n            this.rowHeads.style.bottom = `0px`;\n            this.rowHeads.style.width = `${rowHeadWidth}px`;\n        }\n        let totalWidth = 0;\n        x = left;\n        for (let col = this.event.index; col < this.event.index + this.event.size; ++col) {\n            let columnWidth = colWidth[col - this.event.index];\n            let y = 0;\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.measure.children[0];\n                this.setCellSize(cell, x, y, columnWidth, rowHeight[row]);\n                this.bodyStaging.appendChild(cell);\n                y += rowHeight[row] - overlap;\n                if (this.adapter.config.seamless) {\n                    y -= 2;\n                }\n            }\n            x += columnWidth - overlap - 2;\n            if (!this.adapter.config.seamless) {\n                x += 2;\n            }\n            totalWidth += columnWidth - 2;\n        }\n        this.totalSize = totalWidth + 2;\n        this.mask = this.makeColumnMask(left, this.totalSize);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads !== undefined) {\n            this.headMask = this.makeColumnMask(left, this.totalSize);\n            this.headStaging.appendChild(this.headMask);\n        }\n    }\n    split() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n    }\n    joinHeader() {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        this.headStaging.removeChild(this.headMask);\n        this.colHeads.removeChild(this.splitHead);\n        while (this.headStaging.children.length > 0) {\n            this.colHeads.appendChild(this.headStaging.children[0]);\n        }\n        if (this.splitHead.children.length > 0) {\n            let left = px2float(this.splitHead.style.left);\n            while (this.splitHead.children.length > 0) {\n                const cell = this.splitHead.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                this.colHeads.appendChild(cell);\n            }\n        }\n    }\n    joinBody() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        const totalWidth = this.adapter.model.colCount;\n        const bodyWidth = this.event.index;\n        const stagingWidth = this.event.size;\n        const splitWidth = totalWidth - stagingWidth - this.event.index;\n        for (let col = 0; col < stagingWidth; ++col) {\n            for (let row = 0; row < this.rowCount; ++row) {\n                const cell = this.bodyStaging.children[0];\n                const idx = row * (bodyWidth + stagingWidth) + bodyWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n        let left = this.totalSize + this.animationStart;\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < splitWidth; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * totalWidth + bodyWidth + stagingWidth + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=InsertColumnAnimation.js.map","import { px2float } from \"../Table.js\";\nimport { TableAnimation } from \"./TableAnimation.js\";\nexport class RemoveColumnAnimation extends TableAnimation {\n    constructor(table, event) {\n        super(table);\n        this.done = false;\n        this.colCount = this.adapter.colCount;\n        this.rowCount = this.adapter.rowCount;\n        this.event = event;\n        this.joinVertical = this.joinVertical.bind(this);\n        if (this.body.children.length === 0) {\n            this.initialWidth = 0;\n        }\n        else {\n            const cell = this.body.children[this.body.children.length - 1];\n            const left = px2float(cell.style.left);\n            const bounds = cell.getBoundingClientRect();\n            this.initialWidth = left + bounds.width;\n        }\n        RemoveColumnAnimation.current = this;\n    }\n    prepare() {\n        this.prepareStagingWithColumns();\n        this.arrangeColumnsInStaging();\n        this.splitVertical();\n    }\n    firstFrame() { }\n    animationFrame(n) {\n        let a = 0;\n        if (this.adapter.config.seamless) {\n            a = 1;\n        }\n        this.splitBody.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n        this.mask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${this.leftSplitBody - n * this.animationWidth + a}px`;\n            this.headMask.style.left = `${this.leftMask - n * this.animationWidth}px`;\n        }\n    }\n    lastFrame() {\n        this.joinVertical();\n        this.disposeStaging();\n    }\n    arrangeColumnsInStaging() {\n        let idx = this.event.index;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.event.size; ++col) {\n                this.bodyStaging.appendChild(this.body.children[idx]);\n            }\n            idx += this.colCount;\n        }\n        const firstCellOfStaging = this.bodyStaging.children[0];\n        const lastCellOfStaging = this.bodyStaging.children[this.bodyStaging.children.length - 1];\n        let rightOfStaging = px2float(lastCellOfStaging.style.left) + px2float(lastCellOfStaging.style.width) + this.table.WIDTH_ADJUST;\n        rightOfStaging -= 1;\n        let w = rightOfStaging - px2float(firstCellOfStaging.style.left);\n        this.animationWidth = w;\n        this.mask = this.makeColumnMask(rightOfStaging, w);\n        this.bodyStaging.appendChild(this.mask);\n        if (this.colHeads === undefined) {\n            return;\n        }\n        for (let i = 0; i < this.event.size; ++i) {\n            this.headStaging.appendChild(this.colHeads.children[this.event.index]);\n        }\n        this.headMask = this.makeColumnMask(rightOfStaging, w);\n        this.headStaging.appendChild(this.headMask);\n    }\n    splitVertical() {\n        this.table.splitVerticalNew(this.event.index);\n        if (this.colHeads !== undefined) {\n            this.splitHead = this.colHeads.lastElementChild;\n        }\n        const left = px2float(this.splitBody.style.left);\n        this.splitBody.style.width = `${this.initialWidth - left - 1}px`;\n        this.leftSplitBody = left;\n        this.leftMask = px2float(this.mask.style.left);\n        if (this.colHeads !== undefined) {\n            this.splitHead.style.left = `${left}px`;\n            this.splitHead.style.width = `${this.initialWidth - left - 1}px`;\n        }\n    }\n    joinVertical() {\n        this.bodyStaging.removeChild(this.mask);\n        this.body.removeChild(this.splitBody);\n        this.bodyStaging.replaceChildren();\n        this.moveSplitBodyToBody();\n        if (this.colHeads) {\n            this.headStaging.removeChild(this.headMask);\n            this.colHeads.removeChild(this.splitHead);\n            this.headStaging.replaceChildren();\n            this.moveSplitHeadToHead();\n        }\n        if (this.table.animationDone) {\n            this.table.animationDone();\n        }\n    }\n    moveSplitHeadToHead() {\n        if (this.splitHead.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitHead.style.left);\n        while (this.splitHead.children.length > 0) {\n            const cell = this.splitHead.children[0];\n            cell.style.left = `${px2float(cell.style.left) + left}px`;\n            this.colHeads.appendChild(cell);\n        }\n    }\n    moveSplitBodyToBody() {\n        if (this.splitBody.children.length === 0) {\n            return;\n        }\n        let left = px2float(this.splitBody.style.left);\n        for (let row = 0; row < this.rowCount; ++row) {\n            for (let col = 0; col < this.colCount - this.event.index; ++col) {\n                const cell = this.splitBody.children[0];\n                cell.style.left = `${px2float(cell.style.left) + left}px`;\n                const idx = row * this.adapter.colCount + this.event.index + col;\n                this.bodyInsertAt(cell, idx);\n            }\n        }\n    }\n    bodyInsertAt(node, idx) {\n        let beforeChild;\n        if (idx < this.body.children.length) {\n            beforeChild = this.body.children[idx];\n        }\n        else {\n            beforeChild = null;\n        }\n        this.body.insertBefore(node, beforeChild);\n    }\n}\n//# sourceMappingURL=RemoveColumnAnimation.js.map","let animationFrameCount = 468;\nexport function setAnimationFrameCount(frames) {\n    animationFrameCount = frames;\n}\nexport function scrollIntoView(element) {\n    if (element === undefined)\n        return;\n    const scrollableParent = findScrollableParent(element);\n    if (scrollableParent === undefined)\n        return;\n    const parentRect = scrollableParent.getBoundingClientRect();\n    const clientRect = element.getBoundingClientRect();\n    if (scrollableParent !== document.body) {\n        const { x, y } = calculateScrollGoal(scrollableParent, parentRect, clientRect);\n        smoothScroll(scrollableParent, x, y);\n        if (window.getComputedStyle(scrollableParent).position !== 'fixed') {\n            window.scrollBy({\n                left: parentRect.left,\n                top: parentRect.top,\n                behavior: 'smooth'\n            });\n        }\n    }\n    else {\n        window.scrollBy({\n            left: clientRect.left,\n            top: clientRect.top,\n            behavior: 'smooth'\n        });\n    }\n}\nfunction calculateScrollGoal(scrollableParent, parentRect, clientRect) {\n    const GAP = 16;\n    const clientLeft = clientRect.left + scrollableParent.scrollLeft - parentRect.left - GAP;\n    const clientRight = clientRect.right + scrollableParent.scrollLeft - parentRect.left + GAP;\n    const clientTop = clientRect.top + scrollableParent.scrollTop - parentRect.top - GAP;\n    const clientBottom = clientRect.bottom + scrollableParent.scrollTop - parentRect.top + GAP;\n    const parentWidth = scrollableParent.clientWidth;\n    const parentHeight = scrollableParent.clientHeight;\n    var x = scrollableParent.scrollLeft;\n    var y = scrollableParent.scrollTop;\n    if (clientRight - clientLeft - 2 * GAP > parentWidth)\n        x = clientLeft;\n    else if (clientRight > scrollableParent.scrollLeft + parentWidth)\n        x = clientRight - parentWidth;\n    else if (clientLeft < scrollableParent.scrollLeft)\n        x = clientLeft;\n    if (clientBottom - clientTop - 2 * GAP > parentHeight)\n        y = clientTop;\n    else if (clientBottom > scrollableParent.scrollTop + parentHeight)\n        y = clientBottom - parentHeight;\n    else if (clientTop < scrollableParent.scrollTop)\n        y = clientTop;\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n    return { x, y };\n}\nconst concurrentScroll = new Map();\nfunction smoothScroll(scrollable, x, y) {\n    let activeGoal = concurrentScroll.get(scrollable);\n    if (activeGoal === undefined) {\n        activeGoal = { x: x, y: y };\n        concurrentScroll.set(scrollable, activeGoal);\n    }\n    else {\n        activeGoal.x = x;\n        activeGoal.y = y;\n    }\n    let startX, startY;\n    if (scrollable === document.body) {\n        startX = window.scrollX || window.pageXOffset;\n        startY = window.scrollY || window.pageYOffset;\n    }\n    else {\n        startX = scrollable.scrollLeft;\n        startY = scrollable.scrollTop;\n    }\n    const deltaX = x - startX;\n    const deltaY = y - startY;\n    if (deltaX === 0 && deltaY === 0) {\n        concurrentScroll.delete(scrollable);\n        return;\n    }\n    animate((value) => {\n        if (activeGoal.x !== x || activeGoal.y !== y) {\n            return false;\n        }\n        const nx = startX + value * deltaX;\n        const ny = startY + value * deltaY;\n        if (scrollable === document.body) {\n            window.scrollTo(nx, ny);\n        }\n        else {\n            scrollable.scrollLeft = nx;\n            scrollable.scrollTop = ny;\n        }\n        if (value === 1) {\n            concurrentScroll.delete(scrollable);\n        }\n        return true;\n    });\n}\nlet idSource = 0;\nexport function animate(callback) {\n    setTimeout(() => { window.requestAnimationFrame(animateStep.bind(window, callback, undefined, undefined)); }, 0);\n}\nfunction animateStep(callback, startTime, id) {\n    if (startTime === undefined) {\n        startTime = Date.now();\n        id = ++idSource;\n    }\n    const time = Date.now();\n    let elapsed = animationFrameCount > 0 ? (time - startTime) / animationFrameCount : 1;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n    const value = ease(elapsed);\n    if (callback(value) === false)\n        return;\n    if (value < 1.0) {\n        window.requestAnimationFrame(animateStep.bind(window, callback, startTime, id));\n    }\n}\nfunction ease(k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n}\nvar ROUNDING_TOLERANCE = isMicrosoftBrowser(window.navigator.userAgent) ? 1 : 0;\nfunction isMicrosoftBrowser(userAgent) {\n    const userAgentPatterns = ['MSIE ', 'Trident/', 'Edge/'];\n    return new RegExp(userAgentPatterns.join('|')).test(userAgent);\n}\nexport function findScrollableParent(el) {\n    while (el !== document.body && isScrollable(el) === false) {\n        if (el.parentElement === null)\n            return undefined;\n        el = el.parentElement;\n    }\n    return el;\n}\nexport function isScrollable(el) {\n    const isScrollableY = hasScrollableSpace(el, \"Y\") && canOverflow(el, \"Y\");\n    const isScrollableX = hasScrollableSpace(el, \"X\") && canOverflow(el, \"X\");\n    return isScrollableY || isScrollableX;\n}\nfunction hasScrollableSpace(el, axis) {\n    if (axis === 'X')\n        return el.clientWidth + ROUNDING_TOLERANCE < el.scrollWidth;\n    else\n        return el.clientHeight + ROUNDING_TOLERANCE < el.scrollHeight;\n}\nfunction canOverflow(el, axis) {\n    const style = window.getComputedStyle(el, null);\n    const overflowValue = style['overflow' + axis];\n    return overflowValue === 'auto' || overflowValue === 'scroll';\n}\n//# sourceMappingURL=scrollIntoView.js.map","import { css } from \"../../util/lsx.js\";\nexport const style = document.createElement(\"style\");\nstyle.textContent = css `\n:host {\n    position: relative;\n    display: inline-block;\n    border: 1px solid var(--tx-gray-300);\n    border-radius: 3px;\n    /* outline-offset: -2px; */\n    outline: none;\n    font-family: var(--tx-font-family);\n    font-size: var(--tx-font-size);\n    background: #1e1e1e;\n\n    /* not sure about these */\n    /*\n    width: 100%;\n    width: -moz-available;\n    width: -webkit-fill-available;\n    width: fill-available;\n    height: 100%;\n    height: -moz-available;\n    height: -webkit-fill-available;\n    height: fill-available;\n    */\n\n    min-height: 50px;\n    min-width: 50px;\n}\n\n.staging, .body, .splitBody, .cols, .rows {\n    position: absolute;\n}\n\n.cols {\n    right: 0;\n    top: 0;\n}\n\n.rows {\n    left: 0;\n    bottom: 0;\n}\n\n.staging {\n    overflow: hidden;\n    inset: 0;\n}\n\n.body {\n    overflow: auto;\n    inset: 0;\n}\n\n.cols, .rows {\n    overflow: hidden;\n}\n\n/*\n::-webkit-scrollbar the scrollbar.\n::-webkit-scrollbar-button the buttons on the scrollbar (arrows pointing upwards and downwards).\n::-webkit-scrollbar-thumb the draggable scrolling handle.\n::-webkit-scrollbar-track the track (progress bar) of the scrollbar.\n::-webkit-scrollbar-track-piece the track (progress bar) NOT covered by the handle.\n::-webkit-scrollbar-corner the bottom corner of the scrollbar, where both horizontal and vertical scrollbars meet.\n::-webkit-resizer the draggable resizing handle that appears at the bottom corner of some elements.\n*/\n\n/* TODO: this doesn't support all browsers */\n.body::-webkit-scrollbar {\n    width: 10px;\n    height: 10px;\n}\n.body::-webkit-scrollbar-thumb {\n    border-radius: 5px;\n}\n.body::-webkit-scrollbar-track {\n    background: #1e1e1e;\n}\n.body::-webkit-scrollbar-corner {\n    background: #1e1e1e;\n}\n.body::-webkit-scrollbar-thumb {\n    background: var(--tx-gray-500);\n}\n\n.body > span,\n.splitBody > span,\n.cols > span,\n.rows > span,\n.measure > span,\n.staging > span {\n    position: absolute;\n    box-sizing: content-box;\n    white-space: nowrap;\n    outline: none;\n    border: solid 1px var(--tx-gray-200);\n    padding: 0 2px 0 2px;\n    margin: 0;\n    background-color: #080808;\n    font-weight: 400;\n    overflow: hidden;\n    cursor: default;\n    caret-color: transparent;\n}\n\n.seamless > .body > span,\n.seamless > .body > .splitBody > span,\n.seamless > .cols > span,\n.seamless > .rows > span,\n.seamless > .cols > .splitBody > span,\n.seamless > .rows > .splitBody > span,\n.seamless > .measure > span,\n.seamless > .staging > span {\n    border: none 0px;\n}\n\n.body > span:hover {\n    background: #1a1a1a;\n}\n\n.body > span.error, .splitBody > span.error {\n    border-color: var(--tx-global-red-600);\n    z-index: 1;\n}\n\n.body > span:focus, .splitBody > span:focus {\n    background: #0e2035;\n    border-color: #2680eb;\n    z-index: 2;\n}\n\n.body > span:focus:hover {\n    background: #112d4d;\n}\n\n.body > span.error, .splitBody > span.error {\n    background-color: #522426;\n}\n\n.body > span.error:hover {\n    background: #401111;\n}\n\n.cols > span.handle,\n.rows > span.handle {\n    padding: 0;\n    border: 0 none;\n    opacity: 0;\n    background-color: #08f;\n}\n.fill {\n    opacity: 0;\n}\n\n.cols > span.handle {\n    cursor: col-resize;\n}\n.rows > span.handle {\n    cursor: row-resize;\n}\n\n.staging span.head,\n.cols span.head,\n.rows span.head,\n.measure span.head {\n    background: #1e1e1e;\n    font-weight: 600;\n}\n\n.colHack > span,\n.cols > span {\n    text-align: center;\n}\n\n.measure {\n    position: absolute;\n    opacity: 0;\n}\n\n.body > span.edit, .splitBody > span.edit, .body > span.edit:hover, .splitBody > span.edit:hover {\n    caret-color: currentcolor;\n}\n`;\n//# sourceMappingURL=tx-table.js.map","import { View } from \"../view/View.js\";\nimport { TableModel } from \"./model/TableModel.js\";\nimport { SelectionModel } from \"./model/SelectionModel.js\";\nimport { EditMode, TableAdapter } from \"./adapter/TableAdapter.js\";\nimport { TablePos } from \"./TablePos.js\";\nimport { TableEditMode } from \"./TableEditMode.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { Animator } from \"../util/animation.js\";\nimport { TableAnimation } from \"./private/TableAnimation.js\";\nimport { InsertRowAnimation } from \"./private/InsertRowAnimation.js\";\nimport { RemoveRowAnimation } from \"./private/RemoveRowAnimation.js\";\nimport { InsertColumnAnimation } from \"./private/InsertColumnAnimation.js\";\nimport { RemoveColumnAnimation } from \"./private/RemoveColumnAnimation.js\";\nimport { setInitialProperties } from 'toad.jsx';\nimport { span, div, text } from \"../util/lsx.js\";\nimport { scrollIntoView } from \"../util/scrollIntoView.js\";\nimport { style as txTable } from \"./style/tx-table.js\";\nimport { hasFocus } from \"../util/dom.js\";\nexport function px2int(s) {\n    return parseInt(s.substring(0, s.length - 2));\n}\nexport function px2float(s) {\n    return parseFloat(s.substring(0, s.length - 2));\n}\nfunction isVisible(e) {\n    if (e.isConnected === false) {\n        return false;\n    }\n    if (window.getComputedStyle(e).display === \"none\") {\n        return false;\n    }\n    if (e.parentElement) {\n        return isVisible(e.parentElement);\n    }\n    return true;\n}\nexport class Table extends View {\n    constructor(props) {\n        super();\n        this.WIDTH_ADJUST = 6;\n        this.HEIGHT_ADJUST = 2;\n        this.HANDLE_SIZE = 5;\n        this.HANDLE_SKEW = 3;\n        this.visible = false;\n        this.animator = new Animator();\n        this.arrangeAllMeasuredInGrid = this.arrangeAllMeasuredInGrid.bind(this);\n        this.hostKeyDown = this.hostKeyDown.bind(this);\n        this.cellKeyDown = this.cellKeyDown.bind(this);\n        this.cellFocus = this.cellFocus.bind(this);\n        this.focusIn = this.focusIn.bind(this);\n        this.focusOut = this.focusOut.bind(this);\n        this.pointerDown = this.pointerDown.bind(this);\n        this.handleDown = this.handleDown.bind(this);\n        this.handleMove = this.handleMove.bind(this);\n        this.handleUp = this.handleUp.bind(this);\n        this.setHeadingFillerSizeToScrollbarSize = this.setHeadingFillerSizeToScrollbarSize.bind(this);\n        this.selectionChanged = this.selectionChanged.bind(this);\n        this.modelChanged = this.modelChanged.bind(this);\n        this.root = div(this.body = div());\n        this.root.className = \"root\";\n        this.body.className = \"body\";\n        this.measure = div();\n        this.measure.classList.add(\"measure\");\n        this.onkeydown = this.hostKeyDown;\n        this.addEventListener(\"focusin\", this.focusIn);\n        this.addEventListener(\"focusout\", this.focusOut);\n        this.body.onresize = this.setHeadingFillerSizeToScrollbarSize;\n        this.body.onscroll = () => {\n            if (this.animator.current && this.animator.current instanceof TableAnimation) {\n                this.animator.current.scrollStaging();\n            }\n            this.setHeadingFillerSizeToScrollbarSize();\n            if (this.colHeads) {\n                this.colHeads.scrollLeft = this.body.scrollLeft;\n                this.colResizeHandles.scrollLeft = this.body.scrollLeft;\n            }\n            if (this.rowHeads) {\n                this.rowHeads.scrollTop = this.body.scrollTop;\n                this.rowResizeHandles.scrollTop = this.body.scrollTop;\n            }\n        };\n        this.body.onpointerdown = this.pointerDown;\n        this.attachShadow({ mode: 'open', delegatesFocus: true });\n        this.attachStyle(txTable);\n        this.shadowRoot.appendChild(this.root);\n        this.shadowRoot.appendChild(this.measure);\n        if (props) {\n            setInitialProperties(this, props);\n            if (props.selectionModel)\n                this.setModel(props.selectionModel);\n        }\n        if (Table.observer === undefined) {\n            Table.observer = new MutationObserver((mutations, observer) => {\n                Table.allTables.forEach(table => {\n                    if (isVisible(table)) {\n                        Table.allTables.delete(table);\n                        table.prepareCells();\n                    }\n                });\n            });\n            Table.observer.observe(document.body, {\n                attributes: true,\n                subtree: true\n            });\n        }\n    }\n    connectedCallback() {\n        if (isVisible(this)) {\n            this.prepareCells();\n        }\n        else {\n            Table.allTables.add(this);\n        }\n        super.connectedCallback();\n        if (this.selection === undefined) {\n            this.selection = new SelectionModel(TableEditMode.SELECT_CELL);\n            this.selection.modified.add(this.selectionChanged, this);\n        }\n    }\n    disconnectedCallback() {\n        Table.allTables.delete(this);\n    }\n    addStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.insertBefore(element, this.root.children[0]);\n        }\n    }\n    removeStaging(...elements) {\n        for (const element of elements) {\n            if (element === undefined) {\n                continue;\n            }\n            this.root.removeChild(element);\n        }\n    }\n    hostKeyDown(ev) {\n        if (!this.selection)\n            return;\n        switch (this.selection.mode) {\n            case TableEditMode.SELECT_CELL:\n                {\n                    let pos = { col: this.selection.col, row: this.selection.row };\n                    switch (ev.key) {\n                        case \"ArrowRight\":\n                            if (this.editing === undefined && pos.col + 1 < this.adapter.colCount) {\n                                ++pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowLeft\":\n                            if (this.editing === undefined && pos.col > 0) {\n                                --pos.col;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowDown\":\n                            if (pos.row + 1 < this.adapter.rowCount) {\n                                ++pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"ArrowUp\":\n                            if (pos.row > 0) {\n                                --pos.row;\n                                ev.preventDefault();\n                                ev.stopPropagation();\n                            }\n                            break;\n                        case \"Enter\":\n                            if (this.editing === undefined) {\n                                if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                                    this.editCell();\n                                }\n                            }\n                            else {\n                                this.saveCell();\n                                if (pos.row + 1 < this.adapter.rowCount) {\n                                    ++pos.row;\n                                    this.selection.value = pos;\n                                    this.editCell();\n                                }\n                            }\n                            ev.preventDefault();\n                            ev.stopPropagation();\n                            break;\n                    }\n                    this.selection.value = pos;\n                }\n                break;\n        }\n    }\n    cellKeyDown(ev) {\n        const cell = ev.target;\n        if (ev.key === \"Enter\") {\n            this.hostKeyDown(ev);\n            ev.preventDefault();\n            return;\n        }\n        if (!cell.classList.contains(\"edit\") && this.editing === undefined) {\n            switch (ev.key) {\n                case \"ArrowDown\":\n                case \"ArrowUp\":\n                case \"ArrowRight\":\n                case \"ArrowLeft\":\n                case \"Tab\":\n                case \"Enter\":\n                    break;\n                default:\n                    if (this.adapter?.config.editMode === EditMode.EDIT_ON_ENTER) {\n                        ev.preventDefault();\n                    }\n            }\n        }\n        else {\n        }\n    }\n    cellFocus(event) {\n        const cell = event.target;\n        if (cell instanceof HTMLElement) {\n            const b = cell.getBoundingClientRect();\n            const p = this.clientPosToTablePos(b.x + b.width / 2, b.y + b.height / 2);\n            if (p !== undefined) {\n                this.selection.value = p;\n            }\n        }\n    }\n    focusIn(event) {\n    }\n    focusOut(event) {\n    }\n    editCell() {\n        if (this.editing !== undefined) {\n            if (this.editing.col === this.selection.value.col &&\n                this.editing.row === this.selection.value.row) {\n                return;\n            }\n            else {\n                console.log(`WARN: Table.editCell(): already editing ANOTHER cell`);\n            }\n        }\n        const col = this.selection.value.col;\n        const row = this.selection.value.row;\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        this.editing = new TablePos(col, row);\n        cell.classList.add(\"edit\");\n        this.adapter.editCell(this.editing, cell);\n    }\n    saveCell() {\n        if (this.editing === undefined) {\n            return;\n        }\n        const col = this.editing.col;\n        const row = this.editing.row;\n        const cell = this.body.children[col + row * this.adapter.colCount];\n        cell.classList.remove(\"edit\");\n        this.adapter.saveCell(this.editing, cell);\n        this.editing = undefined;\n        this.focus();\n    }\n    pointerDown(ev) {\n    }\n    getModel() {\n        return this.model;\n    }\n    setModel(model) {\n        if (model === undefined) {\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.model = undefined;\n            this.selection = new SelectionModel();\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof SelectionModel) {\n            if (this.selection) {\n                this.selection.modified.remove(this);\n            }\n            this.selection = model;\n            this.selection.modified.add(this.selectionChanged, this);\n            return;\n        }\n        if (model instanceof TableModel) {\n            this.model = model;\n            this.model.modified.add(this.modelChanged, this);\n            const adapter = TableAdapter.lookup(model);\n            try {\n                this.adapter = new adapter(model);\n            }\n            catch (e) {\n                console.log(`Table.setModel(): failed to instantiate table adapter: ${e}`);\n                console.log(`setting TypeScript's target to 'es6' might help`);\n                throw e;\n            }\n            this.prepareCells();\n            return;\n        }\n        if (model instanceof Object) {\n            throw Error(\"Table.setModel(): unexpected model of type \" + model.constructor.name);\n        }\n    }\n    selectionChanged() {\n        if (this.selection === undefined) {\n            return;\n        }\n        this.saveCell();\n        switch (this.selection.mode) {\n            case TableEditMode.EDIT_CELL:\n                {\n                    if (document.activeElement === this) {\n                        const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                        scrollIntoView(cell);\n                    }\n                }\n                break;\n            case TableEditMode.SELECT_CELL: {\n                if (document.activeElement === this) {\n                    const cell = this.body.children[this.selection.col + this.selection.row * this.adapter.colCount];\n                    if (!hasFocus(cell)) {\n                        cell.focus();\n                    }\n                    scrollIntoView(cell);\n                    if (this.adapter?.config.editMode === EditMode.EDIT_ON_FOCUS) {\n                        this.editCell();\n                    }\n                }\n                break;\n            }\n            case TableEditMode.SELECT_ROW: {\n                break;\n            }\n        }\n    }\n    modelChanged(event) {\n        switch (event.type) {\n            case TableEventType.CELL_CHANGED:\n                {\n                    const cell = this.body.children[event.col + event.row * this.adapter.colCount];\n                    this.showCell(event, cell);\n                }\n                break;\n            case TableEventType.INSERT_ROW:\n                this.animator.run(new InsertRowAnimation(this, event));\n                break;\n            case TableEventType.REMOVE_ROW:\n                this.animator.run(new RemoveRowAnimation(this, event));\n                break;\n            case TableEventType.INSERT_COL:\n                this.animator.run(new InsertColumnAnimation(this, event));\n                break;\n            case TableEventType.REMOVE_COL:\n                this.animator.run(new RemoveColumnAnimation(this, event));\n                break;\n            default:\n                console.log(`Table.modelChanged(): ${event} is not implemented`);\n        }\n    }\n    prepareCells() {\n        if (!this.adapter) {\n            return;\n        }\n        this.visible = isVisible(this);\n        if (!this.visible) {\n            return;\n        }\n        if (this.adapter.colCount === 0 || this.adapter.rowCount === 0) {\n            return;\n        }\n        if (this.adapter.config.seamless) {\n            this.root.classList.add(\"seamless\");\n        }\n        this.prepareMinCellSize();\n        this.prepareColumnHeads();\n        this.prepareRowHeads();\n        this.prepareBody();\n        setTimeout(this.arrangeAllMeasuredInGrid, 0);\n    }\n    arrangeAllMeasuredInGrid() {\n        this.calculateMinCellSize();\n        let { colWidths, colHeadHeight } = this.calculateColumnWidths();\n        let { rowHeights, rowHeadWidth } = this.calculateRowHeights();\n        this.placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth);\n        this.placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth);\n        this.placeBody(rowHeadWidth, colHeadHeight);\n        this.placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth);\n        this.setHeadingFillerSizeToScrollbarSize();\n    }\n    prepareMinCellSize() {\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = span(text(\"Tg\"));\n        this.measure.appendChild(measureLineHeight);\n    }\n    calculateMinCellSize() {\n        if (this.minCellHeight !== undefined) {\n            return;\n        }\n        const measureLineHeight = this.measure.children[0];\n        const b = measureLineHeight.getBoundingClientRect();\n        this.minCellWidth = Math.ceil(b.width - this.WIDTH_ADJUST);\n        this.minCellHeight = Math.ceil(b.height - this.HEIGHT_ADJUST);\n        this.measure.removeChild(measureLineHeight);\n    }\n    prepareColumnHeads() {\n        const columnHeaders = new Array(this.adapter.colCount);\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const content = this.adapter.getColumnHead(col);\n            if (this.colHeads === undefined && content !== undefined) {\n                this.colHeads = div();\n                this.colHeads.className = \"cols\";\n                this.root.appendChild(this.colHeads);\n                this.colResizeHandles = div();\n                this.colResizeHandles.className = \"cols\";\n                this.root.appendChild(this.colResizeHandles);\n            }\n            columnHeaders[col] = content;\n        }\n        if (this.colHeads !== undefined) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = span(columnHeaders[col]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareRowHeads() {\n        let rowHeaders = new Array(this.adapter.rowCount);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const content = this.adapter.getRowHead(row);\n            if (this.rowHeads === undefined && content !== undefined) {\n                this.rowHeads = div();\n                this.rowHeads.className = \"rows\";\n                this.root.appendChild(this.rowHeads);\n                this.rowResizeHandles = div();\n                this.rowResizeHandles.className = \"rows\";\n                this.root.appendChild(this.rowResizeHandles);\n            }\n            rowHeaders[row] = content;\n        }\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const cell = span(rowHeaders[row]);\n                cell.className = \"head\";\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    prepareBody() {\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const cell = this.createCell();\n                this.showCell(new TablePos(col, row), cell);\n                this.measure.appendChild(cell);\n            }\n        }\n    }\n    createCell() {\n        const cell = span();\n        cell.onfocus = this.cellFocus;\n        cell.onkeydown = this.cellKeyDown;\n        cell.tabIndex = 0;\n        cell.setAttribute(\"contenteditable\", \"\");\n        return cell;\n    }\n    setCellSize(span, x, y, w, h) {\n        span.style.left = `${x}px`;\n        span.style.top = `${y}px`;\n        span.style.width = `${w - this.WIDTH_ADJUST}px`;\n        span.style.height = `${h - this.HEIGHT_ADJUST}px`;\n    }\n    showCell(pos, cell) {\n        this.adapter.showCell(pos, cell);\n        if (cell.children.length !== 0) {\n            cell.style.caretColor = 'currentcolor';\n        }\n    }\n    calculateRowHeights() {\n        let idx = this.colHeads ? this.adapter.colCount : 0;\n        let rowHeadWidth = 0;\n        const rowHeights = Array(this.adapter.rowCount);\n        if (this.rowHeads) {\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                const child = this.measure.children[idx++];\n                const bounds = child.getBoundingClientRect();\n                rowHeights[row] = Math.max(bounds.height, this.minCellHeight);\n                rowHeadWidth = Math.max(rowHeadWidth, bounds.width);\n            }\n        }\n        else {\n            rowHeights.fill(this.minCellHeight);\n        }\n        idx = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let rh = rowHeights[row];\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[idx + col + row * this.adapter.colCount];\n                const bounds = child.getBoundingClientRect();\n                rh = Math.max(rh, bounds.height);\n            }\n            rowHeights[row] = Math.ceil(rh);\n        }\n        rowHeadWidth = Math.ceil(rowHeadWidth);\n        return { rowHeights, rowHeadWidth };\n    }\n    calculateColumnWidths(withinBody = false) {\n        let colHeadHeight = 0;\n        const colWidths = Array(this.adapter.colCount);\n        if (this.colHeads) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[col];\n                const bounds = child.getBoundingClientRect();\n                colWidths[col] = Math.max(bounds.width, this.minCellWidth);\n                colHeadHeight = Math.max(colHeadHeight, bounds.height);\n            }\n        }\n        else {\n            colWidths.fill(this.minCellWidth);\n        }\n        colHeadHeight = Math.ceil(colHeadHeight);\n        let idxStart;\n        if (withinBody) {\n            idxStart = 0;\n        }\n        else {\n            idxStart = (this.colHeads ? this.adapter.colCount : 0) + (this.rowHeads ? this.adapter.rowCount : 0);\n        }\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            let cw = colWidths[col];\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                let child;\n                let idx = idxStart + col + row * this.adapter.colCount;\n                if (withinBody) {\n                    child = this.body.children[idx];\n                }\n                else {\n                    child = this.measure.children[idx];\n                }\n                const bounds = child.getBoundingClientRect();\n                cw = Math.max(cw, bounds.width);\n            }\n            colWidths[col] = Math.ceil(cw);\n        }\n        return { colWidths, colHeadHeight };\n    }\n    placeColumnHeads(colWidths, colHeadHeight, rowHeadWidth) {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let x = 0;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, x, 0, colWidths[col], colHeadHeight);\n            this.colHeads.appendChild(child);\n            x += colWidths[col] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colHeads.appendChild(filler);\n        this.colResizeHandles.style.left = `${rowHeadWidth}px`;\n        this.colResizeHandles.style.height = `${colHeadHeight}px`;\n        x = -this.HANDLE_SKEW;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            x += colWidths[col] - 1;\n            const handle = this.createHandle(col, x, 0, this.HANDLE_SIZE, colHeadHeight);\n            this.colResizeHandles.appendChild(handle);\n        }\n        x += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `${x}px`;\n        filler.style.top = `0`;\n        filler.style.width = `256px`;\n        filler.style.height = `${colHeadHeight}px`;\n        this.colResizeHandles.appendChild(filler);\n    }\n    placeRowHeads(rowHeights, colHeadHeight, rowHeadWidth) {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            const child = this.measure.children[0];\n            this.setCellSize(child, 0, y, rowHeadWidth, rowHeights[row]);\n            this.rowHeads.appendChild(child);\n            y += rowHeights[row] - 1 - 1 + seam;\n        }\n        let filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowHeads.appendChild(filler);\n        this.rowResizeHandles.style.top = `${colHeadHeight}px`;\n        this.rowResizeHandles.style.width = `${rowHeadWidth}px`;\n        y = -this.HANDLE_SKEW;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            y += rowHeights[row] - 1;\n            const rowHandle = this.createHandle(row, 0, y, rowHeadWidth, this.HANDLE_SIZE);\n            this.rowResizeHandles.appendChild(rowHandle);\n        }\n        y += this.HANDLE_SIZE;\n        filler = span();\n        filler.classList.add(\"head\");\n        filler.classList.add(\"fill\");\n        filler.style.left = `0`;\n        filler.style.top = `${y}0px`;\n        filler.style.width = `${rowHeadWidth}px`;\n        filler.style.height = `256px`;\n        this.rowResizeHandles.appendChild(filler);\n    }\n    placeBody(rowHeadWidth, colHeadHeight) {\n        if (this.colHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.colHeads.style.height = `${colHeadHeight - 2}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.colHeads.style.height = `${colHeadHeight}px`;\n                this.colHeads.style.left = `${rowHeadWidth - (this.rowHeads == null ? 0 : 1)}px`;\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            if (this.adapter?.config.seamless) {\n                this.rowHeads.style.width = `${rowHeadWidth - 2}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 2)}px`;\n            }\n            else {\n                this.rowHeads.style.width = `${rowHeadWidth}px`;\n                this.rowHeads.style.top = `${colHeadHeight - (this.colHeads == null ? 0 : 1)}px`;\n            }\n        }\n        --rowHeadWidth;\n        --colHeadHeight;\n        if (this.adapter?.config.seamless) {\n            --rowHeadWidth;\n            --colHeadHeight;\n        }\n        if (rowHeadWidth < 0) {\n            rowHeadWidth = 0;\n        }\n        if (colHeadHeight < 0) {\n            colHeadHeight = 0;\n        }\n        this.body.style.left = `${rowHeadWidth}px`;\n        this.body.style.top = `${colHeadHeight}px`;\n        return { rowHeadWidth, colHeadHeight };\n    }\n    placeBodyCells(colWidths, rowHeights, colHeadHeight, rowHeadWidth) {\n        const seam = this.adapter.config.seamless ? 0 : 1;\n        let y = 0;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let x = 0;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                const child = this.measure.children[0];\n                this.setCellSize(child, x, y, colWidths[col], rowHeights[row]);\n                this.body.appendChild(child);\n                x += colWidths[col] - 2 + seam;\n            }\n            y += rowHeights[row] - 2 + seam;\n        }\n    }\n    createHandle(idx, x, y, w, h) {\n        const handle = span();\n        handle.className = \"handle\";\n        handle.style.left = `${x}px`;\n        handle.style.top = `${y}px`;\n        handle.style.width = `${w}px`;\n        handle.style.height = `${h}px`;\n        handle.dataset[\"idx\"] = `${idx}`;\n        handle.onpointerdown = this.handleDown;\n        handle.onpointermove = this.handleMove;\n        handle.onpointerup = this.handleUp;\n        return handle;\n    }\n    handleDown(ev) {\n        ev.preventDefault();\n        this.handle = ev.target;\n        this.handleIndex = parseInt(this.handle.dataset[\"idx\"]) + 1;\n        this.handle.setPointerCapture(ev.pointerId);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            this.deltaHandle = ev.clientX - px2int(this.handle.style.left);\n            this.deltaSplitBody = ev.clientX;\n            this.deltaSplitHead = ev.clientX - px2float(this.body.style.left);\n            const cell = this.colHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientX - px2float(cell.style.width);\n            this.splitVertical(this.handleIndex);\n        }\n        else {\n            this.deltaHandle = ev.clientY - px2float(this.handle.style.top);\n            this.deltaSplitBody = ev.clientY;\n            this.deltaSplitHead = ev.clientY - px2float(this.body.style.top);\n            const cell = this.rowHeads.children[this.handleIndex - 1];\n            this.deltaColumn = ev.clientY - px2float(cell.style.height);\n            this.splitHorizontal(this.handleIndex);\n        }\n    }\n    handleMove(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.handle.style.left = `${clientX - this.deltaHandle}px`;\n            this.splitHead.style.left = `${clientX - this.deltaSplitHead}px`;\n            this.splitBody.style.left = `${clientX - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.colHeads.children[h - 1].style.width = `${clientX - this.deltaColumn}px`;\n            for (let row = 0; row < this.adapter.rowCount; ++row) {\n                this.body.children[h - 1 + row * h].style.width = `${clientX - this.deltaColumn}px`;\n            }\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.handle.style.top = `${clientY - this.deltaHandle}px`;\n            this.splitHead.style.top = `${clientY - this.deltaSplitHead}px`;\n            this.splitBody.style.top = `${clientY - this.deltaSplitBody}px`;\n            const h = this.handleIndex;\n            this.rowHeads.children[h - 1].style.height = `${clientY - this.deltaColumn}px`;\n            let idx = (h - 1) * this.adapter.colCount;\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                this.body.children[idx + col].style.height = `${clientY - this.deltaColumn}px`;\n            }\n        }\n    }\n    handleUp(ev) {\n        if (this.handle === undefined) {\n            return;\n        }\n        this.handleMove(ev);\n        const isColumn = this.handle.parentElement === this.colResizeHandles;\n        if (isColumn) {\n            let clientX = ev.clientX;\n            const xLimit = this.deltaColumn + 8;\n            if (clientX < xLimit) {\n                clientX = xLimit;\n            }\n            this.joinVertical(this.handleIndex, clientX - this.deltaSplitBody);\n        }\n        else {\n            let clientY = ev.clientY;\n            const yLimit = this.deltaColumn + 8;\n            if (clientY < yLimit) {\n                clientY = yLimit;\n            }\n            this.joinHorizontal(this.handleIndex, clientY - this.deltaSplitBody);\n        }\n        this.handle = undefined;\n    }\n    splitVerticalNew(splitCol) {\n        this.splitHeadVertical(splitCol);\n        this.splitBodyVertical(splitCol);\n    }\n    splitHeadVertical(splitCol) {\n        if (this.colHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody colHack\";\n        this.splitHead.style.top = `0`;\n        this.splitHead.style.bottom = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitCol;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.left = `0px`;\n            this.splitHead.style.width = `1px`;\n        }\n        else {\n            if (idx < this.colHeads.children.length) {\n                let cell = this.colHeads.children[idx];\n                let width = 0;\n                const left = px2float(cell.style.left);\n                while (idx < this.colHeads.children.length) {\n                    cell = this.colHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    width += b.width - overlap;\n                    let x = px2float(cell.style.left);\n                    cell.style.left = `${x - left}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    width += overlap;\n                }\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.colHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + b.width - overlap;\n                this.splitHead.style.left = `${left}px`;\n                this.splitHead.style.width = `1px`;\n            }\n        }\n        this.colHeads.appendChild(this.splitHead);\n    }\n    splitBodyVertical(splitCol) {\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.top = `0`;\n        this.splitBody.style.bottom = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.left = `0px`;\n            this.splitBody.style.width = `1px`;\n        }\n        else {\n            const previousColCount = this.body.children.length / this.adapter.rowCount;\n            if (splitCol < previousColCount) {\n                let cell = this.body.children[splitCol];\n                const left = px2float(cell.style.left);\n                let width = 0;\n                const colsInBody = this.body.children.length / this.adapter.rowCount;\n                const colsToSplit = colsInBody - splitCol;\n                let idx = splitCol;\n                for (let row = 0; row < this.adapter.rowCount; ++row) {\n                    for (let col = 0; col < colsToSplit; ++col) {\n                        cell = this.body.children[idx];\n                        if (row === 0) {\n                            const b = cell.getBoundingClientRect();\n                            width += b.width - overlap;\n                        }\n                        cell.style.left = `${px2float(cell.style.left) - left}px`;\n                        this.splitBody.appendChild(cell);\n                    }\n                    idx += splitCol;\n                }\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `${width}px`;\n            }\n            else {\n                let cell = this.body.children[this.body.children.length - 1];\n                let boundary = cell.getBoundingClientRect();\n                let left = px2float(cell.style.left) + boundary.width - overlap;\n                this.splitBody.style.left = `${left}px`;\n                this.splitBody.style.width = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitVertical(splitColumn, extra = 0) {\n        if (this.colHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"cols\";\n            this.splitHead.style.left = this.colHeads.style.left;\n            this.splitHead.style.height = this.colHeads.style.height;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.colHeads.scrollTop;\n                this.splitHead.scrollLeft = this.colHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const bodyWidth = splitColumn;\n        const splitBodyColumns = this.adapter.colCount - splitColumn + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyColumns; ++i) {\n                this.splitHead.appendChild(this.colHeads.children[splitColumn]);\n            }\n            this.splitHead.appendChild(this.colHeads.children[this.colHeads.children.length - 1].cloneNode());\n        }\n        let idx = splitColumn;\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n            idx += bodyWidth;\n        }\n    }\n    joinVertical(splitCol, delta, extra = 0, colCount, rowCount) {\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyColumns = colCount - splitCol + extra;\n        let idx = splitCol - extra;\n        if (this.colHeads !== undefined) {\n            const filler = this.colHeads.children[this.colHeads.children.length - 1];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitHead.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.colHeads.insertBefore(cell, filler);\n            }\n            const fillerLeft = filler.style.left;\n            const left = px2float(fillerLeft);\n            filler.style.left = `${left + delta}px`;\n            for (let col = idx; col <= colCount; ++col) {\n                const cell = this.colResizeHandles.children[col];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n            }\n        }\n        for (let row = 0; row < rowCount; ++row) {\n            let beforeChild = this.body.children[idx];\n            for (let col = 0; col < splitBodyColumns; ++col) {\n                const cell = this.splitBody.children[0];\n                const left = px2float(cell.style.left);\n                cell.style.left = `${left + delta}px`;\n                this.body.insertBefore(cell, beforeChild);\n            }\n            idx += colCount;\n        }\n        if (this.colHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    splitHorizontalNew(splitRow) {\n        this.splitHeadHorizontal(splitRow);\n        this.splitBodyHorizontal(splitRow);\n    }\n    splitHeadHorizontal(splitRow) {\n        if (this.rowHeads === undefined) {\n            return;\n        }\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitHead = div();\n        this.splitHead.className = \"splitBody\";\n        this.splitHead.style.left = `0`;\n        this.splitHead.style.right = `0`;\n        this.splitHead.style.backgroundColor = Table.splitColor;\n        const idx = splitRow;\n        if (this.body.children.length === 0) {\n            this.splitHead.style.top = `0px`;\n            this.splitHead.style.height = `1px`;\n        }\n        else {\n            if (idx < this.rowHeads.children.length) {\n                let cell = this.rowHeads.children[idx];\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.rowHeads.children.length) {\n                    cell = this.rowHeads.children[idx];\n                    const b = cell.getBoundingClientRect();\n                    height += b.height - overlap;\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitHead.appendChild(cell);\n                }\n                if (this.adapter.config.seamless) {\n                    height += overlap;\n                }\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `${height}px`;\n            }\n            else {\n                let cell = this.rowHeads.children[this.body.children.length - 1];\n                let b = cell.getBoundingClientRect();\n                let top = px2float(cell.style.top) + b.height - overlap;\n                this.splitHead.style.top = `${top}px`;\n                this.splitHead.style.height = `1px`;\n            }\n        }\n        this.rowHeads.appendChild(this.splitHead);\n    }\n    splitBodyHorizontal(splitRow) {\n        const overlap = this.adapter.config.seamless ? 0 : 1;\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.left = `0`;\n        this.splitBody.style.right = `0`;\n        this.splitBody.style.backgroundColor = Table.splitColor;\n        const idx = splitRow * this.adapter.colCount;\n        if (this.body.children.length === 0) {\n            this.splitBody.style.top = `0px`;\n            this.splitBody.style.height = `1px`;\n        }\n        else {\n            if (idx < this.body.children.length) {\n                let cell = this.body.children[idx];\n                let col = this.adapter.colCount;\n                let height = 0;\n                const top = px2float(cell.style.top);\n                while (idx < this.body.children.length) {\n                    cell = this.body.children[idx];\n                    --col;\n                    if (col === 0) {\n                        const b = cell.getBoundingClientRect();\n                        height += b.height - overlap;\n                        col = this.adapter.colCount;\n                    }\n                    let y = px2float(cell.style.top);\n                    cell.style.top = `${y - top}px`;\n                    this.splitBody.appendChild(cell);\n                }\n                height += overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `${height}px`;\n            }\n            else {\n                let cellAtBottom = this.body.children[this.body.children.length - 1];\n                let b = cellAtBottom.getBoundingClientRect();\n                let top = px2float(cellAtBottom.style.top) + b.height - overlap;\n                this.splitBody.style.top = `${top}px`;\n                this.splitBody.style.height = `1px`;\n            }\n        }\n        this.body.appendChild(this.splitBody);\n    }\n    splitHorizontal(splitRow, extra = 0, event) {\n        if (this.rowHeads !== undefined) {\n            this.splitHead = div();\n            this.splitHead.className = \"rows\";\n            this.splitHead.style.top = this.rowHeads.style.top;\n            this.splitHead.style.width = this.rowHeads.style.width;\n            this.root.appendChild(this.splitHead);\n            setTimeout(() => {\n                this.splitHead.scrollTop = this.rowHeads.scrollTop;\n                this.splitHead.scrollLeft = this.rowHeads.scrollLeft;\n            }, 0);\n        }\n        this.splitBody = div();\n        this.splitBody.className = \"splitBody\";\n        this.splitBody.style.backgroundColor = 'rgba(255,128,0,0.5)';\n        const b = this.body.getBoundingClientRect();\n        this.splitBody.style.width = `${b.width}px`;\n        this.splitBody.style.height = `${b.height}px`;\n        this.body.appendChild(this.splitBody);\n        const splitBodyRows = this.adapter.rowCount - splitRow + extra;\n        if (this.splitHead !== undefined) {\n            for (let i = 0; i < splitBodyRows; ++i) {\n                this.splitHead.appendChild(this.rowHeads.children[splitRow]);\n            }\n            this.splitHead.appendChild(this.rowHeads.children[this.rowHeads.children.length - 1].cloneNode());\n        }\n        let idx = this.adapter.colCount * splitRow;\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                this.splitBody.appendChild(this.body.children[idx]);\n            }\n        }\n        if (this.splitBody.children.length > 0) {\n            idx = this.splitBody.children.length - 1;\n            const last = this.splitBody.children[idx];\n            const top = px2int(last.style.top);\n            for (let i = 0; i < this.splitBody.children.length; ++i) {\n                const c = this.splitBody.children[i];\n                const y = px2int(c.style.top);\n                c.style.top = `${y - top}px`;\n            }\n            this.splitBody.style.backgroundColor = '#f80';\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (event !== undefined && this.body.children.length > 0) {\n            idx = event.index * this.adapter.colCount;\n            const last = this.body.children[idx];\n            const top = px2int(last.style.top);\n            this.splitBody.style.top = `${top}px`;\n            this.splitBody.style.height = `${b.height - top}px`;\n        }\n        else if (this.body.children.length > 0) {\n            const filler = span();\n            idx = this.body.children.length - 2;\n            const last = this.body.children[idx];\n            const bf = this.body.children[idx].getBoundingClientRect();\n            filler.style.border = 'none';\n            filler.style.backgroundColor = '#1e1e1e';\n            const top = px2int(last.style.top) + bf.height;\n            filler.style.top = `${top}px`;\n            filler.style.left = `0px`;\n            filler.style.width = `${b.width - 2}px`;\n            filler.style.height = `${b.height - top}px`;\n            this.splitBody.appendChild(filler);\n        }\n        else {\n        }\n    }\n    joinHorizontal(splitRow, delta, extra = 0, colCount, rowCount) {\n        if (colCount === undefined) {\n            colCount = this.adapter.colCount;\n        }\n        if (rowCount === undefined) {\n            rowCount = this.adapter.rowCount;\n        }\n        const splitBodyRows = rowCount - splitRow + extra;\n        if (this.rowHeads !== undefined) {\n            const filler = this.rowHeads.children[this.rowHeads.children.length - 1];\n            for (let row = 0; row < splitBodyRows; ++row) {\n                const cell = this.splitHead.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.rowHeads.insertBefore(cell, filler);\n            }\n            const fillerTop = filler.style.top;\n            const top = px2float(fillerTop);\n            filler.style.top = `${top + delta}px`;\n            let idx = splitRow;\n            for (let row = idx; row <= rowCount; ++row) {\n                const cell = this.rowResizeHandles.children[row];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n            }\n        }\n        for (let row = 0; row < splitBodyRows; ++row) {\n            for (let col = 0; col < colCount; ++col) {\n                const cell = this.splitBody.children[0];\n                const top = px2float(cell.style.top);\n                cell.style.top = `${top + delta}px`;\n                this.body.appendChild(cell);\n            }\n        }\n        if (this.rowHeads !== undefined) {\n            this.root.removeChild(this.splitHead);\n            this.splitHead = undefined;\n        }\n        this.body.removeChild(this.splitBody);\n        this.splitBody = undefined;\n    }\n    setHeadingFillerSizeToScrollbarSize() {\n        const bounds = this.body.getBoundingClientRect();\n        if (this.colHeads !== undefined) {\n            const w = Math.ceil(bounds.width - this.body.clientWidth);\n            this.colHeads.children[this.colHeads.children.length - 1].style.width = `${w}px`;\n            this.colHeads.style.right = `${w}px`;\n        }\n        if (this.rowHeads !== undefined) {\n            const h = Math.ceil(bounds.height - this.body.clientHeight);\n            this.rowHeads.children[this.rowHeads.children.length - 1].style.height = `${h}px`;\n            this.rowHeads.style.bottom = `${h}px`;\n        }\n    }\n    clientPosToTablePos(x, y) {\n        let col, row;\n        for (col = 0; col < this.adapter.colCount; ++col) {\n            const b = this.body.children[col].getBoundingClientRect();\n            if (b.x <= x && x < b.x + b.width)\n                break;\n        }\n        if (col >= this.adapter.colCount) {\n            return undefined;\n        }\n        let idx = 0;\n        for (row = 0; row < this.adapter.rowCount; ++row) {\n            const b = this.body.children[idx].getBoundingClientRect();\n            if (b.y <= y && y < b.y + b.height)\n                break;\n            idx += this.adapter.colCount;\n        }\n        if (row >= this.adapter.rowCount) {\n            return undefined;\n        }\n        return new TablePos(col, row);\n    }\n}\nTable.maskColor = `#1e1e1e`;\nTable.splitColor = `#1e1e1e`;\nTable.allTables = new Set();\nTable.define(\"tx-table\", Table);\n//# sourceMappingURL=Table.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { View } from \"../view/View.js\";\nimport { GenericTool } from \"../view/GenericTool.js\";\nimport { textAreaStyle } from \"../view/textAreaStyle.js\";\nimport { Table } from \"./Table.js\";\nexport class TableTool extends GenericTool {\n    constructor() {\n        super();\n        this.toolbar = _jsx(\"div\", { class: \"toolbar\" });\n        this.buttonAddRowAbove = _jsx(\"button\", { class: \"left\", title: \"add row above\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"8.5\", x2: \"4.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"8.5\", y2: \"13.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"2\", x2: \"6.5\", y2: \"7\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"4.5\", x2: \"9\", y2: \"4.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowAbove.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowAbove);\n        this.buttonAddRowBelow = _jsx(\"button\", { title: \"add row below\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6.5\", y1: \"6\", x2: \"6.5\", y2: \"11\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4\", y1: \"8.5\", x2: \"9\", y2: \"8.5\", class: \"stroke\" })] }) });\n        this.buttonAddRowBelow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.insertRow(selection.row + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowBelow);\n        this.buttonDeleteRow = _jsx(\"button\", { class: \"right\", title: \"delete row\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"5.5\", y1: \"3.5\", x2: \"11.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"11.5\", y1: \"3.5\", x2: \"5.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteRow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isRowEditInterface(model)) {\n                model.removeRow(selection.row, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteRow);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddColumnLeft = _jsx(\"button\", { class: \"left\", title: \"add column left\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"7\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"4\", x2: \"4.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnLeft.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnLeft);\n        this.buttonAddColumnRight = _jsx(\"button\", { title: \"add column right\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"4.5\", y2: \"8.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"6\", y1: \"6.5\", x2: \"11\", y2: \"6.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4\", x2: \"8.5\", y2: \"9\", class: \"stroke\" })] }) });\n        this.buttonAddColumnRight.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.insertColumn(selection.col + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddColumnRight);\n        this.buttonDeleteColumn = _jsx(\"button\", { class: \"right\", title: \"delete column\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"5.5\", x2: \"9.5\", y2: \"11.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11.5\", x2: \"9.5\", y2: \"5.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.buttonDeleteColumn.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selection;\n            if (selection && isColumnEditInterface(model)) {\n                model.removeColumn(selection.col, 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteColumn);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddNodeAbove = _jsx(\"button\", { class: \"left\", title: \"add node above\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeAbove);\n        this.buttonAddNodeBelow = _jsx(\"button\", { title: \"add node below\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"11\", x2: \"3.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"12.5\", x2: \"5\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"16\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeBelow);\n        this.buttonAddNodeParent = _jsx(\"button\", { title: \"add node parent\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.buttonAddNodeParent.onclick = () => {\n        };\n        this.toolbar.appendChild(this.buttonAddNodeParent);\n        this.buttonAddNodeChild = _jsx(\"button\", { title: \"add node child\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }), _jsx(\"line\", { x1: \"9.5\", y1: \"11\", x2: \"9.5\", y2: \"14\", class: \"stroke\" }), _jsx(\"line\", { x1: \"8\", y1: \"12.5\", x2: \"11\", y2: \"12.5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"17\", class: \"stroke\" })] }) });\n        this.toolbar.appendChild(this.buttonAddNodeChild);\n        this.buttonDeleteNode = _jsx(\"button\", { class: \"right\", title: \"delete node\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 17\", width: \"10\", height: \"17\", children: [_jsx(\"rect\", { x: \"1.5\", y: \"5.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"2\", x2: \"4.5\", y2: \"5\", class: \"stroke\" }), _jsx(\"line\", { x1: \"4.5\", y1: \"12\", x2: \"4.5\", y2: \"15\", class: \"stroke\" }), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"0.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" })] }) });\n        this.toolbar.appendChild(this.buttonDeleteNode);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textAreaStyle, true));\n        this.shadowRoot.appendChild(this.toolbar);\n    }\n    canHandle(view) {\n        return view instanceof Table;\n    }\n    activate() {\n        this.lastActiveTable = GenericTool.activeView;\n        this.toolbar.classList.add(\"active\");\n    }\n    deactivate() {\n        this.lastActiveTable = undefined;\n        this.toolbar.classList.remove(\"active\");\n    }\n}\nView.define(\"tx-tabletool\", TableTool);\nfunction isRowEditInterface(model) {\n    return model !== undefined && 'insertRow' in model && \"removeRow\" in model;\n}\nfunction isColumnEditInterface(model) {\n    return model !== undefined && 'insertColumn' in model && \"removeColumn\" in model;\n}\n//# sourceMappingURL=TableTool.js.map","import { TableAdapter } from \"./TableAdapter.js\";\nclass AbstractTypedTableAdapter extends TableAdapter {\n}\nexport class TypedTableAdapter extends AbstractTypedTableAdapter {\n}\n//# sourceMappingURL=TypedTableAdapter.js.map","import { TableEventType } from \"./TableEventType.js\";\nexport class TableEvent {\n    constructor(type, index, size) {\n        this.type = type;\n        this.index = index;\n        this.size = size;\n    }\n    get col() {\n        return this.index;\n    }\n    get row() {\n        return this.size;\n    }\n    toString() {\n        return `TableEvent {type: ${TableEventType[this.type]}, index: ${this.index}, size: ${this.size}}`;\n    }\n}\n//# sourceMappingURL=TableEvent.js.map","import { TypedTableModel } from \"./TypedTableModel.js\";\nimport { TableEvent } from \"../TableEvent.js\";\nimport { TableEventType } from \"../TableEventType.js\";\nexport class RowInfo {\n    constructor(node, depth, open = true) {\n        this.node = node;\n        this.depth = depth;\n        this.open = open;\n    }\n}\nexport class TreeModel extends TypedTableModel {\n    constructor(nodeClass, root) {\n        super(nodeClass);\n        this.rows = new Array();\n        if (root !== undefined) {\n            this.createRowInfoHelper(this.rows, root, 0);\n        }\n    }\n    get colCount() { return 1; }\n    get rowCount() { return this.rows.length; }\n    getRow(node) {\n        for (let i = 0; i < this.rows.length; ++i) {\n            if (this.rows[i].node === node) {\n                return i;\n            }\n        }\n        return undefined;\n    }\n    addSiblingBefore(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            row = 0;\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n        }\n        else {\n            if (row === 0) {\n                this.setNext(nn, this.getRoot());\n                this.setRoot(nn);\n                this.rows.unshift(new RowInfo(nn, 0));\n            }\n            else {\n                this.setNext(nn, this.rows[row].node);\n                if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                    this.setNext(this.rows[row - 1].node, nn);\n                else\n                    this.setDown(this.rows[row - 1].node, nn);\n                this.rows.splice(row, 0, new RowInfo(nn, this.rows[row].depth));\n            }\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    addSiblingAfter(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            row = 0;\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n        }\n        else {\n            this.setNext(nn, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, nn);\n            const count = this.nodeCount(this.getDown(this.rows[row].node));\n            const depth = this.rows[row].depth;\n            row += count + 1;\n            this.rows.splice(row, 0, new RowInfo(nn, depth));\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    addChildAfter(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n            this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, 0, 1));\n        }\n        else {\n            const down = this.getDown(this.rows[row].node);\n            const subtreeSize = this.nodeCount(down);\n            for (let i = 0; i < subtreeSize; ++i)\n                ++this.rows[row + 1 + i].depth;\n            this.setDown(nn, down);\n            this.setDown(this.rows[row].node, nn);\n            this.rows.splice(row + 1, 0, new RowInfo(nn, this.rows[row].depth + 1));\n            this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row + 1, 1));\n        }\n        return row;\n    }\n    addParentBefore(row) {\n        const nn = this.createNode();\n        if (row === 0) {\n            for (let i = 0; i < this.rows.length; ++i)\n                ++this.rows[row + i].depth;\n            this.setDown(nn, this.getRoot());\n            this.setRoot(nn);\n            this.rows.unshift(new RowInfo(nn, 0));\n        }\n        else {\n            const depth = this.rows[row].depth;\n            const subtreeSize = this.nodeCount(this.getDown(this.rows[row].node)) + 1;\n            for (let i = 0; i < subtreeSize; ++i)\n                ++this.rows[row + i].depth;\n            this.setDown(nn, this.rows[row].node);\n            this.setNext(nn, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, undefined);\n            if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                this.setNext(this.rows[row - 1].node, nn);\n            else\n                this.setDown(this.rows[row - 1].node, nn);\n            this.rows.splice(row, 0, new RowInfo(nn, depth));\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    deleteAt(row) {\n        let down = this.getDown(this.rows[row].node);\n        if (down !== undefined) {\n            const subtreeSize = this.nodeCount(down) + 1;\n            for (let i = 0; i < subtreeSize; ++i)\n                --this.rows[row + i].depth;\n            this.append(down, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, undefined);\n            if (row === 0) {\n                this.setRoot(down);\n            }\n            else {\n                this.setNext(this.rows[row - 1].node, down);\n            }\n        }\n        else {\n            if (row === 0) {\n                const next = this.getNext(this.rows[row].node);\n                this.setNext(this.rows[row].node, undefined);\n                this.setRoot(next);\n            }\n            else {\n                const next = this.getNext(this.rows[row].node);\n                this.setNext(this.rows[row].node, undefined);\n                if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                    this.setNext(this.rows[row - 1].node, next);\n                else\n                    this.setDown(this.rows[row - 1].node, next);\n            }\n        }\n        this.rows.splice(row, 1);\n        this.modified.trigger(new TableEvent(TableEventType.REMOVE_ROW, row, 1));\n        return row;\n    }\n    init() { }\n    toggleAt(row) {\n        if (this.rows[row].open) {\n            this.closeAt(row);\n        }\n        else {\n            this.openAt(row);\n        }\n    }\n    isOpen(row) {\n        return this.rows[row].open;\n    }\n    openAt(row) {\n        let r = this.rows[row];\n        if (r.open || this.getDown(r.node) === undefined)\n            return;\n        r.open = true;\n        const newRows = this.createRowInfo(row);\n        this.rows.splice(row + 1, 0, ...newRows);\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row + 1, newRows.length));\n    }\n    closeAt(row) {\n        let r = this.rows[row];\n        if (!r.open || this.getDown(r.node) === undefined)\n            return;\n        const count = this.getVisibleChildCount(row);\n        r.open = false;\n        this.rows.splice(row + 1, count);\n        this.modified.trigger(new TableEvent(TableEventType.REMOVE_ROW, row + 1, count));\n    }\n    collapse() {\n        let row = 0;\n        while (row < this.rowCount) {\n            this.closeAt(row);\n            ++row;\n        }\n        for (let rowinfo of this.rows) {\n            rowinfo.open = false;\n        }\n    }\n    createRowInfo(row) {\n        const newRows = new Array();\n        let r = this.rows[row];\n        if (r.open && this.getDown(r.node)) {\n            this.createRowInfoHelper(newRows, this.getDown(r.node), r.depth + 1);\n        }\n        return newRows;\n    }\n    createRowInfoHelper(newRows, node, depth) {\n        const rowInfo = new RowInfo(node, depth, false);\n        newRows.push(rowInfo);\n        if (rowInfo.open && this.getDown(node)) {\n            this.createRowInfoHelper(newRows, this.getDown(node), rowInfo.depth + 1);\n        }\n        if (this.getNext(node)) {\n            this.createRowInfoHelper(newRows, this.getNext(node), rowInfo.depth);\n        }\n    }\n    getVisibleChildCount(row) {\n        let r = this.rows[row];\n        let count = 1;\n        if (r.open && this.getDown(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        return count - 1;\n    }\n    getVisibleChildCountHelper(row) {\n        let r = this.rows[row];\n        let count = 1;\n        if (r.open && this.getDown(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        if (this.getNext(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        return count;\n    }\n    append(chain, node) {\n        if (node === undefined)\n            return;\n        let p = chain;\n        let next;\n        while (true) {\n            next = this.getNext(p);\n            if (next === undefined)\n                break;\n            p = next;\n        }\n        this.setNext(p, node);\n    }\n    nodeCount(node) {\n        if (node === undefined)\n            return 0;\n        return 1 + this.nodeCount(this.getDown(node)) + this.nodeCount(this.getNext(node));\n    }\n}\n//# sourceMappingURL=TreeModel.js.map","import { TypedTableAdapter } from \"./TypedTableAdapter.js\";\nimport { svg, rect, line, span, text } from \"../../util/lsx.js\";\nexport class TreeAdapter extends TypedTableAdapter {\n    constructor(model) {\n        super(model);\n        this.config.seamless = true;\n    }\n    treeCell(pos, cell, label) {\n        this._showCell(pos, cell);\n        const labelNode = span(text(label));\n        labelNode.style.verticalAlign = \"middle\";\n        labelNode.style.padding = \"2px\";\n        cell.appendChild(labelNode);\n    }\n    showCell(pos, cell) {\n        this._showCell(pos, cell);\n    }\n    _showCell(pos, cell) {\n        if (this.model === undefined) {\n            console.log(\"no model\");\n            return;\n        }\n        const rowinfo = this.model.rows[pos.row];\n        const rs = 8;\n        const sx = rs + 4;\n        const height = sx;\n        const dx = 3.5;\n        const dy = Math.round(height / 2 - rs / 2) - 0.5;\n        const rx = 3;\n        const width = rowinfo.depth * sx + sx + dx;\n        const svgNode = svg();\n        svgNode.setAttributeNS(null, `width`, `${width}`);\n        svgNode.setAttributeNS(null, `height`, `${sx}`);\n        svgNode.style.verticalAlign = \"middle\";\n        svgNode.style.background = \"none\";\n        const d = rowinfo.depth;\n        if (this.model.getDown(rowinfo.node) !== undefined) {\n            const x0 = d * sx + dx;\n            const box = rect(x0, dy, rs, rs, \"#000\", \"#fff\");\n            box.style.cursor = \"pointer\";\n            svgNode.appendChild(box);\n            const minus = line(x0 + (rs >> 2), dy + (rs >> 1), x0 + rs - (rs >> 2), dy + (rs >> 1), \"#000\");\n            minus.style.cursor = \"pointer\";\n            svgNode.appendChild(minus);\n            const plus = line(x0 + (rs >> 1), dy + (rs >> 2), x0 + (rs >> 1), dy + rs - (rs >> 2), \"#000\");\n            plus.style.cursor = \"pointer\";\n            plus.style.display = rowinfo.open ? \"none\" : \"\";\n            svgNode.appendChild(plus);\n            svgNode.appendChild(line(x0 + rs, dy + (rs >> 1), x0 + rs + rx, dy + (rs >> 1), \"#f80\"));\n            svgNode.onpointerdown = (event) => {\n                event.preventDefault();\n                event.stopPropagation();\n                const rowNumber = this.model.getRow(rowinfo.node);\n                if (rowNumber === undefined) {\n                    console.log(\"  ==> couldn't find row number for node\");\n                    return;\n                }\n                const bounds = svgNode.getBoundingClientRect();\n                const x = event.clientX - bounds.left;\n                const y = event.clientY - bounds.top;\n                if (x0 <= x && x <= x0 + rs && dy <= y && y <= dy + rs) {\n                    this.model?.toggleAt(rowNumber);\n                    plus.style.display = this.model.isOpen(rowNumber) ? \"none\" : \"\";\n                }\n            };\n        }\n        else {\n            svgNode.appendChild(line(d * sx + dx + (rs >> 1) - 0.5, 0, d * sx + dx + (rs >> 1), dy + (rs >> 1), \"#f80\"));\n            svgNode.appendChild(line(d * sx + dx + (rs >> 1), dy + (rs >> 1), d * sx + dx + rs + rx, dy + (rs >> 1), \"#f80\"));\n        }\n        let lines = \"\";\n        for (let i = 0; i <= d; ++i) {\n            const x = i * sx + dx + (rs >> 1) + 2;\n            for (let j = pos.row + 1; j < this.model.rowCount; ++j) {\n                if (this.model.rows[j].depth < i)\n                    break;\n                if (i === this.model.rows[j].depth) {\n                    if (i !== d) {\n                        lines += `<line x1='${x}' y1='0' x2='${x}' y2='100%' stroke='%23f80' />`;\n                    }\n                    else {\n                        if (this.model.getNext(rowinfo.node) !== undefined) {\n                            lines += `<line x1='${x}' y1='0' x2='${x}' y2='100%' stroke='%23f80' />`;\n                        }\n                    }\n                    break;\n                }\n            }\n        }\n        if (this.model.getDown(rowinfo.node) === undefined || this.model.getNext(rowinfo.node) === undefined) {\n            const x = d * sx + dx + (rs >> 1) + 2;\n            lines += `<line x1='${x}' y1='0' x2='${x}' y2='${rs >> 1}' stroke='%23f80' />`;\n        }\n        cell.style.background = `url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' style='background: %23000;'>${lines}</svg>\\\")`;\n        cell.style.backgroundRepeat = \"repeat-y\";\n        cell.replaceChildren(svgNode);\n    }\n}\n//# sourceMappingURL=TreeAdapter.js.map","import { TreeModel } from \"./TreeModel.js\";\nexport class TreeNodeModel extends TreeModel {\n    constructor(nodeClass, root) {\n        super(nodeClass, root);\n        this.root = root;\n    }\n    createNode() { return new this.nodeClass(); }\n    deleteNode(node) { }\n    getRoot() { return this.root; }\n    setRoot(node) { this.root = node; }\n    getDown(node) { return node.down; }\n    setDown(node, down) { node.down = down; }\n    getNext(node) { return node.next; }\n    setNext(node, next) { node.next = next; }\n}\n//# sourceMappingURL=TreeNodeModel.js.map","import { TargetRef } from './TargetRef'\nimport { Human } from '../Human'\nimport { getTargetWeights } from './getTargetWeights'\n\nimport { NumberModel } from 'toad.js'\n\n// from apps/humanmodifier.py\nexport abstract class Modifier {\n    groupName: string\n    name: string\n    description: string\n    value: number\n    defaultValue: number\n    model?: NumberModel\n\n    // eventType\n\n    targets: TargetRef[]\n\n    verts?: number[]\n    faces?: number[]\n\n    macroVariable?: string\n    macroDependencies?: Set<String>\n\n    human?: Human\n\n    constructor(groupName: string, name: string) {\n        this.groupName = groupName.replace('/', '-')\n        this.name = name.replace('/', '-')\n        this.description = ''\n\n        this.value = 0\n        this.defaultValue = 0\n        this.targets = []\n    }\n\n    // set/add/link/assign modifier to human\n    setHuman(human: Human) {\n        this.human = human\n        human.addModifier(this)\n    }\n\n    get fullName(): string {\n        return `${this.groupName}/${this.name}`\n    }\n\n    getMin() {\n        return 0.0\n    }\n\n    getMax() {\n        return 1.0\n    }\n\n    setValue(value: number, {skipDependencies = false} = {}) {\n        console.log(`Modifier.setValue(${value}) // modifier ${this.fullName}`)\n        const clampedValue = this.clampValue(value)\n        const factors = this.getFactors(clampedValue)\n        const tWeights = getTargetWeights(this.targets, factors, clampedValue)\n        for(let x of tWeights)\n            this.human!.setDetail(x[0], x[1])\n\n        if (skipDependencies)\n            return\n\n        // Update dependent modifiers\n        this.propagateUpdate(false)\n    }\n\n    resetValue(): number {\n        const oldValue = this.getValue()\n        this.setValue(this.getDefaultValue())\n        return oldValue\n    }\n\n    propagateUpdate(realtime = false) {\n        console.log('please note: Modifier.propagateUpdate is not implemented')\n        // let f\n        // if (realtime)\n        //     f = realtimeDependencyUpdates\n        // else\n        //     f = None\n\n        // for (const dependentModifierGroup of self.human.getModifiersAffectedBy(this, filter = f)) {\n        //     // Only updating one modifier in a group should suffice to update the\n        //     // targets affected by the entire group.\n        //     const m = this.human.getModifiersByGroup(dependentModifierGroup)[0]\n        //     if (realtime)\n        //         m.updateValue(m.getValue(), skipUpdate = True)\n        //     else\n        //         m.setValue(m.getValue(), skipDependencies = True)\n        // }\n    }\n\n    abstract clampValue(value: number): number\n    abstract getFactors(value: number): Map<string, number>\n\n    getValue(): number {\n        // return sum([self.human.getDetail(target[0]) for target in self.targets])\n        let sum = 0\n        for(let target of this.targets)\n            sum += this.human!.getDetail(target.targetPath)\n        return sum\n    }\n\n    getDefaultValue(): number {\n        return this.defaultValue\n    }\n\n    buildLists() {\n        if (this.verts !== undefined || this.faces !== undefined)\n            return\n        for (const target in this.targets) {\n\n        }        \n    }\n\n    updateValue(value: number, {updateNormals = 1, skipUpdate = false} = {} ) {\n        // console.log(`Modifier.updateValue() is not implemented // ${this.fullName}`)\n        // if (this.verts === undefined && this.faces === undefined)\n        //     this.buildLists()\n\n        //    # Update detail state\n        //    old_detail = [self.human.getDetail(target[0]) for target in self.targets]\n        this.setValue(value, {skipDependencies: true})\n        //    new_detail = [self.human.getDetail(target[0]) for target in self.targets]\n\n        //    # Apply changes\n        //    for target, old, new in zip(self.targets, old_detail, new_detail):\n        //        if new == old:\n        //            continue\n        //        if self.human.isPosed():\n        //            # Apply target with pose transformation\n        //            animatedMesh = self.human\n        //        else:\n        //            animatedMesh = None\n        //        algos3d.loadTranslationTarget(self.human.meshData, target[0], new - old, None, 0, 0, animatedMesh=animatedMesh)\n\n        //    if skipUpdate:\n        //        # Used for dependency updates (avoid dependency loops and double updates to human)\n        //        return\n\n        //    # Update dependent modifiers\n        //    self.propagateUpdate(realtime = True)\n\n        //    # Update vertices\n        //    if updateNormals:\n        //        self.human.meshData.calcNormals(1, 1, self.verts, self.faces)\n        //    self.human.meshData.update()\n        //    event = events3d.HumanEvent(self.human, self.eventType)\n        //    event.modifier = self.fullName\n        //    self.human.callEvent('onChanging', event)\n    }\n\n    getSymmetrySide(): string|undefined {\n        throw Error('Not implemented')\n    }\n\n    getSymmetricOpposite(): string|undefined {\n        throw Error('Not implemented')\n    }\n\n    getSimilar(): any {\n        throw Error('Not implemented')\n    }\n\n    isMacro() {\n        return this.macroVariable !== undefined\n    }\n\n    getModel() {\n        if (this.model === undefined) {\n            this.model = new NumberModel(this.getDefaultValue(), { min: this.getMin(), max: this.getMax(), step: 0.05 })\n        }\n        return this.model\n    }\n}\n\n\n","import { Modifier } from './Modifier'\nimport { getTargetWeights } from \"./getTargetWeights\"\n// import { Target } from '../target/Target'\nimport { TargetRef } from './TargetRef'\n\n// 2 targets from the TargetFactory, value in [0, 1] or [-1, 1]\nexport class ManagedTargetModifier extends Modifier {\n    left?: string\n    right?: string\n\n    lTargets?: TargetRef[]\n    cTargets?: TargetRef[]\n    rTargets?: TargetRef[]\n\n    constructor(groupName: string, name: string) {\n        super(groupName, name)\n    }\n\n    override clampValue(value: number): number {\n        value = Math.min(value)\n        if (this.left !== undefined)\n            value = Math.max(-1.0, value)\n\n        else\n            value = Math.max(0.0, value)\n        return value\n    }\n\n    override setValue(value: number, { skipDependencies = false } = {}) {\n        // console.log(`ManagedTargetModifier.setValue(${value})`)\n        value = this.clampValue(value)\n        const factors = this.getFactors(value)\n        // console.log(factors)\n        const targetWeights = getTargetWeights(this.targets, factors)\n        // console.log(targetWeights)\n  \n        for(const weight of targetWeights) {\n            // console.log(`ManagedTargetModifier.setValue(${value}) -> human.setDetail(${weight[0]}, ${weight[1]})`)\n            this.human!.setDetail(weight[0], weight[1])\n        }\n\n        if (skipDependencies)\n            return\n\n        // Update dependent modifiers\n        this.propagateUpdate(false)\n    }\n\n    // ADD A UNIT TEST FOR THIS ONE\n    override getValue(): number {\n        // console.log(`ManagedTargetModifier.getValue() '${this.fullName}'`)\n        if (this.rTargets) {\n            let sum = 0\n            for(let target of this.rTargets)\n                sum += this.human!.getDetail(target.targetPath) // FIXME: this is just a guess\n            return sum\n        }\n        let sum = 0\n        for(let target of this.lTargets!)\n            sum += this.human!.getDetail(target.targetPath) // FIXME: this is just a guess\n        return sum\n    }\n\n    // return map of all Human's *Val attributes\n    override getFactors(value: number): Map<string, number> {\n        const result = new Map<string, number>()\n        const desc = Object.getOwnPropertyDescriptors(this.human)\n        for(const name in desc) {\n            if (!name.endsWith(\"Val\"))\n                continue\n            result.set(\n                name.substring(0, name.length - 3), // name without the 'Val' suffix\n                desc[name].value.value)             // NumberModel.value\n        }\n        return result\n    }\n}\n","export class TargetRef {\n    targetPath: string // tPath\n    factorDependencies: string[] // fFactors\n    constructor(targetPath: string, factorDependencies: string[]) {\n        this.targetPath = targetPath\n        this.factorDependencies = factorDependencies\n    }\n}\n","import { TargetFactory } from '../target/TargetFactory'\nimport { TargetRef } from './TargetRef'\n\n// static method of ManagedTargetModifiers\n// findTargets('buttocks-buttocks-volume-decr') -> [('data/targets/buttocks/buttocks-volume-decr.target', ['buttocks-buttocks-volume-decr'])]\n// findTargets('buttocks-buttocks-volume-incr') -> [('data/targets/buttocks/buttocks-volume-incr.target', ['buttocks-buttocks-volume-incr'])]\nexport function findTargets(path: string | undefined): TargetRef[] {\n    if (path === undefined)\n        return []\n    const targetsList = TargetFactory.getInstance().getTargetsByGroup(path)\n    if (targetsList === undefined)\n        throw Error(`findTargets(): failed to get targetsList for ${path}`)\n    // console.log(targetsList)\n    const result = []\n    for (const component of targetsList) {\n        const targetgroup = component.tuple()\n        const factordependencies = component.getVariables()\n        factordependencies.push(targetgroup)\n        result.push(\n            new TargetRef(component.path!, factordependencies)\n        )\n    }\n    return result\n}","import { ManagedTargetModifier } from './ManagedTargetModifier'\nimport { findTargets } from './findTargets'\nimport { findMacroDependencies } from './findMacroDependencies'\nimport { validCategories, valueToCategory } from '../target/Component'\n\nexport class MacroModifier extends ManagedTargetModifier {\n    constructor(groupName: string, name: string) {\n        // e.g. macrodetails/Gender\n        super(groupName, name)\n        this.defaultValue = 0.5\n        this.targets = findTargets(groupName)\n        this.macroDependencies = findMacroDependencies(groupName)\n        this.macroVariable = this.getMacroVariable()\n        if (this.macroVariable) {\n            // MacroModifier is not dependent on variable it controls itself\n            this.macroDependencies.delete(this.macroVariable)\n        }\n    }\n\n    protected getMacroVariable(): string | undefined {\n        if (this.name) {\n            let v = this.name.toLowerCase()\n            if (validCategories.indexOf(v) !== -1)\n                return v\n            if (valueToCategory.has(v))\n                return valueToCategory.get(v)\n        }\n        return undefined\n    }\n\n    override getValue(): number {\n        return this.getModel().value\n    }\n\n    override setValue(value: number, { skipDependencies = false } = {}): void {\n        // console.log(`MacroModifier(${this.fullName}).setValue(${value})`)\n        value = this.clampValue(value)\n        this.getModel().value = value\n        super.setValue(value, { skipDependencies }) \n    }\n\n    override clampValue(value: number): number {\n        return Math.max(0.0, Math.min(1.0, value))\n    }\n\n    override getFactors(value: number): Map<string, number> {\n        const factors = super.getFactors(value)\n        factors.set(this.groupName, 1.0)\n        return factors\n    }\n\n    override buildLists(): void {\n    }\n\n    override getModel() {\n        if (this.model !== undefined) {\n            return this.model\n        }\n        if (this.human === undefined) {\n            throw Error(`MacroModifier.getModel(): can only be called after human has been set`)\n        }\n        switch (this.name) {\n            case \"Gender\":\n                this.model = this.human.gender\n                break\n            case \"Age\":\n                this.model = this.human.age\n                break\n            case \"Muscle\":\n                this.model = this.human.muscle\n                break\n            case \"Weight\":\n                this.model = this.human.weight\n                break\n            case \"Height\":\n                this.model = this.human.height\n                break\n            case \"BodyProportions\":\n                this.model = this.human.bodyProportions\n                break\n            case \"BreastSize\":\n                this.model = this.human.breastSize\n                break\n            case \"BreastFirmness\":\n                this.model = this.human.breastFirmness\n                break\n            case \"African\":\n                this.model = this.human.africanVal\n                break\n            case \"Asian\":\n                this.model = this.human.asianVal\n                break\n            case \"Caucasian\":\n                this.model = this.human.caucasianVal\n                break\n            default:\n                throw Error(`MacroModifier.getModel(): not implemented for name '${this.name}'`)\n        }\n        return this.model\n    }\n}\n","import { TargetFactory } from '../target/TargetFactory'\n\nexport function findMacroDependencies(path: string | undefined) {\n    const result = new Set<string>()\n    if (path === undefined) {\n        return result\n    }\n\n    // most calls will just yield and empty set, e.g.\n    //   findMacroDependencies(head-head-age-decr) -> nothin'\n    // only the following will deliver results:\n    //   findMacroDependencies(breast) -> 'age' 'gender' 'breastfirmness' 'weight' 'breastsize' 'muscle'\n    //   findMacroDependencies(macrodetails) -> 'age' 'race' 'gender'\n    //   findMacroDependencies(macrodetails-universal) -> 'muscle' 'age' 'gender' 'weight'\n    //   findMacroDependencies(macrodetails-height) -> 'age' 'gender' 'weight' 'height' 'muscle' \n    //   findMacroDependencies(macrodetails-proportions) -> 'age' 'gender' 'weight' 'bodyproportions' 'muscle'    \n    TargetFactory.getInstance().groups.get(path)?.forEach( target => {\n        target.data.forEach( (value, key) => {\n            if (value !== undefined) {\n                result.add(key)\n            }\n        })\n    })\n    return result\n}","import { MacroModifier } from './MacroModifier'\n\nexport class EthnicModifier extends MacroModifier { \n    constructor(groupName: string, name: string) {\n        super(groupName, name)\n        this.defaultValue = 1/3\n    }\n}\n","import { ManagedTargetModifier } from './ManagedTargetModifier'\nimport { Target } from '../target/Target'\nimport { Component } from '../target/Component'\nimport { findTargets } from './findTargets'\n\n// 1 to 3 targets from the TargetFactory, value in [0, 1] or [-1, 1]\nexport class UniversalModifier extends ManagedTargetModifier {\n    targetName: string\n    center?: string\n\n    constructor(groupName: string, targetName: string, leftExt?: string, rightExt?: string, centerExt?: string) {\n        // console.log(`UniversalModifier('${groupName}', '${targetName}', '${leftExt}', '${rightExt}', '${centerExt}')`)\n        let fullTargetName = `${groupName}-${targetName}`\n        let name: string\n        let left: string | undefined\n        let center: string | undefined\n        let right: string\n        if (leftExt !== undefined && rightExt !== undefined) {\n            left = `${fullTargetName}-${leftExt}`\n            right = `${fullTargetName}-${rightExt}`\n\n            if (centerExt !== undefined) {\n                center = `${fullTargetName}-${centerExt}`\n                fullTargetName = `${fullTargetName}-${leftExt}|${centerExt}|${rightExt}`\n                name = `${targetName}-${leftExt}|${centerExt}|${rightExt}`\n            } else {\n                center = undefined\n                fullTargetName = `${fullTargetName}-${leftExt}|${rightExt}`\n                name = `${targetName}-${leftExt}|${rightExt}`\n            }\n        } else {\n            left = undefined\n            right = fullTargetName\n            center = undefined\n            name = targetName\n        }\n        super(groupName, name)\n        this.targetName = fullTargetName\n        this.left = left\n        this.center = center\n        this.right = right\n\n        // this load's the target's from the target factory\n        this.lTargets = findTargets(this.left)\n        this.rTargets = findTargets(this.right)\n        this.cTargets = findTargets(this.center)\n\n        // self.macroDependencies = self.findMacroDependencies(self.left)\n        // self.macroDependencies.update(self.findMacroDependencies(self.right))\n        // self.macroDependencies.update(self.findMacroDependencies(self.center))\n        // self.macroDependencies = list(self.macroDependencies)\n\n        // self.targets = self.l_targets + self.r_targets + self.c_targets\n        for(const targets of [this.lTargets, this.rTargets, this.cTargets])\n            if (targets !== undefined)\n                for(const target of targets)\n                    this.targets.push(target)\n    }\n\n    override getMin(): number {\n        if (this.left !== undefined)\n            return -1.0\n        else\n            return 0.0\n    }\n\n    override getFactors(value: number): Map<string, number> {\n        const factors = super.getFactors(value)\n\n        if (this.left !== undefined)\n            factors.set(this.left, -Math.min(value, 0))\n        if (this.center !== undefined)\n            factors.set(this.center, 1.0 - Math.abs(value))\n        factors.set(this.right!, Math.max(0, value))\n\n        return factors\n    }\n\n    // override setValue(value: number) {\n    //     value = this.clampValue(value)\n\n    //     console.log(`UniversalModifier.setValue(${value}) // modifier ${this.fullName}`)\n\n    //     // const factors = this.getFactors(value)\n    //     // const tWeights = this.getTargetWeights(this.targets, factors)\n        \n\n    //     // value = self.clampValue(value)\n    //     // factors = self.getFactors(value)\n\n    //     // tWeights = getTargetWeights(self.targets, factors)\n    //     // for tpath, tWeight in tWeights.items():\n    //     //     self.human.setDetail(tpath, tWeight)\n\n    //     // if skipDependencies:\n    //     //     return\n\n    //     // # Update dependent modifiers\n    //     // self.propagateUpdate(realtime = False)\n    // }\n\n    // override getValue(): number {\n    //     throw Error('Not implemented')\n    //     // right = sum([self.human.getDetail(target[0]) for target in self.r_targets])\n    //     // if right:\n    //     //     return right\n    //     // else:\n    //     //     return -sum([self.human.getDetail(target[0]) for target in self.l_targets])\n    // }\n}\n","import { EthnicModifier } from './EthnicModifier'\nimport { MacroModifier } from './MacroModifier'\nimport { UniversalModifier } from './UniversalModifier'\nimport { Modifier } from './Modifier'\nimport { Human } from '../Human'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\n\n// {\n//     \"group\": \"<groupname>\",\n//     \"modifiers\": [\n//         { \"target\": ... } |\n//         { \"target\": ..., \"min\": ..., \"max\": ... } |\n//         { \"macrovar\": ...} |\n//         { \"macrovar\": ..., \"modifierType\": ...}, ...\n//     ]\n// }, ...\n\n// from apps/humanmodifier.py\nexport function loadModifiers(filename: string, human?: Human): Modifier[] {\n    return parseModifiers(\n        FileSystemAdapter.getInstance().readFile(filename),\n        human,\n        filename)\n}\n\nexport function parseModifiers(data: string, human?: Human, filename = 'memory'): Modifier[] {\n    const classesMapping = new Map<string, any>([\n        // ['Modifier', Modifier],\n        // ['SimpleModifier', SimpleModifier],\n        // ['ManagedTargetModifier', ManagedTargetModifier],\n        // ['UniversalModifier', UniversalModifier],\n        // ['MacroModifier', MacroModifier],\n        ['EthnicModifier', EthnicModifier]\n    ])\n    const json = JSON.parse(data)\n    const modifiers = new Array<Modifier>()\n    const lookup = new Map<string, Modifier>()\n\n    for (const modifierGroup of json) {\n        const groupName = modifierGroup.group\n\n        for (const modifierDef of modifierGroup.modifiers) {\n            let modifierClass: new(...args: any[]) => Modifier\n            let modifier: Modifier\n            if ('modifierType' in modifierDef) {\n                modifierClass = classesMapping.get(modifierDef.modifierType)\n                if (modifierClass === undefined) {\n                    throw Error(`failed to instantiate modifer ${modifierDef.modifierType}`)\n                }\n            } else if ('macrovar' in modifierDef) {\n                modifierClass = MacroModifier\n            } else {\n                modifierClass = UniversalModifier\n            }\n\n            if ('macrovar' in modifierDef) {\n                modifier = new modifierClass(groupName, modifierDef.macrovar)\n                if (!modifier.isMacro()) {\n                    console.log(`Expected modifier ${modifierClass.name} to be a macro modifier, but identifies as a regular one. Please check variable category definitions in class Component.`)\n                }\n            } else {\n                //             modifier = modifierClass(groupName, mDef['target'], mDef.get('min',None), mDef.get('max',None), mDef.get('mid',None))\n                if (modifierClass !== UniversalModifier)\n                    throw Error()\n                modifier = new (modifierClass as typeof UniversalModifier)(groupName, modifierDef.target, modifierDef.min, modifierDef.max, modifierDef.mid)\n            }\n\n            if ('defaultValue' in modifierDef) {\n                modifier.defaultValue = modifierDef.defaultValue\n            }\n\n            if (modifier.fullName === undefined) {\n                console.log(`ERROR: modifier has no fullName`)\n                console.log(modifier)\n            }\n            modifiers.push(modifier)\n            lookup.set(modifier.fullName, modifier)\n            // console.log(modifier.fullName)\n        }\n    }\n\n    if (human !== undefined) {\n        for(const modifier of modifiers) {\n            modifier.setHuman(human)\n        }\n    }\n\n    console.log(`Loaded ${modifiers.length} modifiers from file ${filename}`)\n\n    // # Attempt to load modifier descriptions\n    // _tmp = os.path.splitext(filename)\n    // descFile = _tmp[0]+'_desc'+_tmp[1]\n    // hasDesc = OrderedDict([(key,False) for key in lookup.keys()])\n    // if os.path.isfile(descFile):\n    //     data = json.load(io.open(descFile, 'r', encoding='utf-8'), object_pairs_hook=OrderedDict)\n    //     dCount = 0\n    //     for mName, mDesc in data.items():\n    //         try:\n    //             mod = lookup[mName]\n    //             mod.description = mDesc\n    //             dCount += 1\n    //             hasDesc[mName] = True\n    //         except:\n    //             log.warning(\"Loaded description for %s but modifier does not exist!\", mName)\n    //     log.message(\"Loaded %s modifier descriptions from file %s\", dCount, descFile)\n    // for mName, mHasDesc in hasDesc.items():\n    //     if not mHasDesc:\n    //         log.warning(\"No description defined for modifier %s!\", mName)\n    return modifiers\n}\n","import { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\nimport { Human } from '../Human'\nimport { NumberModel } from 'toad.js/model/NumberModel'\nimport { TreeNode } from 'toad.js/table/model/TreeNode'\n\nexport interface Category {\n    sortOrder: number\n    label?: string\n    cameraView: string\n    showMacroStats?: boolean\n    modifiers: any\n}\n\nexport interface ModifierSpec {\n    mod: string\n    label: string\n    cam?: string\n    enabledCondition?: string\n}\n\nexport class SliderNode implements TreeNode {\n    static count = 0\n    label: string\n    category?: Category\n    modifierSpec?: ModifierSpec\n    model?: NumberModel\n    next?: SliderNode\n    down?: SliderNode\n    constructor(label?: string, modifierSpec?: ModifierSpec) {\n        SliderNode.count++\n        this.label = label || ''\n        this.modifierSpec = modifierSpec\n\n        if (modifierSpec) {\n            // modifier.mod can have values like\n            //   buttocks/buttocks-buttocks-volume-decr|incr-decr|incr\n            //   stomach/stomach-pregnant-decr|incr\n            // human.getModifier(modifier.mod) locates the Modifier for that name\n            // for this to work, modifiers need to have been added with human.addModifier(...)\n\n            // in apps/gui/guimodifier.py loadModifierTaskViews\n\n            // class Modifier has getMin() & getMax() to get the range\n            const human = Human.getInstance()\n            const modifier = human.getModifier(modifierSpec.mod)\n            if (modifier !== undefined) {\n                this.model = modifier.getModel()\n                this.model.modified.add(() => {\n                    // modifier.setValue(this.model!.value)\n                    modifier.updateValue(this.model!.value)\n                    // self.modifier.updateValue(value, G.app.getSetting('realtimeNormalUpdates'))\n                    human.updateProxyMesh(true)\n                })\n            // } else {\n            //     console.log(`SliderNode(): no modifier '${modifierSpec.mod}' found for slider`)\n            }\n        }\n    }\n}\n\nfunction capitalize(s: string): string {\n    return s[0].toUpperCase() + s.slice(1)\n}\n\nexport function labelFromModifier(groupName: string, name: string): string {\n    const tlabel = name.split('-')\n\n    if (tlabel[tlabel.length - 1].indexOf('|') !== -1)\n        tlabel.pop()\n\n    if (tlabel.length > 1 && tlabel[0] === groupName)\n        tlabel.shift()\n\n    tlabel[0] = capitalize(tlabel[0])\n\n    return tlabel.join(' ')\n}\n\n/*\n * loadSliders() loads data/modifiers/modeling_sliders.json, which contains the ui tree\n * listing containing the \"Main\", \"Gender\", \"Face\", \"Torso\", \"Arms and legs\" tabs, containing\n * a slider for each modifier.\n *\n * (the original is located in apps/gui/guimodifier.py)\n */\nexport function loadSliders(filename: string): SliderNode {\n    const root = parseSliders(\n        FileSystemAdapter.getInstance().readFile(filename),\n        filename)\n    console.log(`Loaded ${SliderNode.count} slider nodes from file ${filename}`)\n    return root\n}\n\nexport function parseSliders(data: string, filename = 'memory'): SliderNode {\n    const json = JSON.parse(data)\n    let rootNode: SliderNode | undefined\n    let lastTabNode: SliderNode | undefined\n    for (const [tabKey, tabValue] of Object.entries(json).sort(\n        (a: [string, any], b: [string, any]): number => a[1].sortOrder - b[1].sortOrder)\n    ) {\n        const tab = tabValue as Category\n\n        let label = tabKey\n        if (tab.label !== undefined)\n            label = tab.label\n\n        const tabNode = new SliderNode(label)\n        tabNode.category = tab\n        if (lastTabNode)\n            lastTabNode.next = tabNode\n        else\n            rootNode = tabNode\n        lastTabNode = tabNode\n\n        let lastCategoryNode: SliderNode | undefined\n        for (const [categoryKey, categoryValue] of Object.entries(tab.modifiers)) {\n            const categoryNode = new SliderNode(capitalize(categoryKey))\n            if (lastCategoryNode)\n                lastCategoryNode.next = categoryNode\n            else\n                lastTabNode.down = categoryNode\n            lastCategoryNode = categoryNode\n            let lastSliderNode: SliderNode | undefined\n            for (const modifier of categoryValue as ModifierSpec[]) {\n                let label = modifier.label\n                if (label === undefined) {\n                    const name = modifier.mod.split('/')\n                    label = labelFromModifier(name[0], name[1])\n                }\n                const sliderNode = new SliderNode(label, modifier)\n                if (lastSliderNode)\n                    lastSliderNode.next = sliderNode\n                else\n                    lastCategoryNode.down = sliderNode\n                lastSliderNode = sliderNode\n            }\n        }\n    }\n    if (rootNode === undefined)\n        throw Error('No sliders found.')\n    return rootNode\n}\n","export class Group {\n    name: string\n    startIndex: number\n    length: number\n    constructor(name: string, start: number) {\n        this.name = name\n        this.startIndex = start\n        this.length = 0\n    }\n}\n\nexport abstract class Mesh {\n    abstract vertex: number[]\n    abstract indices: number[]\n    abstract groups: Group[]\n    abstract getFaceGroup(name: string): Group | undefined\n}\n\n// core/module3d.py\n// line 940: createFaceGroup\n// line 1084: getFaceGroup\n\n// line 47\nexport interface FaceGroup {\n    // object\n    name: string\n    idx: number\n    // color\n    // colorID\n}","import { StringToLine } from '../lib/StringToLine'\nimport { FileSystemAdapter } from '../filesystem/FileSystemAdapter'\nimport { Mesh, Group, FaceGroup } from './Mesh'\n\n// makehuman/shared/wavefront.py\nexport class WavefrontObj implements Mesh {\n    name = \"\"\n    vertex: number[]\n    indices: number[]\n    groups: Group[] // name, startIndex, length\n\n    faceGroups = new Map<string, FaceGroup>()\n\n    constructor() {\n        this.vertex = new Array<number>()\n        this.indices = new Array<number>()\n        this.groups = new Array<Group>()\n    }\n\n    load(filename: string) {\n        const data = FileSystemAdapter.getInstance().readFile(filename)\n        const vertex = new Array<number>()\n        const indices = new Array<number>()\n        // const primitives = new Array<any>()\n        const group = new Map<string, number>()\n        const reader = new StringToLine(data)\n        //  const reader = readline.createInterface(input)\n        let lineNumber = 0\n        for (let line of reader) {\n            ++lineNumber\n            // console.log(line)\n            line = line.trim()\n            if (line.length === 0)\n                continue\n            if (line[0] === '#') {\n                // TODO: might want to parse # basemesh <name>\n                continue\n            }\n            const tokens = line.split(/\\s+/)\n            switch(tokens[0]) {\n            // vertex data\n            case 'v': // vertex X Y Z [W]\n                if (tokens.length < 4)\n                    throw Error(`Too few arguments in ${line}`)\n                if (tokens.length > 5)\n                    throw Error(`Too many arguments in ${line}`)\n                vertex.push(parseFloat(tokens[1]))\n                vertex.push(parseFloat(tokens[2]))\n                vertex.push(parseFloat(tokens[3]))\n                if (tokens.length === 5)\n                    throw Error('Can\\'t handle vertex with weight yet...')\n                    //     vertex.push(parseFloat(tokens[4]))\n                    // else\n                    //     vertex.push(1)\n                break\n            case 'vt': // vectex texture U V W\n                // ignored for now\n                break\n            case 'vn': break // vertex normal I J K\n            case 'vp': break // vertext parameter space U V W\n\n                // free-form curve/surface attributes\n            case 'deg': break\n            case 'bmat': break\n            case 'step': break\n            case 'cstype': break\n\n                // elements\n            case 'p': break // point\n            case 'l': break // line\n            case 'f': // face( vertex[/[texture][/normal]])+\n                if (tokens.length !== 5)\n                    throw Error(`can't handle faces which are not quads yet (line ${lineNumber}: '${line}'}`)\n                    // CONVERT QUAD INTO TRIANGLE FOR WEBGL\n                    // 0   1\n                    //\n                    // 3   2\n                for(let i=1; i<tokens.length; ++i) {\n                    const split = tokens[i].split('/')\n                    indices.push(parseInt(split[0], 10)-1)\n                }\n                const idx = indices.length - 4\n                indices.push(indices[idx+0])\n                indices.push(indices[idx+2])\n                break\n            case 'curv': break // curve\n            case 'curv2': break // 2d curve\n            case 'surf': break // surface\n\n                // free-form curve/surface body statements\n            case 'parm': break\n            case 'trim': break\n            case 'hole': break\n            case 'scrv': break\n            case 'sp': break\n            case 'end': break\n\n                // connectivity between free-form surfaces\n            case 'con': break\n\n                // grouping\n            case 'g': // <groupname>+ the following elements belong to that group    \n                this.groups.push(new Group(tokens[1], indices.length))\n                break\n            case 's': break\n            case 'mg': break\n            case 'o': // <object name>\n                this.name = tokens[1]\n                break\n\n                // display/render attributes\n            case 'bevel': break\n            case 'c_interp': break\n            case 'd_interp': break\n            case 'lod': break\n            case 'usemtl': // <materialname>\n                break\n            case 'mtllib': break\n            case 'shadow_obj': break\n            case 'trace_obj': break\n            case 'ctech': break\n            case 'stech': break\n\n            default:\n                throw Error(`Unknown keyword '${tokens[0]}' in Wavefront OBJ file in line '${line}' of length ${line.length}'.`)\n            }\n        }\n        this.vertex = vertex\n        this.indices = indices\n\n        // set group's lengths\n        if (this.groups.length > 0) {\n            for(let i=0; i<this.groups.length-1; ++i) {\n                this.groups[i].length = this.groups[i+1].startIndex - this.groups[i].startIndex\n            }\n            this.groups[this.groups.length-1].length = indices.length - this.groups[this.groups.length-1].startIndex\n        }\n\n        this.logStatistics(filename)\n    }\n\n    getFaceGroup(name: string): Group | undefined {\n        // the facegroups are not groups\n        // and they might be either stored in one of these:\n        //   makehuman/data/rigs/default_weights.mhw\n        //   makehuman/data/poses/benchmark.bvh\n        //   makehuman/data/poses/tpose.bvh\n        //   makehuman/data/poseunits/face-poseunits.bvh\n        // or maybe the code i have here is correct but the weight must be read as part of the rig?\n\n        // return undefined\n        const x = this.groups\n            .filter( g => g.name === name)\n        if (x.length !== 1) {\n            return undefined\n        }\n        return x[0]\n    }\n\n    logStatistics(filename: string) {\n        let groupNames=\"\"\n        let joints = 0\n        let helpers = 0\n        this.groups.forEach(g => {\n            if (g.name.startsWith(\"joint-\")) {\n                ++joints\n            } else\n            if (g.name.startsWith(\"helper-\")) {\n                ++helpers\n            } else {\n                if (groupNames.length === 0) {\n                    groupNames = g.name\n                } else {\n                    groupNames=`${groupNames}, ${g.name}`\n                }\n            }\n        })\n        console.log(`Loaded ${this.groups.length} groups (${joints} joints, ${helpers} helpers and ${groupNames}), ${this.vertex.length/3} vertices, ${this.indices.length/3} triangles from file '${filename}'`)\n    }\n}\n","import { Mode } from 'Mode'\nimport { Proxy, loadProxy } from 'proxy/Proxy'\nimport { Human } from '../Human'\nimport { getTarget } from '../target/TargetFactory'\nimport { Mesh, Group } from './Mesh'\nimport { WavefrontObj } from './WavefrontObj'\n\nlet epsilon = 0.000000001\n\nexport function isZero(a: number): boolean {\n    return Math.abs(a) <= epsilon\n}\n\n// FIXME: the name doesn't tell enough, alternatives(?): HowMuchToUpdate, WhatsChanged, ChangeType, ModelChangeExtend...\nexport enum Update {\n    NONE,\n    MORPH,\n    POSE\n}\n\nexport class HumanMesh {\n    human: Human\n    obj: Mesh\n    origVertex: number[]\n    vertex: number[]\n    indices: number[]\n    groups: Group[]\n    mode!: Mode\n    proxy?: Proxy\n    proxyMesh?: WavefrontObj\n\n    updateRequired = Update.NONE\n\n    constructor(human: Human, obj: WavefrontObj) {\n        this.human = human\n        this.obj = obj\n        this.vertex = this.origVertex = obj.vertex\n        this.indices = obj.indices\n        this.groups = obj.groups\n\n        human.meshData = obj // UGLY\n\n        // this.proxy = loadProxy(human, \"data/proxymeshes/proxy741/proxy741.proxy\", \"Proxymeshes\")\n        // this.proxy = loadProxy(human, \"data/proxymeshes/female_generic/female_generic.proxy\", \"Proxymeshes\")\n        // this.proxyMesh = this.proxy.loadMeshAndObject(human)\n    }\n\n    update(): void {\n        if (this.updateRequired === Update.NONE) {\n            return\n        }\n\n        // if (this.updateRequired === Update.MORPH) {\n            // morph\n            this.vertex = [...this.origVertex]\n            this.human.targetsDetailStack.forEach((value, targetName) => {\n                if (isNaN(value)) {\n                    // console.log(`HumanMesh.update(): ignoring target ${targetName} with value NaN`)\n                    return\n                }\n\n                if (isZero(value) || isNaN(value))\n                    return\n                // console.log(`HumanMesh.update(): apply target ${targetName} with value ${value}`)\n                const target = getTarget(targetName)\n                target.apply(this.vertex, value)\n            })\n\n            const tmp = this.obj.vertex\n            this.obj.vertex = this.vertex\n\n            this.human.__skeleton.updateJoints(this.human)\n            this.human.__skeleton.build()\n            this.human.__skeleton.update()\n\n            this.obj.vertex = tmp\n        // }\n\n        // skin\n        this.vertex = this.human.__skeleton.skinMesh(this.vertex, this.human.__skeleton.vertexWeights!._data)\n        console.log(`HumanMesh.update(): skinMesh, ${this.vertex.length}`)\n\n        // if (this.proxy !== undefined) {\n            // this.vertex = this.proxy.getCoords(this.vertex)\n            // this.vertex = this.proxyMesh!.vertex\n            // this.indices = this.proxyMesh!.indices\n        //     console.log(`HumanMesh.update(): proxy, ${this.vertex.length}`)\n        // }\n\n        this.updateRequired = Update.NONE\n    }\n}\n","export enum Mode {\n    MORPH,\n    POSE\n}\n","// DEFLATE is a complex format; to read this code, you should probably check the RFC first:\n// https://tools.ietf.org/html/rfc1951\n// You may also wish to take a look at the guide I made about this program:\n// https://gist.github.com/101arrowz/253f31eb5abc3d9275ab943003ffecad\n// Some of the following code is similar to that of UZIP.js:\n// https://github.com/photopea/UZIP.js\n// However, the vast majority of the codebase has diverged from UZIP.js to increase performance and reduce bundle size.\n// Sometimes 0 will appear where -1 would be more appropriate. This is because using a uint\n// is better for memory in most engines (I *think*).\nvar ch2 = {};\nvar wk = (function (c, id, msg, transfer, cb) {\n    var w = new Worker(ch2[id] || (ch2[id] = URL.createObjectURL(new Blob([\n        c + ';addEventListener(\"error\",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'\n    ], { type: 'text/javascript' }))));\n    w.onmessage = function (e) {\n        var d = e.data, ed = d.$e$;\n        if (ed) {\n            var err = new Error(ed[0]);\n            err['code'] = ed[1];\n            err.stack = ed[2];\n            cb(err, null);\n        }\n        else\n            cb(null, d);\n    };\n    w.postMessage(msg, transfer);\n    return w;\n});\n\n// aliases for shorter compressed code (most minifers don't do this)\nvar u8 = Uint8Array, u16 = Uint16Array, u32 = Uint32Array;\n// fixed length extra bits\nvar fleb = new u8([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0, /* unused */ 0, 0, /* impossible */ 0]);\n// fixed distance extra bits\n// see fleb note\nvar fdeb = new u8([0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13, /* unused */ 0, 0]);\n// code length index map\nvar clim = new u8([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]);\n// get base, reverse index map from extra bits\nvar freb = function (eb, start) {\n    var b = new u16(31);\n    for (var i = 0; i < 31; ++i) {\n        b[i] = start += 1 << eb[i - 1];\n    }\n    // numbers here are at max 18 bits\n    var r = new u32(b[30]);\n    for (var i = 1; i < 30; ++i) {\n        for (var j = b[i]; j < b[i + 1]; ++j) {\n            r[j] = ((j - b[i]) << 5) | i;\n        }\n    }\n    return [b, r];\n};\nvar _a = freb(fleb, 2), fl = _a[0], revfl = _a[1];\n// we can ignore the fact that the other numbers are wrong; they never happen anyway\nfl[28] = 258, revfl[258] = 28;\nvar _b = freb(fdeb, 0), fd = _b[0], revfd = _b[1];\n// map of value to reverse (assuming 16 bits)\nvar rev = new u16(32768);\nfor (var i = 0; i < 32768; ++i) {\n    // reverse table algorithm from SO\n    var x = ((i & 0xAAAA) >>> 1) | ((i & 0x5555) << 1);\n    x = ((x & 0xCCCC) >>> 2) | ((x & 0x3333) << 2);\n    x = ((x & 0xF0F0) >>> 4) | ((x & 0x0F0F) << 4);\n    rev[i] = (((x & 0xFF00) >>> 8) | ((x & 0x00FF) << 8)) >>> 1;\n}\n// create huffman tree from u8 \"map\": index -> code length for code index\n// mb (max bits) must be at most 15\n// TODO: optimize/split up?\nvar hMap = (function (cd, mb, r) {\n    var s = cd.length;\n    // index\n    var i = 0;\n    // u16 \"map\": index -> # of codes with bit length = index\n    var l = new u16(mb);\n    // length of cd must be 288 (total # of codes)\n    for (; i < s; ++i) {\n        if (cd[i])\n            ++l[cd[i] - 1];\n    }\n    // u16 \"map\": index -> minimum code for bit length = index\n    var le = new u16(mb);\n    for (i = 0; i < mb; ++i) {\n        le[i] = (le[i - 1] + l[i - 1]) << 1;\n    }\n    var co;\n    if (r) {\n        // u16 \"map\": index -> number of actual bits, symbol for code\n        co = new u16(1 << mb);\n        // bits to remove for reverser\n        var rvb = 15 - mb;\n        for (i = 0; i < s; ++i) {\n            // ignore 0 lengths\n            if (cd[i]) {\n                // num encoding both symbol and bits read\n                var sv = (i << 4) | cd[i];\n                // free bits\n                var r_1 = mb - cd[i];\n                // start value\n                var v = le[cd[i] - 1]++ << r_1;\n                // m is end value\n                for (var m = v | ((1 << r_1) - 1); v <= m; ++v) {\n                    // every 16 bit value starting with the code yields the same result\n                    co[rev[v] >>> rvb] = sv;\n                }\n            }\n        }\n    }\n    else {\n        co = new u16(s);\n        for (i = 0; i < s; ++i) {\n            if (cd[i]) {\n                co[i] = rev[le[cd[i] - 1]++] >>> (15 - cd[i]);\n            }\n        }\n    }\n    return co;\n});\n// fixed length tree\nvar flt = new u8(288);\nfor (var i = 0; i < 144; ++i)\n    flt[i] = 8;\nfor (var i = 144; i < 256; ++i)\n    flt[i] = 9;\nfor (var i = 256; i < 280; ++i)\n    flt[i] = 7;\nfor (var i = 280; i < 288; ++i)\n    flt[i] = 8;\n// fixed distance tree\nvar fdt = new u8(32);\nfor (var i = 0; i < 32; ++i)\n    fdt[i] = 5;\n// fixed length map\nvar flm = /*#__PURE__*/ hMap(flt, 9, 0), flrm = /*#__PURE__*/ hMap(flt, 9, 1);\n// fixed distance map\nvar fdm = /*#__PURE__*/ hMap(fdt, 5, 0), fdrm = /*#__PURE__*/ hMap(fdt, 5, 1);\n// find max of array\nvar max = function (a) {\n    var m = a[0];\n    for (var i = 1; i < a.length; ++i) {\n        if (a[i] > m)\n            m = a[i];\n    }\n    return m;\n};\n// read d, starting at bit p and mask with m\nvar bits = function (d, p, m) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8)) >> (p & 7)) & m;\n};\n// read d, starting at bit p continuing for at least 16 bits\nvar bits16 = function (d, p) {\n    var o = (p / 8) | 0;\n    return ((d[o] | (d[o + 1] << 8) | (d[o + 2] << 16)) >> (p & 7));\n};\n// get end of byte\nvar shft = function (p) { return ((p + 7) / 8) | 0; };\n// typed array slice - allows garbage collector to free original reference,\n// while being more compatible than .slice\nvar slc = function (v, s, e) {\n    if (s == null || s < 0)\n        s = 0;\n    if (e == null || e > v.length)\n        e = v.length;\n    // can't use .constructor in case user-supplied\n    var n = new (v.BYTES_PER_ELEMENT == 2 ? u16 : v.BYTES_PER_ELEMENT == 4 ? u32 : u8)(e - s);\n    n.set(v.subarray(s, e));\n    return n;\n};\n/**\n * Codes for errors generated within this library\n */\nexport var FlateErrorCode = {\n    UnexpectedEOF: 0,\n    InvalidBlockType: 1,\n    InvalidLengthLiteral: 2,\n    InvalidDistance: 3,\n    StreamFinished: 4,\n    NoStreamHandler: 5,\n    InvalidHeader: 6,\n    NoCallback: 7,\n    InvalidUTF8: 8,\n    ExtraFieldTooLong: 9,\n    InvalidDate: 10,\n    FilenameTooLong: 11,\n    StreamFinishing: 12,\n    InvalidZipData: 13,\n    UnknownCompressionMethod: 14\n};\n// error codes\nvar ec = [\n    'unexpected EOF',\n    'invalid block type',\n    'invalid length/literal',\n    'invalid distance',\n    'stream finished',\n    'no stream handler',\n    ,\n    'no callback',\n    'invalid UTF-8 data',\n    'extra field too long',\n    'date not in range 1980-2099',\n    'filename too long',\n    'stream finishing',\n    'invalid zip data'\n    // determined by unknown compression method\n];\n;\nvar err = function (ind, msg, nt) {\n    var e = new Error(msg || ec[ind]);\n    e.code = ind;\n    if (Error.captureStackTrace)\n        Error.captureStackTrace(e, err);\n    if (!nt)\n        throw e;\n    return e;\n};\n// expands raw DEFLATE data\nvar inflt = function (dat, buf, st) {\n    // source length\n    var sl = dat.length;\n    if (!sl || (st && st.f && !st.l))\n        return buf || new u8(0);\n    // have to estimate size\n    var noBuf = !buf || st;\n    // no state\n    var noSt = !st || st.i;\n    if (!st)\n        st = {};\n    // Assumes roughly 33% compression ratio average\n    if (!buf)\n        buf = new u8(sl * 3);\n    // ensure buffer can fit at least l elements\n    var cbuf = function (l) {\n        var bl = buf.length;\n        // need to increase size to fit\n        if (l > bl) {\n            // Double or set to necessary, whichever is greater\n            var nbuf = new u8(Math.max(bl * 2, l));\n            nbuf.set(buf);\n            buf = nbuf;\n        }\n    };\n    //  last chunk         bitpos           bytes\n    var final = st.f || 0, pos = st.p || 0, bt = st.b || 0, lm = st.l, dm = st.d, lbt = st.m, dbt = st.n;\n    // total bits\n    var tbts = sl * 8;\n    do {\n        if (!lm) {\n            // BFINAL - this is only 1 when last chunk is next\n            final = bits(dat, pos, 1);\n            // type: 0 = no compression, 1 = fixed huffman, 2 = dynamic huffman\n            var type = bits(dat, pos + 1, 3);\n            pos += 3;\n            if (!type) {\n                // go to end of byte boundary\n                var s = shft(pos) + 4, l = dat[s - 4] | (dat[s - 3] << 8), t = s + l;\n                if (t > sl) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                // ensure size\n                if (noBuf)\n                    cbuf(bt + l);\n                // Copy over uncompressed data\n                buf.set(dat.subarray(s, t), bt);\n                // Get new bitpos, update byte count\n                st.b = bt += l, st.p = pos = t * 8, st.f = final;\n                continue;\n            }\n            else if (type == 1)\n                lm = flrm, dm = fdrm, lbt = 9, dbt = 5;\n            else if (type == 2) {\n                //  literal                            lengths\n                var hLit = bits(dat, pos, 31) + 257, hcLen = bits(dat, pos + 10, 15) + 4;\n                var tl = hLit + bits(dat, pos + 5, 31) + 1;\n                pos += 14;\n                // length+distance tree\n                var ldt = new u8(tl);\n                // code length tree\n                var clt = new u8(19);\n                for (var i = 0; i < hcLen; ++i) {\n                    // use index map to get real code\n                    clt[clim[i]] = bits(dat, pos + i * 3, 7);\n                }\n                pos += hcLen * 3;\n                // code lengths bits\n                var clb = max(clt), clbmsk = (1 << clb) - 1;\n                // code lengths map\n                var clm = hMap(clt, clb, 1);\n                for (var i = 0; i < tl;) {\n                    var r = clm[bits(dat, pos, clbmsk)];\n                    // bits read\n                    pos += r & 15;\n                    // symbol\n                    var s = r >>> 4;\n                    // code length to copy\n                    if (s < 16) {\n                        ldt[i++] = s;\n                    }\n                    else {\n                        //  copy   count\n                        var c = 0, n = 0;\n                        if (s == 16)\n                            n = 3 + bits(dat, pos, 3), pos += 2, c = ldt[i - 1];\n                        else if (s == 17)\n                            n = 3 + bits(dat, pos, 7), pos += 3;\n                        else if (s == 18)\n                            n = 11 + bits(dat, pos, 127), pos += 7;\n                        while (n--)\n                            ldt[i++] = c;\n                    }\n                }\n                //    length tree                 distance tree\n                var lt = ldt.subarray(0, hLit), dt = ldt.subarray(hLit);\n                // max length bits\n                lbt = max(lt);\n                // max dist bits\n                dbt = max(dt);\n                lm = hMap(lt, lbt, 1);\n                dm = hMap(dt, dbt, 1);\n            }\n            else\n                err(1);\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n        }\n        // Make sure the buffer can hold this + the largest possible addition\n        // Maximum chunk size (practically, theoretically infinite) is 2^17;\n        if (noBuf)\n            cbuf(bt + 131072);\n        var lms = (1 << lbt) - 1, dms = (1 << dbt) - 1;\n        var lpos = pos;\n        for (;; lpos = pos) {\n            // bits read, code\n            var c = lm[bits16(dat, pos) & lms], sym = c >>> 4;\n            pos += c & 15;\n            if (pos > tbts) {\n                if (noSt)\n                    err(0);\n                break;\n            }\n            if (!c)\n                err(2);\n            if (sym < 256)\n                buf[bt++] = sym;\n            else if (sym == 256) {\n                lpos = pos, lm = null;\n                break;\n            }\n            else {\n                var add = sym - 254;\n                // no extra bits needed if less\n                if (sym > 264) {\n                    // index\n                    var i = sym - 257, b = fleb[i];\n                    add = bits(dat, pos, (1 << b) - 1) + fl[i];\n                    pos += b;\n                }\n                // dist\n                var d = dm[bits16(dat, pos) & dms], dsym = d >>> 4;\n                if (!d)\n                    err(3);\n                pos += d & 15;\n                var dt = fd[dsym];\n                if (dsym > 3) {\n                    var b = fdeb[dsym];\n                    dt += bits16(dat, pos) & ((1 << b) - 1), pos += b;\n                }\n                if (pos > tbts) {\n                    if (noSt)\n                        err(0);\n                    break;\n                }\n                if (noBuf)\n                    cbuf(bt + 131072);\n                var end = bt + add;\n                for (; bt < end; bt += 4) {\n                    buf[bt] = buf[bt - dt];\n                    buf[bt + 1] = buf[bt + 1 - dt];\n                    buf[bt + 2] = buf[bt + 2 - dt];\n                    buf[bt + 3] = buf[bt + 3 - dt];\n                }\n                bt = end;\n            }\n        }\n        st.l = lm, st.p = lpos, st.b = bt, st.f = final;\n        if (lm)\n            final = 1, st.m = lbt, st.d = dm, st.n = dbt;\n    } while (!final);\n    return bt == buf.length ? buf : slc(buf, 0, bt);\n};\n// starting at p, write the minimum number of bits that can hold v to d\nvar wbits = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n};\n// starting at p, write the minimum number of bits (>8) that can hold v to d\nvar wbits16 = function (d, p, v) {\n    v <<= p & 7;\n    var o = (p / 8) | 0;\n    d[o] |= v;\n    d[o + 1] |= v >>> 8;\n    d[o + 2] |= v >>> 16;\n};\n// creates code lengths from a frequency table\nvar hTree = function (d, mb) {\n    // Need extra info to make a tree\n    var t = [];\n    for (var i = 0; i < d.length; ++i) {\n        if (d[i])\n            t.push({ s: i, f: d[i] });\n    }\n    var s = t.length;\n    var t2 = t.slice();\n    if (!s)\n        return [et, 0];\n    if (s == 1) {\n        var v = new u8(t[0].s + 1);\n        v[t[0].s] = 1;\n        return [v, 1];\n    }\n    t.sort(function (a, b) { return a.f - b.f; });\n    // after i2 reaches last ind, will be stopped\n    // freq must be greater than largest possible number of symbols\n    t.push({ s: -1, f: 25001 });\n    var l = t[0], r = t[1], i0 = 0, i1 = 1, i2 = 2;\n    t[0] = { s: -1, f: l.f + r.f, l: l, r: r };\n    // efficient algorithm from UZIP.js\n    // i0 is lookbehind, i2 is lookahead - after processing two low-freq\n    // symbols that combined have high freq, will start processing i2 (high-freq,\n    // non-composite) symbols instead\n    // see https://reddit.com/r/photopea/comments/ikekht/uzipjs_questions/\n    while (i1 != s - 1) {\n        l = t[t[i0].f < t[i2].f ? i0++ : i2++];\n        r = t[i0 != i1 && t[i0].f < t[i2].f ? i0++ : i2++];\n        t[i1++] = { s: -1, f: l.f + r.f, l: l, r: r };\n    }\n    var maxSym = t2[0].s;\n    for (var i = 1; i < s; ++i) {\n        if (t2[i].s > maxSym)\n            maxSym = t2[i].s;\n    }\n    // code lengths\n    var tr = new u16(maxSym + 1);\n    // max bits in tree\n    var mbt = ln(t[i1 - 1], tr, 0);\n    if (mbt > mb) {\n        // more algorithms from UZIP.js\n        // TODO: find out how this code works (debt)\n        //  ind    debt\n        var i = 0, dt = 0;\n        //    left            cost\n        var lft = mbt - mb, cst = 1 << lft;\n        t2.sort(function (a, b) { return tr[b.s] - tr[a.s] || a.f - b.f; });\n        for (; i < s; ++i) {\n            var i2_1 = t2[i].s;\n            if (tr[i2_1] > mb) {\n                dt += cst - (1 << (mbt - tr[i2_1]));\n                tr[i2_1] = mb;\n            }\n            else\n                break;\n        }\n        dt >>>= lft;\n        while (dt > 0) {\n            var i2_2 = t2[i].s;\n            if (tr[i2_2] < mb)\n                dt -= 1 << (mb - tr[i2_2]++ - 1);\n            else\n                ++i;\n        }\n        for (; i >= 0 && dt; --i) {\n            var i2_3 = t2[i].s;\n            if (tr[i2_3] == mb) {\n                --tr[i2_3];\n                ++dt;\n            }\n        }\n        mbt = mb;\n    }\n    return [new u8(tr), mbt];\n};\n// get the max length and assign length codes\nvar ln = function (n, l, d) {\n    return n.s == -1\n        ? Math.max(ln(n.l, l, d + 1), ln(n.r, l, d + 1))\n        : (l[n.s] = d);\n};\n// length codes generation\nvar lc = function (c) {\n    var s = c.length;\n    // Note that the semicolon was intentional\n    while (s && !c[--s])\n        ;\n    var cl = new u16(++s);\n    //  ind      num         streak\n    var cli = 0, cln = c[0], cls = 1;\n    var w = function (v) { cl[cli++] = v; };\n    for (var i = 1; i <= s; ++i) {\n        if (c[i] == cln && i != s)\n            ++cls;\n        else {\n            if (!cln && cls > 2) {\n                for (; cls > 138; cls -= 138)\n                    w(32754);\n                if (cls > 2) {\n                    w(cls > 10 ? ((cls - 11) << 5) | 28690 : ((cls - 3) << 5) | 12305);\n                    cls = 0;\n                }\n            }\n            else if (cls > 3) {\n                w(cln), --cls;\n                for (; cls > 6; cls -= 6)\n                    w(8304);\n                if (cls > 2)\n                    w(((cls - 3) << 5) | 8208), cls = 0;\n            }\n            while (cls--)\n                w(cln);\n            cls = 1;\n            cln = c[i];\n        }\n    }\n    return [cl.subarray(0, cli), s];\n};\n// calculate the length of output from tree, code lengths\nvar clen = function (cf, cl) {\n    var l = 0;\n    for (var i = 0; i < cl.length; ++i)\n        l += cf[i] * cl[i];\n    return l;\n};\n// writes a fixed block\n// returns the new bit pos\nvar wfblk = function (out, pos, dat) {\n    // no need to write 00 as type: TypedArray defaults to 0\n    var s = dat.length;\n    var o = shft(pos + 2);\n    out[o] = s & 255;\n    out[o + 1] = s >>> 8;\n    out[o + 2] = out[o] ^ 255;\n    out[o + 3] = out[o + 1] ^ 255;\n    for (var i = 0; i < s; ++i)\n        out[o + i + 4] = dat[i];\n    return (o + 4 + s) * 8;\n};\n// writes a block\nvar wblk = function (dat, out, final, syms, lf, df, eb, li, bs, bl, p) {\n    wbits(out, p++, final);\n    ++lf[256];\n    var _a = hTree(lf, 15), dlt = _a[0], mlb = _a[1];\n    var _b = hTree(df, 15), ddt = _b[0], mdb = _b[1];\n    var _c = lc(dlt), lclt = _c[0], nlc = _c[1];\n    var _d = lc(ddt), lcdt = _d[0], ndc = _d[1];\n    var lcfreq = new u16(19);\n    for (var i = 0; i < lclt.length; ++i)\n        lcfreq[lclt[i] & 31]++;\n    for (var i = 0; i < lcdt.length; ++i)\n        lcfreq[lcdt[i] & 31]++;\n    var _e = hTree(lcfreq, 7), lct = _e[0], mlcb = _e[1];\n    var nlcc = 19;\n    for (; nlcc > 4 && !lct[clim[nlcc - 1]]; --nlcc)\n        ;\n    var flen = (bl + 5) << 3;\n    var ftlen = clen(lf, flt) + clen(df, fdt) + eb;\n    var dtlen = clen(lf, dlt) + clen(df, ddt) + eb + 14 + 3 * nlcc + clen(lcfreq, lct) + (2 * lcfreq[16] + 3 * lcfreq[17] + 7 * lcfreq[18]);\n    if (flen <= ftlen && flen <= dtlen)\n        return wfblk(out, p, dat.subarray(bs, bs + bl));\n    var lm, ll, dm, dl;\n    wbits(out, p, 1 + (dtlen < ftlen)), p += 2;\n    if (dtlen < ftlen) {\n        lm = hMap(dlt, mlb, 0), ll = dlt, dm = hMap(ddt, mdb, 0), dl = ddt;\n        var llm = hMap(lct, mlcb, 0);\n        wbits(out, p, nlc - 257);\n        wbits(out, p + 5, ndc - 1);\n        wbits(out, p + 10, nlcc - 4);\n        p += 14;\n        for (var i = 0; i < nlcc; ++i)\n            wbits(out, p + 3 * i, lct[clim[i]]);\n        p += 3 * nlcc;\n        var lcts = [lclt, lcdt];\n        for (var it = 0; it < 2; ++it) {\n            var clct = lcts[it];\n            for (var i = 0; i < clct.length; ++i) {\n                var len = clct[i] & 31;\n                wbits(out, p, llm[len]), p += lct[len];\n                if (len > 15)\n                    wbits(out, p, (clct[i] >>> 5) & 127), p += clct[i] >>> 12;\n            }\n        }\n    }\n    else {\n        lm = flm, ll = flt, dm = fdm, dl = fdt;\n    }\n    for (var i = 0; i < li; ++i) {\n        if (syms[i] > 255) {\n            var len = (syms[i] >>> 18) & 31;\n            wbits16(out, p, lm[len + 257]), p += ll[len + 257];\n            if (len > 7)\n                wbits(out, p, (syms[i] >>> 23) & 31), p += fleb[len];\n            var dst = syms[i] & 31;\n            wbits16(out, p, dm[dst]), p += dl[dst];\n            if (dst > 3)\n                wbits16(out, p, (syms[i] >>> 5) & 8191), p += fdeb[dst];\n        }\n        else {\n            wbits16(out, p, lm[syms[i]]), p += ll[syms[i]];\n        }\n    }\n    wbits16(out, p, lm[256]);\n    return p + ll[256];\n};\n// deflate options (nice << 13) | chain\nvar deo = /*#__PURE__*/ new u32([65540, 131080, 131088, 131104, 262176, 1048704, 1048832, 2114560, 2117632]);\n// empty\nvar et = /*#__PURE__*/ new u8(0);\n// compresses data into a raw DEFLATE buffer\nvar dflt = function (dat, lvl, plvl, pre, post, lst) {\n    var s = dat.length;\n    var o = new u8(pre + s + 5 * (1 + Math.ceil(s / 7000)) + post);\n    // writing to this writes to the output buffer\n    var w = o.subarray(pre, o.length - post);\n    var pos = 0;\n    if (!lvl || s < 8) {\n        for (var i = 0; i <= s; i += 65535) {\n            // end\n            var e = i + 65535;\n            if (e >= s) {\n                // write final block\n                w[pos >> 3] = lst;\n            }\n            pos = wfblk(w, pos + 1, dat.subarray(i, e));\n        }\n    }\n    else {\n        var opt = deo[lvl - 1];\n        var n = opt >>> 13, c = opt & 8191;\n        var msk_1 = (1 << plvl) - 1;\n        //    prev 2-byte val map    curr 2-byte val map\n        var prev = new u16(32768), head = new u16(msk_1 + 1);\n        var bs1_1 = Math.ceil(plvl / 3), bs2_1 = 2 * bs1_1;\n        var hsh = function (i) { return (dat[i] ^ (dat[i + 1] << bs1_1) ^ (dat[i + 2] << bs2_1)) & msk_1; };\n        // 24576 is an arbitrary number of maximum symbols per block\n        // 424 buffer for last block\n        var syms = new u32(25000);\n        // length/literal freq   distance freq\n        var lf = new u16(288), df = new u16(32);\n        //  l/lcnt  exbits  index  l/lind  waitdx  bitpos\n        var lc_1 = 0, eb = 0, i = 0, li = 0, wi = 0, bs = 0;\n        for (; i < s; ++i) {\n            // hash value\n            // deopt when i > s - 3 - at end, deopt acceptable\n            var hv = hsh(i);\n            // index mod 32768    previous index mod\n            var imod = i & 32767, pimod = head[hv];\n            prev[imod] = pimod;\n            head[hv] = imod;\n            // We always should modify head and prev, but only add symbols if\n            // this data is not yet processed (\"wait\" for wait index)\n            if (wi <= i) {\n                // bytes remaining\n                var rem = s - i;\n                if ((lc_1 > 7000 || li > 24576) && rem > 423) {\n                    pos = wblk(dat, w, 0, syms, lf, df, eb, li, bs, i - bs, pos);\n                    li = lc_1 = eb = 0, bs = i;\n                    for (var j = 0; j < 286; ++j)\n                        lf[j] = 0;\n                    for (var j = 0; j < 30; ++j)\n                        df[j] = 0;\n                }\n                //  len    dist   chain\n                var l = 2, d = 0, ch_1 = c, dif = (imod - pimod) & 32767;\n                if (rem > 2 && hv == hsh(i - dif)) {\n                    var maxn = Math.min(n, rem) - 1;\n                    var maxd = Math.min(32767, i);\n                    // max possible length\n                    // not capped at dif because decompressors implement \"rolling\" index population\n                    var ml = Math.min(258, rem);\n                    while (dif <= maxd && --ch_1 && imod != pimod) {\n                        if (dat[i + l] == dat[i + l - dif]) {\n                            var nl = 0;\n                            for (; nl < ml && dat[i + nl] == dat[i + nl - dif]; ++nl)\n                                ;\n                            if (nl > l) {\n                                l = nl, d = dif;\n                                // break out early when we reach \"nice\" (we are satisfied enough)\n                                if (nl > maxn)\n                                    break;\n                                // now, find the rarest 2-byte sequence within this\n                                // length of literals and search for that instead.\n                                // Much faster than just using the start\n                                var mmd = Math.min(dif, nl - 2);\n                                var md = 0;\n                                for (var j = 0; j < mmd; ++j) {\n                                    var ti = (i - dif + j + 32768) & 32767;\n                                    var pti = prev[ti];\n                                    var cd = (ti - pti + 32768) & 32767;\n                                    if (cd > md)\n                                        md = cd, pimod = ti;\n                                }\n                            }\n                        }\n                        // check the previous match\n                        imod = pimod, pimod = prev[imod];\n                        dif += (imod - pimod + 32768) & 32767;\n                    }\n                }\n                // d will be nonzero only when a match was found\n                if (d) {\n                    // store both dist and len data in one Uint32\n                    // Make sure this is recognized as a len/dist with 28th bit (2^28)\n                    syms[li++] = 268435456 | (revfl[l] << 18) | revfd[d];\n                    var lin = revfl[l] & 31, din = revfd[d] & 31;\n                    eb += fleb[lin] + fdeb[din];\n                    ++lf[257 + lin];\n                    ++df[din];\n                    wi = i + l;\n                    ++lc_1;\n                }\n                else {\n                    syms[li++] = dat[i];\n                    ++lf[dat[i]];\n                }\n            }\n        }\n        pos = wblk(dat, w, lst, syms, lf, df, eb, li, bs, i - bs, pos);\n        // this is the easiest way to avoid needing to maintain state\n        if (!lst && pos & 7)\n            pos = wfblk(w, pos + 1, et);\n    }\n    return slc(o, 0, pre + shft(pos) + post);\n};\n// CRC32 table\nvar crct = /*#__PURE__*/ (function () {\n    var t = new Int32Array(256);\n    for (var i = 0; i < 256; ++i) {\n        var c = i, k = 9;\n        while (--k)\n            c = ((c & 1) && -306674912) ^ (c >>> 1);\n        t[i] = c;\n    }\n    return t;\n})();\n// CRC32\nvar crc = function () {\n    var c = -1;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var cr = c;\n            for (var i = 0; i < d.length; ++i)\n                cr = crct[(cr & 255) ^ d[i]] ^ (cr >>> 8);\n            c = cr;\n        },\n        d: function () { return ~c; }\n    };\n};\n// Alder32\nvar adler = function () {\n    var a = 1, b = 0;\n    return {\n        p: function (d) {\n            // closures have awful performance\n            var n = a, m = b;\n            var l = d.length | 0;\n            for (var i = 0; i != l;) {\n                var e = Math.min(i + 2655, l);\n                for (; i < e; ++i)\n                    m += n += d[i];\n                n = (n & 65535) + 15 * (n >> 16), m = (m & 65535) + 15 * (m >> 16);\n            }\n            a = n, b = m;\n        },\n        d: function () {\n            a %= 65521, b %= 65521;\n            return (a & 255) << 24 | (a >>> 8) << 16 | (b & 255) << 8 | (b >>> 8);\n        }\n    };\n};\n;\n// deflate with opts\nvar dopt = function (dat, opt, pre, post, st) {\n    return dflt(dat, opt.level == null ? 6 : opt.level, opt.mem == null ? Math.ceil(Math.max(8, Math.min(13, Math.log(dat.length))) * 1.5) : (12 + opt.mem), pre, post, !st);\n};\n// Walmart object spread\nvar mrg = function (a, b) {\n    var o = {};\n    for (var k in a)\n        o[k] = a[k];\n    for (var k in b)\n        o[k] = b[k];\n    return o;\n};\n// worker clone\n// This is possibly the craziest part of the entire codebase, despite how simple it may seem.\n// The only parameter to this function is a closure that returns an array of variables outside of the function scope.\n// We're going to try to figure out the variable names used in the closure as strings because that is crucial for workerization.\n// We will return an object mapping of true variable name to value (basically, the current scope as a JS object).\n// The reason we can't just use the original variable names is minifiers mangling the toplevel scope.\n// This took me three weeks to figure out how to do.\nvar wcln = function (fn, fnStr, td) {\n    var dt = fn();\n    var st = fn.toString();\n    var ks = st.slice(st.indexOf('[') + 1, st.lastIndexOf(']')).replace(/\\s+/g, '').split(',');\n    for (var i = 0; i < dt.length; ++i) {\n        var v = dt[i], k = ks[i];\n        if (typeof v == 'function') {\n            fnStr += ';' + k + '=';\n            var st_1 = v.toString();\n            if (v.prototype) {\n                // for global objects\n                if (st_1.indexOf('[native code]') != -1) {\n                    var spInd = st_1.indexOf(' ', 8) + 1;\n                    fnStr += st_1.slice(spInd, st_1.indexOf('(', spInd));\n                }\n                else {\n                    fnStr += st_1;\n                    for (var t in v.prototype)\n                        fnStr += ';' + k + '.prototype.' + t + '=' + v.prototype[t].toString();\n                }\n            }\n            else\n                fnStr += st_1;\n        }\n        else\n            td[k] = v;\n    }\n    return [fnStr, td];\n};\nvar ch = [];\n// clone bufs\nvar cbfs = function (v) {\n    var tl = [];\n    for (var k in v) {\n        if (v[k].buffer) {\n            tl.push((v[k] = new v[k].constructor(v[k])).buffer);\n        }\n    }\n    return tl;\n};\n// use a worker to execute code\nvar wrkr = function (fns, init, id, cb) {\n    var _a;\n    if (!ch[id]) {\n        var fnStr = '', td_1 = {}, m = fns.length - 1;\n        for (var i = 0; i < m; ++i)\n            _a = wcln(fns[i], fnStr, td_1), fnStr = _a[0], td_1 = _a[1];\n        ch[id] = wcln(fns[m], fnStr, td_1);\n    }\n    var td = mrg({}, ch[id][1]);\n    return wk(ch[id][0] + ';onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage=' + init.toString() + '}', id, td, cbfs(td), cb);\n};\n// base async inflate fn\nvar bInflt = function () { return [u8, u16, u32, fleb, fdeb, clim, fl, fd, flrm, fdrm, rev, ec, hMap, max, bits, bits16, shft, slc, err, inflt, inflateSync, pbf, gu8]; };\nvar bDflt = function () { return [u8, u16, u32, fleb, fdeb, clim, revfl, revfd, flm, flt, fdm, fdt, rev, deo, et, hMap, wbits, wbits16, hTree, ln, lc, clen, wfblk, wblk, shft, slc, dflt, dopt, deflateSync, pbf]; };\n// gzip extra\nvar gze = function () { return [gzh, gzhl, wbytes, crc, crct]; };\n// gunzip extra\nvar guze = function () { return [gzs, gzl]; };\n// zlib extra\nvar zle = function () { return [zlh, wbytes, adler]; };\n// unzlib extra\nvar zule = function () { return [zlv]; };\n// post buf\nvar pbf = function (msg) { return postMessage(msg, [msg.buffer]); };\n// get u8\nvar gu8 = function (o) { return o && o.size && new u8(o.size); };\n// async helper\nvar cbify = function (dat, opts, fns, init, id, cb) {\n    var w = wrkr(fns, init, id, function (err, dat) {\n        w.terminate();\n        cb(err, dat);\n    });\n    w.postMessage([dat, opts], opts.consume ? [dat.buffer] : []);\n    return function () { w.terminate(); };\n};\n// auto stream\nvar astrm = function (strm) {\n    strm.ondata = function (dat, final) { return postMessage([dat, final], [dat.buffer]); };\n    return function (ev) { return strm.push(ev.data[0], ev.data[1]); };\n};\n// async stream attach\nvar astrmify = function (fns, strm, opts, init, id) {\n    var t;\n    var w = wrkr(fns, init, id, function (err, dat) {\n        if (err)\n            w.terminate(), strm.ondata.call(strm, err);\n        else {\n            if (dat[1])\n                w.terminate();\n            strm.ondata.call(strm, err, dat[0], dat[1]);\n        }\n    });\n    w.postMessage(opts);\n    strm.push = function (d, f) {\n        if (!strm.ondata)\n            err(5);\n        if (t)\n            strm.ondata(err(4, 0, 1), null, !!f);\n        w.postMessage([d, t = f], [d.buffer]);\n    };\n    strm.terminate = function () { w.terminate(); };\n};\n// read 2 bytes\nvar b2 = function (d, b) { return d[b] | (d[b + 1] << 8); };\n// read 4 bytes\nvar b4 = function (d, b) { return (d[b] | (d[b + 1] << 8) | (d[b + 2] << 16) | (d[b + 3] << 24)) >>> 0; };\nvar b8 = function (d, b) { return b4(d, b) + (b4(d, b + 4) * 4294967296); };\n// write bytes\nvar wbytes = function (d, b, v) {\n    for (; v; ++b)\n        d[b] = v, v >>>= 8;\n};\n// gzip header\nvar gzh = function (c, o) {\n    var fn = o.filename;\n    c[0] = 31, c[1] = 139, c[2] = 8, c[8] = o.level < 2 ? 4 : o.level == 9 ? 2 : 0, c[9] = 3; // assume Unix\n    if (o.mtime != 0)\n        wbytes(c, 4, Math.floor(new Date(o.mtime || Date.now()) / 1000));\n    if (fn) {\n        c[3] = 8;\n        for (var i = 0; i <= fn.length; ++i)\n            c[i + 10] = fn.charCodeAt(i);\n    }\n};\n// gzip footer: -8 to -4 = CRC, -4 to -0 is length\n// gzip start\nvar gzs = function (d) {\n    if (d[0] != 31 || d[1] != 139 || d[2] != 8)\n        err(6, 'invalid gzip data');\n    var flg = d[3];\n    var st = 10;\n    if (flg & 4)\n        st += d[10] | (d[11] << 8) + 2;\n    for (var zs = (flg >> 3 & 1) + (flg >> 4 & 1); zs > 0; zs -= !d[st++])\n        ;\n    return st + (flg & 2);\n};\n// gzip length\nvar gzl = function (d) {\n    var l = d.length;\n    return ((d[l - 4] | d[l - 3] << 8 | d[l - 2] << 16) | (d[l - 1] << 24)) >>> 0;\n};\n// gzip header length\nvar gzhl = function (o) { return 10 + ((o.filename && (o.filename.length + 1)) || 0); };\n// zlib header\nvar zlh = function (c, o) {\n    var lv = o.level, fl = lv == 0 ? 0 : lv < 6 ? 1 : lv == 9 ? 3 : 2;\n    c[0] = 120, c[1] = (fl << 6) | (fl ? (32 - 2 * fl) : 1);\n};\n// zlib valid\nvar zlv = function (d) {\n    if ((d[0] & 15) != 8 || (d[0] >>> 4) > 7 || ((d[0] << 8 | d[1]) % 31))\n        err(6, 'invalid zlib data');\n    if (d[1] & 32)\n        err(6, 'invalid zlib data: preset dictionaries not supported');\n};\nfunction AsyncCmpStrm(opts, cb) {\n    if (!cb && typeof opts == 'function')\n        cb = opts, opts = {};\n    this.ondata = cb;\n    return opts;\n}\n// zlib footer: -4 to -0 is Adler32\n/**\n * Streaming DEFLATE compression\n */\nvar Deflate = /*#__PURE__*/ (function () {\n    function Deflate(opts, cb) {\n        if (!cb && typeof opts == 'function')\n            cb = opts, opts = {};\n        this.ondata = cb;\n        this.o = opts || {};\n    }\n    Deflate.prototype.p = function (c, f) {\n        this.ondata(dopt(c, this.o, 0, 0, !f), f);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Deflate.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.d = final;\n        this.p(chunk, final || false);\n    };\n    return Deflate;\n}());\nexport { Deflate };\n/**\n * Asynchronous streaming DEFLATE compression\n */\nvar AsyncDeflate = /*#__PURE__*/ (function () {\n    function AsyncDeflate(opts, cb) {\n        astrmify([\n            bDflt,\n            function () { return [astrm, Deflate]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Deflate(ev.data);\n            onmessage = astrm(strm);\n        }, 6);\n    }\n    return AsyncDeflate;\n}());\nexport { AsyncDeflate };\nexport function deflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n    ], function (ev) { return pbf(deflateSync(ev.data[0], ev.data[1])); }, 0, cb);\n}\n/**\n * Compresses data with DEFLATE without any wrapper\n * @param data The data to compress\n * @param opts The compression options\n * @returns The deflated version of the data\n */\nexport function deflateSync(data, opts) {\n    return dopt(data, opts || {}, 0, 0);\n}\n/**\n * Streaming DEFLATE decompression\n */\nvar Inflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an inflation stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Inflate(cb) {\n        this.s = {};\n        this.p = new u8(0);\n        this.ondata = cb;\n    }\n    Inflate.prototype.e = function (c) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        var l = this.p.length;\n        var n = new u8(l + c.length);\n        n.set(this.p), n.set(c, l), this.p = n;\n    };\n    Inflate.prototype.c = function (final) {\n        this.d = this.s.i = final || false;\n        var bts = this.s.b;\n        var dt = inflt(this.p, this.o, this.s);\n        this.ondata(slc(dt, bts, this.s.b), this.d);\n        this.o = slc(dt, this.s.b - 32768), this.s.b = this.o.length;\n        this.p = slc(this.p, (this.s.p / 8) | 0), this.s.p &= 7;\n    };\n    /**\n     * Pushes a chunk to be inflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the final chunk\n     */\n    Inflate.prototype.push = function (chunk, final) {\n        this.e(chunk), this.c(final);\n    };\n    return Inflate;\n}());\nexport { Inflate };\n/**\n * Asynchronous streaming DEFLATE decompression\n */\nvar AsyncInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous inflation stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncInflate(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            function () { return [astrm, Inflate]; }\n        ], this, 0, function () {\n            var strm = new Inflate();\n            onmessage = astrm(strm);\n        }, 7);\n    }\n    return AsyncInflate;\n}());\nexport { AsyncInflate };\nexport function inflate(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt\n    ], function (ev) { return pbf(inflateSync(ev.data[0], gu8(ev.data[1]))); }, 1, cb);\n}\n/**\n * Expands DEFLATE data with no wrapper\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function inflateSync(data, out) {\n    return inflt(data, out);\n}\n// before you yell at me for not just using extends, my reason is that TS inheritance is hard to workerize.\n/**\n * Streaming GZIP compression\n */\nvar Gzip = /*#__PURE__*/ (function () {\n    function Gzip(opts, cb) {\n        this.c = crc();\n        this.l = 0;\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be GZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gzip.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Gzip.prototype.p = function (c, f) {\n        this.c.p(c);\n        this.l += c.length;\n        var raw = dopt(c, this.o, this.v && gzhl(this.o), f && 8, !f);\n        if (this.v)\n            gzh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 8, this.c.d()), wbytes(raw, raw.length - 4, this.l);\n        this.ondata(raw, f);\n    };\n    return Gzip;\n}());\nexport { Gzip };\n/**\n * Asynchronous streaming GZIP compression\n */\nvar AsyncGzip = /*#__PURE__*/ (function () {\n    function AsyncGzip(opts, cb) {\n        astrmify([\n            bDflt,\n            gze,\n            function () { return [astrm, Deflate, Gzip]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Gzip(ev.data);\n            onmessage = astrm(strm);\n        }, 8);\n    }\n    return AsyncGzip;\n}());\nexport { AsyncGzip };\nexport function gzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        gze,\n        function () { return [gzipSync]; }\n    ], function (ev) { return pbf(gzipSync(ev.data[0], ev.data[1])); }, 2, cb);\n}\n/**\n * Compresses data with GZIP\n * @param data The data to compress\n * @param opts The compression options\n * @returns The gzipped version of the data\n */\nexport function gzipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var c = crc(), l = data.length;\n    c.p(data);\n    var d = dopt(data, opts, gzhl(opts), 8), s = d.length;\n    return gzh(d, opts), wbytes(d, s - 8, c.d()), wbytes(d, s - 4, l), d;\n}\n/**\n * Streaming GZIP decompression\n */\nvar Gunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a GUNZIP stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Gunzip(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be GUNZIPped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Gunzip.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            var s = this.p.length > 3 ? gzs(this.p) : 4;\n            if (s >= this.p.length && !final)\n                return;\n            this.p = this.p.subarray(s), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 8)\n                err(6, 'invalid gzip data');\n            this.p = this.p.subarray(0, -8);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Gunzip;\n}());\nexport { Gunzip };\n/**\n * Asynchronous streaming GZIP decompression\n */\nvar AsyncGunzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous GUNZIP stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncGunzip(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            guze,\n            function () { return [astrm, Inflate, Gunzip]; }\n        ], this, 0, function () {\n            var strm = new Gunzip();\n            onmessage = astrm(strm);\n        }, 9);\n    }\n    return AsyncGunzip;\n}());\nexport { AsyncGunzip };\nexport function gunzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        guze,\n        function () { return [gunzipSync]; }\n    ], function (ev) { return pbf(gunzipSync(ev.data[0])); }, 3, cb);\n}\n/**\n * Expands GZIP data\n * @param data The data to decompress\n * @param out Where to write the data. GZIP already encodes the output size, so providing this doesn't save memory.\n * @returns The decompressed version of the data\n */\nexport function gunzipSync(data, out) {\n    return inflt(data.subarray(gzs(data), -8), out || new u8(gzl(data)));\n}\n/**\n * Streaming Zlib compression\n */\nvar Zlib = /*#__PURE__*/ (function () {\n    function Zlib(opts, cb) {\n        this.c = adler();\n        this.v = 1;\n        Deflate.call(this, opts, cb);\n    }\n    /**\n     * Pushes a chunk to be zlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Zlib.prototype.push = function (chunk, final) {\n        Deflate.prototype.push.call(this, chunk, final);\n    };\n    Zlib.prototype.p = function (c, f) {\n        this.c.p(c);\n        var raw = dopt(c, this.o, this.v && 2, f && 4, !f);\n        if (this.v)\n            zlh(raw, this.o), this.v = 0;\n        if (f)\n            wbytes(raw, raw.length - 4, this.c.d());\n        this.ondata(raw, f);\n    };\n    return Zlib;\n}());\nexport { Zlib };\n/**\n * Asynchronous streaming Zlib compression\n */\nvar AsyncZlib = /*#__PURE__*/ (function () {\n    function AsyncZlib(opts, cb) {\n        astrmify([\n            bDflt,\n            zle,\n            function () { return [astrm, Deflate, Zlib]; }\n        ], this, AsyncCmpStrm.call(this, opts, cb), function (ev) {\n            var strm = new Zlib(ev.data);\n            onmessage = astrm(strm);\n        }, 10);\n    }\n    return AsyncZlib;\n}());\nexport { AsyncZlib };\nexport function zlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bDflt,\n        zle,\n        function () { return [zlibSync]; }\n    ], function (ev) { return pbf(zlibSync(ev.data[0], ev.data[1])); }, 4, cb);\n}\n/**\n * Compress data with Zlib\n * @param data The data to compress\n * @param opts The compression options\n * @returns The zlib-compressed version of the data\n */\nexport function zlibSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var a = adler();\n    a.p(data);\n    var d = dopt(data, opts, 2, 4);\n    return zlh(d, opts), wbytes(d, d.length - 4, a.d()), d;\n}\n/**\n * Streaming Zlib decompression\n */\nvar Unzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates a Zlib decompression stream\n     * @param cb The callback to call whenever data is inflated\n     */\n    function Unzlib(cb) {\n        this.v = 1;\n        Inflate.call(this, cb);\n    }\n    /**\n     * Pushes a chunk to be unzlibbed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzlib.prototype.push = function (chunk, final) {\n        Inflate.prototype.e.call(this, chunk);\n        if (this.v) {\n            if (this.p.length < 2 && !final)\n                return;\n            this.p = this.p.subarray(2), this.v = 0;\n        }\n        if (final) {\n            if (this.p.length < 4)\n                err(6, 'invalid zlib data');\n            this.p = this.p.subarray(0, -4);\n        }\n        // necessary to prevent TS from using the closure value\n        // This allows for workerization to function correctly\n        Inflate.prototype.c.call(this, final);\n    };\n    return Unzlib;\n}());\nexport { Unzlib };\n/**\n * Asynchronous streaming Zlib decompression\n */\nvar AsyncUnzlib = /*#__PURE__*/ (function () {\n    /**\n     * Creates an asynchronous Zlib decompression stream\n     * @param cb The callback to call whenever data is deflated\n     */\n    function AsyncUnzlib(cb) {\n        this.ondata = cb;\n        astrmify([\n            bInflt,\n            zule,\n            function () { return [astrm, Inflate, Unzlib]; }\n        ], this, 0, function () {\n            var strm = new Unzlib();\n            onmessage = astrm(strm);\n        }, 11);\n    }\n    return AsyncUnzlib;\n}());\nexport { AsyncUnzlib };\nexport function unzlib(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return cbify(data, opts, [\n        bInflt,\n        zule,\n        function () { return [unzlibSync]; }\n    ], function (ev) { return pbf(unzlibSync(ev.data[0], gu8(ev.data[1]))); }, 5, cb);\n}\n/**\n * Expands Zlib data\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function unzlibSync(data, out) {\n    return inflt((zlv(data), data.subarray(2, -4)), out);\n}\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzip as compress, AsyncGzip as AsyncCompress };\n// Default algorithm for compression (used because having a known output size allows faster decompression)\nexport { gzipSync as compressSync, Gzip as Compress };\n/**\n * Streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar Decompress = /*#__PURE__*/ (function () {\n    /**\n     * Creates a decompression stream\n     * @param cb The callback to call whenever data is decompressed\n     */\n    function Decompress(cb) {\n        this.G = Gunzip;\n        this.I = Inflate;\n        this.Z = Unzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Decompress.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (!this.s) {\n            if (this.p && this.p.length) {\n                var n = new u8(this.p.length + chunk.length);\n                n.set(this.p), n.set(chunk, this.p.length);\n            }\n            else\n                this.p = chunk;\n            if (this.p.length > 2) {\n                var _this_1 = this;\n                var cb = function () { _this_1.ondata.apply(_this_1, arguments); };\n                this.s = (this.p[0] == 31 && this.p[1] == 139 && this.p[2] == 8)\n                    ? new this.G(cb)\n                    : ((this.p[0] & 15) != 8 || (this.p[0] >> 4) > 7 || ((this.p[0] << 8 | this.p[1]) % 31))\n                        ? new this.I(cb)\n                        : new this.Z(cb);\n                this.s.push(this.p, final);\n                this.p = null;\n            }\n        }\n        else\n            this.s.push(chunk, final);\n    };\n    return Decompress;\n}());\nexport { Decompress };\n/**\n * Asynchronous streaming GZIP, Zlib, or raw DEFLATE decompression\n */\nvar AsyncDecompress = /*#__PURE__*/ (function () {\n    /**\n   * Creates an asynchronous decompression stream\n   * @param cb The callback to call whenever data is decompressed\n   */\n    function AsyncDecompress(cb) {\n        this.G = AsyncGunzip;\n        this.I = AsyncInflate;\n        this.Z = AsyncUnzlib;\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be decompressed\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncDecompress.prototype.push = function (chunk, final) {\n        Decompress.prototype.push.call(this, chunk, final);\n    };\n    return AsyncDecompress;\n}());\nexport { AsyncDecompress };\nexport function decompress(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzip(data, opts, cb)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflate(data, opts, cb)\n            : unzlib(data, opts, cb);\n}\n/**\n * Expands compressed GZIP, Zlib, or raw DEFLATE data, automatically detecting the format\n * @param data The data to decompress\n * @param out Where to write the data. Saves memory if you know the decompressed size and provide an output buffer of that length.\n * @returns The decompressed version of the data\n */\nexport function decompressSync(data, out) {\n    return (data[0] == 31 && data[1] == 139 && data[2] == 8)\n        ? gunzipSync(data, out)\n        : ((data[0] & 15) != 8 || (data[0] >> 4) > 7 || ((data[0] << 8 | data[1]) % 31))\n            ? inflateSync(data, out)\n            : unzlibSync(data, out);\n}\n// flatten a directory structure\nvar fltn = function (d, p, t, o) {\n    for (var k in d) {\n        var val = d[k], n = p + k, op = o;\n        if (Array.isArray(val))\n            op = mrg(o, val[1]), val = val[0];\n        if (val instanceof u8)\n            t[n] = [val, op];\n        else {\n            t[n += '/'] = [new u8(0), op];\n            fltn(val, n, t, o);\n        }\n    }\n};\n// text encoder\nvar te = typeof TextEncoder != 'undefined' && /*#__PURE__*/ new TextEncoder();\n// text decoder\nvar td = typeof TextDecoder != 'undefined' && /*#__PURE__*/ new TextDecoder();\n// text decoder stream\nvar tds = 0;\ntry {\n    td.decode(et, { stream: true });\n    tds = 1;\n}\ncatch (e) { }\n// decode UTF8\nvar dutf8 = function (d) {\n    for (var r = '', i = 0;;) {\n        var c = d[i++];\n        var eb = (c > 127) + (c > 223) + (c > 239);\n        if (i + eb > d.length)\n            return [r, slc(d, i - 1)];\n        if (!eb)\n            r += String.fromCharCode(c);\n        else if (eb == 3) {\n            c = ((c & 15) << 18 | (d[i++] & 63) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63)) - 65536,\n                r += String.fromCharCode(55296 | (c >> 10), 56320 | (c & 1023));\n        }\n        else if (eb & 1)\n            r += String.fromCharCode((c & 31) << 6 | (d[i++] & 63));\n        else\n            r += String.fromCharCode((c & 15) << 12 | (d[i++] & 63) << 6 | (d[i++] & 63));\n    }\n};\n/**\n * Streaming UTF-8 decoding\n */\nvar DecodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is decoded\n     */\n    function DecodeUTF8(cb) {\n        this.ondata = cb;\n        if (tds)\n            this.t = new TextDecoder();\n        else\n            this.p = et;\n    }\n    /**\n     * Pushes a chunk to be decoded from UTF-8 binary\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    DecodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        final = !!final;\n        if (this.t) {\n            this.ondata(this.t.decode(chunk, { stream: true }), final);\n            if (final) {\n                if (this.t.decode().length)\n                    err(8);\n                this.t = null;\n            }\n            return;\n        }\n        if (!this.p)\n            err(4);\n        var dat = new u8(this.p.length + chunk.length);\n        dat.set(this.p);\n        dat.set(chunk, this.p.length);\n        var _a = dutf8(dat), ch = _a[0], np = _a[1];\n        if (final) {\n            if (np.length)\n                err(8);\n            this.p = null;\n        }\n        else\n            this.p = np;\n        this.ondata(ch, final);\n    };\n    return DecodeUTF8;\n}());\nexport { DecodeUTF8 };\n/**\n * Streaming UTF-8 encoding\n */\nvar EncodeUTF8 = /*#__PURE__*/ (function () {\n    /**\n     * Creates a UTF-8 decoding stream\n     * @param cb The callback to call whenever data is encoded\n     */\n    function EncodeUTF8(cb) {\n        this.ondata = cb;\n    }\n    /**\n     * Pushes a chunk to be encoded to UTF-8\n     * @param chunk The string data to push\n     * @param final Whether this is the last chunk\n     */\n    EncodeUTF8.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        if (this.d)\n            err(4);\n        this.ondata(strToU8(chunk), this.d = final || false);\n    };\n    return EncodeUTF8;\n}());\nexport { EncodeUTF8 };\n/**\n * Converts a string into a Uint8Array for use with compression/decompression methods\n * @param str The string to encode\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless decoding a binary string.\n * @returns The string encoded in UTF-8/Latin-1 binary\n */\nexport function strToU8(str, latin1) {\n    if (latin1) {\n        var ar_1 = new u8(str.length);\n        for (var i = 0; i < str.length; ++i)\n            ar_1[i] = str.charCodeAt(i);\n        return ar_1;\n    }\n    if (te)\n        return te.encode(str);\n    var l = str.length;\n    var ar = new u8(str.length + (str.length >> 1));\n    var ai = 0;\n    var w = function (v) { ar[ai++] = v; };\n    for (var i = 0; i < l; ++i) {\n        if (ai + 5 > ar.length) {\n            var n = new u8(ai + 8 + ((l - i) << 1));\n            n.set(ar);\n            ar = n;\n        }\n        var c = str.charCodeAt(i);\n        if (c < 128 || latin1)\n            w(c);\n        else if (c < 2048)\n            w(192 | (c >> 6)), w(128 | (c & 63));\n        else if (c > 55295 && c < 57344)\n            c = 65536 + (c & 1023 << 10) | (str.charCodeAt(++i) & 1023),\n                w(240 | (c >> 18)), w(128 | ((c >> 12) & 63)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n        else\n            w(224 | (c >> 12)), w(128 | ((c >> 6) & 63)), w(128 | (c & 63));\n    }\n    return slc(ar, 0, ai);\n}\n/**\n * Converts a Uint8Array to a string\n * @param dat The data to decode to string\n * @param latin1 Whether or not to interpret the data as Latin-1. This should\n *               not need to be true unless encoding to binary string.\n * @returns The original UTF-8/Latin-1 string\n */\nexport function strFromU8(dat, latin1) {\n    if (latin1) {\n        var r = '';\n        for (var i = 0; i < dat.length; i += 16384)\n            r += String.fromCharCode.apply(null, dat.subarray(i, i + 16384));\n        return r;\n    }\n    else if (td)\n        return td.decode(dat);\n    else {\n        var _a = dutf8(dat), out = _a[0], ext = _a[1];\n        if (ext.length)\n            err(8);\n        return out;\n    }\n}\n;\n// deflate bit flag\nvar dbf = function (l) { return l == 1 ? 3 : l < 6 ? 2 : l == 9 ? 1 : 0; };\n// skip local zip header\nvar slzh = function (d, b) { return b + 30 + b2(d, b + 26) + b2(d, b + 28); };\n// read zip header\nvar zh = function (d, b, z) {\n    var fnl = b2(d, b + 28), fn = strFromU8(d.subarray(b + 46, b + 46 + fnl), !(b2(d, b + 8) & 2048)), es = b + 46 + fnl, bs = b4(d, b + 20);\n    var _a = z && bs == 4294967295 ? z64e(d, es) : [bs, b4(d, b + 24), b4(d, b + 42)], sc = _a[0], su = _a[1], off = _a[2];\n    return [b2(d, b + 10), sc, su, fn, es + b2(d, b + 30) + b2(d, b + 32), off];\n};\n// read zip64 extra field\nvar z64e = function (d, b) {\n    for (; b2(d, b) != 1; b += 4 + b2(d, b + 2))\n        ;\n    return [b8(d, b + 12), b8(d, b + 4), b8(d, b + 20)];\n};\n// extra field length\nvar exfl = function (ex) {\n    var le = 0;\n    if (ex) {\n        for (var k in ex) {\n            var l = ex[k].length;\n            if (l > 65535)\n                err(9);\n            le += l + 4;\n        }\n    }\n    return le;\n};\n// write zip header\nvar wzh = function (d, b, f, fn, u, c, ce, co) {\n    var fl = fn.length, ex = f.extra, col = co && co.length;\n    var exl = exfl(ex);\n    wbytes(d, b, ce != null ? 0x2014B50 : 0x4034B50), b += 4;\n    if (ce != null)\n        d[b++] = 20, d[b++] = f.os;\n    d[b] = 20, b += 2; // spec compliance? what's that?\n    d[b++] = (f.flag << 1) | (c < 0 && 8), d[b++] = u && 8;\n    d[b++] = f.compression & 255, d[b++] = f.compression >> 8;\n    var dt = new Date(f.mtime == null ? Date.now() : f.mtime), y = dt.getFullYear() - 1980;\n    if (y < 0 || y > 119)\n        err(10);\n    wbytes(d, b, (y << 25) | ((dt.getMonth() + 1) << 21) | (dt.getDate() << 16) | (dt.getHours() << 11) | (dt.getMinutes() << 5) | (dt.getSeconds() >>> 1)), b += 4;\n    if (c != -1) {\n        wbytes(d, b, f.crc);\n        wbytes(d, b + 4, c < 0 ? -c - 2 : c);\n        wbytes(d, b + 8, f.size);\n    }\n    wbytes(d, b + 12, fl);\n    wbytes(d, b + 14, exl), b += 16;\n    if (ce != null) {\n        wbytes(d, b, col);\n        wbytes(d, b + 6, f.attrs);\n        wbytes(d, b + 10, ce), b += 14;\n    }\n    d.set(fn, b);\n    b += fl;\n    if (exl) {\n        for (var k in ex) {\n            var exf = ex[k], l = exf.length;\n            wbytes(d, b, +k);\n            wbytes(d, b + 2, l);\n            d.set(exf, b + 4), b += 4 + l;\n        }\n    }\n    if (col)\n        d.set(co, b), b += col;\n    return b;\n};\n// write zip footer (end of central directory)\nvar wzf = function (o, b, c, d, e) {\n    wbytes(o, b, 0x6054B50); // skip disk\n    wbytes(o, b + 8, c);\n    wbytes(o, b + 10, c);\n    wbytes(o, b + 12, d);\n    wbytes(o, b + 16, e);\n};\n/**\n * A pass-through stream to keep data uncompressed in a ZIP archive.\n */\nvar ZipPassThrough = /*#__PURE__*/ (function () {\n    /**\n     * Creates a pass-through stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     */\n    function ZipPassThrough(filename) {\n        this.filename = filename;\n        this.c = crc();\n        this.size = 0;\n        this.compression = 0;\n    }\n    /**\n     * Processes a chunk and pushes to the output stream. You can override this\n     * method in a subclass for custom behavior, but by default this passes\n     * the data through. You must call this.ondata(err, chunk, final) at some\n     * point in this method.\n     * @param chunk The chunk to process\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.process = function (chunk, final) {\n        this.ondata(null, chunk, final);\n    };\n    /**\n     * Pushes a chunk to be added. If you are subclassing this with a custom\n     * compression algorithm, note that you must push data from the source\n     * file only, pre-compression.\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipPassThrough.prototype.push = function (chunk, final) {\n        if (!this.ondata)\n            err(5);\n        this.c.p(chunk);\n        this.size += chunk.length;\n        if (final)\n            this.crc = this.c.d();\n        this.process(chunk, final || false);\n    };\n    return ZipPassThrough;\n}());\nexport { ZipPassThrough };\n// I don't extend because TypeScript extension adds 1kB of runtime bloat\n/**\n * Streaming DEFLATE compression for ZIP archives. Prefer using AsyncZipDeflate\n * for better performance\n */\nvar ZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function ZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new Deflate(opts, function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n    }\n    ZipDeflate.prototype.process = function (chunk, final) {\n        try {\n            this.d.push(chunk, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    ZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return ZipDeflate;\n}());\nexport { ZipDeflate };\n/**\n * Asynchronous streaming DEFLATE compression for ZIP archives\n */\nvar AsyncZipDeflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE stream that can be added to ZIP archives\n     * @param filename The filename to associate with this data stream\n     * @param opts The compression options\n     */\n    function AsyncZipDeflate(filename, opts) {\n        var _this_1 = this;\n        if (!opts)\n            opts = {};\n        ZipPassThrough.call(this, filename);\n        this.d = new AsyncDeflate(opts, function (err, dat, final) {\n            _this_1.ondata(err, dat, final);\n        });\n        this.compression = 8;\n        this.flag = dbf(opts.level);\n        this.terminate = this.d.terminate;\n    }\n    AsyncZipDeflate.prototype.process = function (chunk, final) {\n        this.d.push(chunk, final);\n    };\n    /**\n     * Pushes a chunk to be deflated\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    AsyncZipDeflate.prototype.push = function (chunk, final) {\n        ZipPassThrough.prototype.push.call(this, chunk, final);\n    };\n    return AsyncZipDeflate;\n}());\nexport { AsyncZipDeflate };\n// TODO: Better tree shaking\n/**\n * A zippable archive to which files can incrementally be added\n */\nvar Zip = /*#__PURE__*/ (function () {\n    /**\n     * Creates an empty ZIP archive to which files can be added\n     * @param cb The callback to call whenever data for the generated ZIP archive\n     *           is available\n     */\n    function Zip(cb) {\n        this.ondata = cb;\n        this.u = [];\n        this.d = 1;\n    }\n    /**\n     * Adds a file to the ZIP archive\n     * @param file The file stream to add\n     */\n    Zip.prototype.add = function (file) {\n        var _this_1 = this;\n        if (!this.ondata)\n            err(5);\n        // finishing or finished\n        if (this.d & 2)\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, false);\n        else {\n            var f = strToU8(file.filename), fl_1 = f.length;\n            var com = file.comment, o = com && strToU8(com);\n            var u = fl_1 != file.filename.length || (o && (com.length != o.length));\n            var hl_1 = fl_1 + exfl(file.extra) + 30;\n            if (fl_1 > 65535)\n                this.ondata(err(11, 0, 1), null, false);\n            var header = new u8(hl_1);\n            wzh(header, 0, file, f, u, -1);\n            var chks_1 = [header];\n            var pAll_1 = function () {\n                for (var _i = 0, chks_2 = chks_1; _i < chks_2.length; _i++) {\n                    var chk = chks_2[_i];\n                    _this_1.ondata(null, chk, false);\n                }\n                chks_1 = [];\n            };\n            var tr_1 = this.d;\n            this.d = 0;\n            var ind_1 = this.u.length;\n            var uf_1 = mrg(file, {\n                f: f,\n                u: u,\n                o: o,\n                t: function () {\n                    if (file.terminate)\n                        file.terminate();\n                },\n                r: function () {\n                    pAll_1();\n                    if (tr_1) {\n                        var nxt = _this_1.u[ind_1 + 1];\n                        if (nxt)\n                            nxt.r();\n                        else\n                            _this_1.d = 1;\n                    }\n                    tr_1 = 1;\n                }\n            });\n            var cl_1 = 0;\n            file.ondata = function (err, dat, final) {\n                if (err) {\n                    _this_1.ondata(err, dat, final);\n                    _this_1.terminate();\n                }\n                else {\n                    cl_1 += dat.length;\n                    chks_1.push(dat);\n                    if (final) {\n                        var dd = new u8(16);\n                        wbytes(dd, 0, 0x8074B50);\n                        wbytes(dd, 4, file.crc);\n                        wbytes(dd, 8, cl_1);\n                        wbytes(dd, 12, file.size);\n                        chks_1.push(dd);\n                        uf_1.c = cl_1, uf_1.b = hl_1 + cl_1 + 16, uf_1.crc = file.crc, uf_1.size = file.size;\n                        if (tr_1)\n                            uf_1.r();\n                        tr_1 = 1;\n                    }\n                    else if (tr_1)\n                        pAll_1();\n                }\n            };\n            this.u.push(uf_1);\n        }\n    };\n    /**\n     * Ends the process of adding files and prepares to emit the final chunks.\n     * This *must* be called after adding all desired files for the resulting\n     * ZIP file to work properly.\n     */\n    Zip.prototype.end = function () {\n        var _this_1 = this;\n        if (this.d & 2) {\n            this.ondata(err(4 + (this.d & 1) * 8, 0, 1), null, true);\n            return;\n        }\n        if (this.d)\n            this.e();\n        else\n            this.u.push({\n                r: function () {\n                    if (!(_this_1.d & 1))\n                        return;\n                    _this_1.u.splice(-1, 1);\n                    _this_1.e();\n                },\n                t: function () { }\n            });\n        this.d = 3;\n    };\n    Zip.prototype.e = function () {\n        var bt = 0, l = 0, tl = 0;\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            tl += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0);\n        }\n        var out = new u8(tl + 22);\n        for (var _b = 0, _c = this.u; _b < _c.length; _b++) {\n            var f = _c[_b];\n            wzh(out, bt, f, f.f, f.u, -f.c - 2, l, f.o);\n            bt += 46 + f.f.length + exfl(f.extra) + (f.o ? f.o.length : 0), l += f.b;\n        }\n        wzf(out, bt, this.u.length, tl, l);\n        this.ondata(null, out, true);\n        this.d = 2;\n    };\n    /**\n     * A method to terminate any internal workers used by the stream. Subsequent\n     * calls to add() will fail.\n     */\n    Zip.prototype.terminate = function () {\n        for (var _i = 0, _a = this.u; _i < _a.length; _i++) {\n            var f = _a[_i];\n            f.t();\n        }\n        this.d = 2;\n    };\n    return Zip;\n}());\nexport { Zip };\nexport function zip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var r = {};\n    fltn(data, '', r, opts);\n    var k = Object.keys(r);\n    var lft = k.length, o = 0, tot = 0;\n    var slft = lft, files = new Array(lft);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var cbf = function () {\n        var out = new u8(tot + 22), oe = o, cdl = tot - o;\n        tot = 0;\n        for (var i = 0; i < slft; ++i) {\n            var f = files[i];\n            try {\n                var l = f.c.length;\n                wzh(out, tot, f, f.f, f.u, l);\n                var badd = 30 + f.f.length + exfl(f.extra);\n                var loc = tot + badd;\n                out.set(f.c, loc);\n                wzh(out, o, f, f.f, f.u, l, tot, f.m), o += 16 + badd + (f.m ? f.m.length : 0), tot = loc + l;\n            }\n            catch (e) {\n                return cbd(e, null);\n            }\n        }\n        wzf(out, o, files.length, cdl, oe);\n        cbd(null, out);\n    };\n    if (!lft)\n        cbf();\n    var _loop_1 = function (i) {\n        var fn = k[i];\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var c = crc(), size = file.length;\n        c.p(file);\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        var compression = p.level == 0 ? 0 : 8;\n        var cbl = function (e, d) {\n            if (e) {\n                tAll();\n                cbd(e, null);\n            }\n            else {\n                var l = d.length;\n                files[i] = mrg(p, {\n                    size: size,\n                    crc: c.d(),\n                    c: d,\n                    f: f,\n                    m: m,\n                    u: s != fn.length || (m && (com.length != ms)),\n                    compression: compression\n                });\n                o += 30 + s + exl + l;\n                tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n                if (!--lft)\n                    cbf();\n            }\n        };\n        if (s > 65535)\n            cbl(err(11, 0, 1), null);\n        if (!compression)\n            cbl(null, file);\n        else if (size < 160000) {\n            try {\n                cbl(null, deflateSync(file, p));\n            }\n            catch (e) {\n                cbl(e, null);\n            }\n        }\n        else\n            term.push(deflate(file, p, cbl));\n    };\n    // Cannot use lft because it can decrease\n    for (var i = 0; i < slft; ++i) {\n        _loop_1(i);\n    }\n    return tAll;\n}\n/**\n * Synchronously creates a ZIP file. Prefer using `zip` for better performance\n * with more than one file.\n * @param data The directory structure for the ZIP archive\n * @param opts The main options, merged with per-file options\n * @returns The generated ZIP archive\n */\nexport function zipSync(data, opts) {\n    if (!opts)\n        opts = {};\n    var r = {};\n    var files = [];\n    fltn(data, '', r, opts);\n    var o = 0;\n    var tot = 0;\n    for (var fn in r) {\n        var _a = r[fn], file = _a[0], p = _a[1];\n        var compression = p.level == 0 ? 0 : 8;\n        var f = strToU8(fn), s = f.length;\n        var com = p.comment, m = com && strToU8(com), ms = m && m.length;\n        var exl = exfl(p.extra);\n        if (s > 65535)\n            err(11);\n        var d = compression ? deflateSync(file, p) : file, l = d.length;\n        var c = crc();\n        c.p(file);\n        files.push(mrg(p, {\n            size: file.length,\n            crc: c.d(),\n            c: d,\n            f: f,\n            m: m,\n            u: s != fn.length || (m && (com.length != ms)),\n            o: o,\n            compression: compression\n        }));\n        o += 30 + s + exl + l;\n        tot += 76 + 2 * (s + exl) + (ms || 0) + l;\n    }\n    var out = new u8(tot + 22), oe = o, cdl = tot - o;\n    for (var i = 0; i < files.length; ++i) {\n        var f = files[i];\n        wzh(out, f.o, f, f.f, f.u, f.c.length);\n        var badd = 30 + f.f.length + exfl(f.extra);\n        out.set(f.c, f.o + badd);\n        wzh(out, o, f, f.f, f.u, f.c.length, f.o, f.m), o += 16 + badd + (f.m ? f.m.length : 0);\n    }\n    wzf(out, o, files.length, cdl, oe);\n    return out;\n}\n/**\n * Streaming pass-through decompression for ZIP archives\n */\nvar UnzipPassThrough = /*#__PURE__*/ (function () {\n    function UnzipPassThrough() {\n    }\n    UnzipPassThrough.prototype.push = function (data, final) {\n        this.ondata(null, data, final);\n    };\n    UnzipPassThrough.compression = 0;\n    return UnzipPassThrough;\n}());\nexport { UnzipPassThrough };\n/**\n * Streaming DEFLATE decompression for ZIP archives. Prefer AsyncZipInflate for\n * better performance.\n */\nvar UnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function UnzipInflate() {\n        var _this_1 = this;\n        this.i = new Inflate(function (dat, final) {\n            _this_1.ondata(null, dat, final);\n        });\n    }\n    UnzipInflate.prototype.push = function (data, final) {\n        try {\n            this.i.push(data, final);\n        }\n        catch (e) {\n            this.ondata(e, null, final);\n        }\n    };\n    UnzipInflate.compression = 8;\n    return UnzipInflate;\n}());\nexport { UnzipInflate };\n/**\n * Asynchronous streaming DEFLATE decompression for ZIP archives\n */\nvar AsyncUnzipInflate = /*#__PURE__*/ (function () {\n    /**\n     * Creates a DEFLATE decompression that can be used in ZIP archives\n     */\n    function AsyncUnzipInflate(_, sz) {\n        var _this_1 = this;\n        if (sz < 320000) {\n            this.i = new Inflate(function (dat, final) {\n                _this_1.ondata(null, dat, final);\n            });\n        }\n        else {\n            this.i = new AsyncInflate(function (err, dat, final) {\n                _this_1.ondata(err, dat, final);\n            });\n            this.terminate = this.i.terminate;\n        }\n    }\n    AsyncUnzipInflate.prototype.push = function (data, final) {\n        if (this.i.terminate)\n            data = slc(data, 0);\n        this.i.push(data, final);\n    };\n    AsyncUnzipInflate.compression = 8;\n    return AsyncUnzipInflate;\n}());\nexport { AsyncUnzipInflate };\n/**\n * A ZIP archive decompression stream that emits files as they are discovered\n */\nvar Unzip = /*#__PURE__*/ (function () {\n    /**\n     * Creates a ZIP decompression stream\n     * @param cb The callback to call whenever a file in the ZIP archive is found\n     */\n    function Unzip(cb) {\n        this.onfile = cb;\n        this.k = [];\n        this.o = {\n            0: UnzipPassThrough\n        };\n        this.p = et;\n    }\n    /**\n     * Pushes a chunk to be unzipped\n     * @param chunk The chunk to push\n     * @param final Whether this is the last chunk\n     */\n    Unzip.prototype.push = function (chunk, final) {\n        var _this_1 = this;\n        if (!this.onfile)\n            err(5);\n        if (!this.p)\n            err(4);\n        if (this.c > 0) {\n            var len = Math.min(this.c, chunk.length);\n            var toAdd = chunk.subarray(0, len);\n            this.c -= len;\n            if (this.d)\n                this.d.push(toAdd, !this.c);\n            else\n                this.k[0].push(toAdd);\n            chunk = chunk.subarray(len);\n            if (chunk.length)\n                return this.push(chunk, final);\n        }\n        else {\n            var f = 0, i = 0, is = void 0, buf = void 0;\n            if (!this.p.length)\n                buf = chunk;\n            else if (!chunk.length)\n                buf = this.p;\n            else {\n                buf = new u8(this.p.length + chunk.length);\n                buf.set(this.p), buf.set(chunk, this.p.length);\n            }\n            var l = buf.length, oc = this.c, add = oc && this.d;\n            var _loop_2 = function () {\n                var _a;\n                var sig = b4(buf, i);\n                if (sig == 0x4034B50) {\n                    f = 1, is = i;\n                    this_1.d = null;\n                    this_1.c = 0;\n                    var bf = b2(buf, i + 6), cmp_1 = b2(buf, i + 8), u = bf & 2048, dd = bf & 8, fnl = b2(buf, i + 26), es = b2(buf, i + 28);\n                    if (l > i + 30 + fnl + es) {\n                        var chks_3 = [];\n                        this_1.k.unshift(chks_3);\n                        f = 2;\n                        var sc_1 = b4(buf, i + 18), su_1 = b4(buf, i + 22);\n                        var fn_1 = strFromU8(buf.subarray(i + 30, i += 30 + fnl), !u);\n                        if (sc_1 == 4294967295) {\n                            _a = dd ? [-2] : z64e(buf, i), sc_1 = _a[0], su_1 = _a[1];\n                        }\n                        else if (dd)\n                            sc_1 = -1;\n                        i += es;\n                        this_1.c = sc_1;\n                        var d_1;\n                        var file_1 = {\n                            name: fn_1,\n                            compression: cmp_1,\n                            start: function () {\n                                if (!file_1.ondata)\n                                    err(5);\n                                if (!sc_1)\n                                    file_1.ondata(null, et, true);\n                                else {\n                                    var ctr = _this_1.o[cmp_1];\n                                    if (!ctr)\n                                        file_1.ondata(err(14, 'unknown compression type ' + cmp_1, 1), null, false);\n                                    d_1 = sc_1 < 0 ? new ctr(fn_1) : new ctr(fn_1, sc_1, su_1);\n                                    d_1.ondata = function (err, dat, final) { file_1.ondata(err, dat, final); };\n                                    for (var _i = 0, chks_4 = chks_3; _i < chks_4.length; _i++) {\n                                        var dat = chks_4[_i];\n                                        d_1.push(dat, false);\n                                    }\n                                    if (_this_1.k[0] == chks_3 && _this_1.c)\n                                        _this_1.d = d_1;\n                                    else\n                                        d_1.push(et, true);\n                                }\n                            },\n                            terminate: function () {\n                                if (d_1 && d_1.terminate)\n                                    d_1.terminate();\n                            }\n                        };\n                        if (sc_1 >= 0)\n                            file_1.size = sc_1, file_1.originalSize = su_1;\n                        this_1.onfile(file_1);\n                    }\n                    return \"break\";\n                }\n                else if (oc) {\n                    if (sig == 0x8074B50) {\n                        is = i += 12 + (oc == -2 && 8), f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                    else if (sig == 0x2014B50) {\n                        is = i -= 4, f = 3, this_1.c = 0;\n                        return \"break\";\n                    }\n                }\n            };\n            var this_1 = this;\n            for (; i < l - 4; ++i) {\n                var state_1 = _loop_2();\n                if (state_1 === \"break\")\n                    break;\n            }\n            this.p = et;\n            if (oc < 0) {\n                var dat = f ? buf.subarray(0, is - 12 - (oc == -2 && 8) - (b4(buf, is - 16) == 0x8074B50 && 4)) : buf.subarray(0, i);\n                if (add)\n                    add.push(dat, !!f);\n                else\n                    this.k[+(f == 2)].push(dat);\n            }\n            if (f & 2)\n                return this.push(buf.subarray(i), final);\n            this.p = buf.subarray(i);\n        }\n        if (final) {\n            if (this.c)\n                err(13);\n            this.p = null;\n        }\n    };\n    /**\n     * Registers a decoder with the stream, allowing for files compressed with\n     * the compression type provided to be expanded correctly\n     * @param decoder The decoder constructor\n     */\n    Unzip.prototype.register = function (decoder) {\n        this.o[decoder.compression] = decoder;\n    };\n    return Unzip;\n}());\nexport { Unzip };\nvar mt = typeof queueMicrotask == 'function' ? queueMicrotask : typeof setTimeout == 'function' ? setTimeout : function (fn) { fn(); };\nexport function unzip(data, opts, cb) {\n    if (!cb)\n        cb = opts, opts = {};\n    if (typeof cb != 'function')\n        err(7);\n    var term = [];\n    var tAll = function () {\n        for (var i = 0; i < term.length; ++i)\n            term[i]();\n    };\n    var files = {};\n    var cbd = function (a, b) {\n        mt(function () { cb(a, b); });\n    };\n    mt(function () { cbd = cb; });\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558) {\n            cbd(err(13, 0, 1), null);\n            return tAll;\n        }\n    }\n    ;\n    var lft = b2(data, e + 8);\n    if (lft) {\n        var c = lft;\n        var o = b4(data, e + 16);\n        var z = o == 4294967295 || c == 65535;\n        if (z) {\n            var ze = b4(data, e - 12);\n            z = b4(data, ze) == 0x6064B50;\n            if (z) {\n                c = lft = b4(data, ze + 32);\n                o = b4(data, ze + 48);\n            }\n        }\n        var fltr = opts && opts.filter;\n        var _loop_3 = function (i) {\n            var _a = zh(data, o, z), c_1 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n            o = no;\n            var cbl = function (e, d) {\n                if (e) {\n                    tAll();\n                    cbd(e, null);\n                }\n                else {\n                    if (d)\n                        files[fn] = d;\n                    if (!--lft)\n                        cbd(null, files);\n                }\n            };\n            if (!fltr || fltr({\n                name: fn,\n                size: sc,\n                originalSize: su,\n                compression: c_1\n            })) {\n                if (!c_1)\n                    cbl(null, slc(data, b, b + sc));\n                else if (c_1 == 8) {\n                    var infl = data.subarray(b, b + sc);\n                    if (sc < 320000) {\n                        try {\n                            cbl(null, inflateSync(infl, new u8(su)));\n                        }\n                        catch (e) {\n                            cbl(e, null);\n                        }\n                    }\n                    else\n                        term.push(inflate(infl, { size: su }, cbl));\n                }\n                else\n                    cbl(err(14, 'unknown compression type ' + c_1, 1), null);\n            }\n            else\n                cbl(null, null);\n        };\n        for (var i = 0; i < c; ++i) {\n            _loop_3(i);\n        }\n    }\n    else\n        cbd(null, {});\n    return tAll;\n}\n/**\n * Synchronously decompresses a ZIP archive. Prefer using `unzip` for better\n * performance with more than one file.\n * @param data The raw compressed ZIP file\n * @param opts The ZIP extraction options\n * @returns The decompressed files\n */\nexport function unzipSync(data, opts) {\n    var files = {};\n    var e = data.length - 22;\n    for (; b4(data, e) != 0x6054B50; --e) {\n        if (!e || data.length - e > 65558)\n            err(13);\n    }\n    ;\n    var c = b2(data, e + 8);\n    if (!c)\n        return {};\n    var o = b4(data, e + 16);\n    var z = o == 4294967295 || c == 65535;\n    if (z) {\n        var ze = b4(data, e - 12);\n        z = b4(data, ze) == 0x6064B50;\n        if (z) {\n            c = b4(data, ze + 32);\n            o = b4(data, ze + 48);\n        }\n    }\n    var fltr = opts && opts.filter;\n    for (var i = 0; i < c; ++i) {\n        var _a = zh(data, o, z), c_2 = _a[0], sc = _a[1], su = _a[2], fn = _a[3], no = _a[4], off = _a[5], b = slzh(data, off);\n        o = no;\n        if (!fltr || fltr({\n            name: fn,\n            size: sc,\n            originalSize: su,\n            compression: c_2\n        })) {\n            if (!c_2)\n                files[fn] = slc(data, b, b + sc);\n            else if (c_2 == 8)\n                files[fn] = inflateSync(data.subarray(b, b + sc), new u8(su));\n            else\n                err(14, 'unknown compression type ' + c_2);\n        }\n    }\n    return files;\n}\n","export enum Mesh {\n    SKIN = 0,\n    PANTS_HELPER = 1,\n    // 2 to 124 are the joints\n    SKIRT = 126,\n    HAIR = 127,\n    EYEBALL0 = 128,\n    EYEBALL1 = 129,\n    PENIS = 130,\n    MOUTH_GUM_TOP = 131,\n    MOUTH_GUM_BOTTOM = 132,\n    TOUNGE = 169,\n    CUBE = 171\n}\n","import { fileURLToPath } from 'url'\nimport { AbstractFileSystemAdapter } from './AbstractFileSystemAdapter'\nimport { unzlibSync } from 'fflate'\n\ninterface FileInfo {\n    file: string\n    isDir: boolean\n    dir?: string[]\n}\n\nexport class HTTPFSAdapter implements AbstractFileSystemAdapter {\n\n    static path2info = new Map<string, FileInfo>()\n\n    readFile(pathname: string): string {\n        if (pathname.endsWith(\".z\")) {\n            // console.log(`load compressed file ${pathname}`)\n            const req = new XMLHttpRequest()\n            req.overrideMimeType('text/plain; charset=x-user-defined')\n            req.open('GET', pathname, false)\n            req.send(null)\n            if (req.status > 400) {\n                throw new Error(`Request failed for '${pathname}': ${req.statusText}`)\n            }\n            const ab = new ArrayBuffer(req.responseText.length)\n            const ua = new Uint8Array(ab)\n            for (let i = 0; i < req.responseText.length; ++i) {\n                ua[i] = req.responseText.charCodeAt(i)\n            }\n            const dec = new TextDecoder(\"utf-8\")\n            return dec.decode(unzlibSync(ua))\n        } else {\n            if (pathname.endsWith(\"/directory.json\")) {\n                // console.log(`load uncompressed file ${pathname}`)\n                const req = new XMLHttpRequest()\n                req.open('GET', pathname, false)\n                req.send(null)\n                if (req.status < 400)\n                    return req.responseText\n                throw new Error(`Request failed for '${pathname}': ${req.statusText}`)    \n            } else {\n                return this.readFile(`${pathname}.z`)\n            }\n        }\n    }\n    isFile(pathname: string): boolean {\n        // console.log(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        let info = HTTPFSAdapter.path2info.get(pathname)\n        if (info === undefined) {\n            try {\n                this.listDir(pathname)\n            }\n            catch(e) {\n                console.log(`failed to load directory ${pathname}`)\n                HTTPFSAdapter.path2info.forEach( (value, key) => console.log(key, value))\n                throw Error()\n            }\n            info = HTTPFSAdapter.path2info.get(pathname)\n        }\n        if (info === undefined) {\n            throw Error(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        return !info.isDir\n    }\n    isDir(pathname: string): boolean {\n        // console.log(`HTTPJSFSAdapter.isDir('${pathname}')`)\n        const info = HTTPFSAdapter.path2info.get(pathname)\n        if (info === undefined) {\n            throw Error(`HTTPJSFSAdapter.isFile('${pathname}')`)\n        }\n        return info.isDir\n    }\n    listDir(pathname: string): string[] {\n        // console.log(`HTTPJSFSAdapter.listDir('${pathname}')`)\n\n        let info = HTTPFSAdapter.path2info.get(pathname)\n        if (info !== undefined && info.dir !== undefined) {\n            return info.dir\n        }\n\n        if (info === undefined)\n            info = { file: '', isDir: true, dir: undefined }\n\n        const d = this.readFile(`data/${pathname}/directory.json`)\n        const j = JSON.parse(d)\n        info.dir = []\n        for (const x of j) {\n            const fullfile = `${pathname}/${x.file}`\n            // console.log(`${pathname}/${x.file}`)\n            info.dir.push(x.file)\n            if (!x.isDir)\n                HTTPFSAdapter.path2info.set(fullfile, { file: x.file, isDir: false })\n        }\n        HTTPFSAdapter.path2info.set(pathname, info)\n        return info.dir\n    }\n    realPath(pathname: string): string {\n        // console.log(`HTTPJSFSAdapter.realPath('${pathname}')`)\n        // throw Error()\n        return pathname\n    }\n    joinPath(pathname1: string, pathname2: string): string {\n        // console.log(`HTTPJSFSAdapter.joinPath('${pathname1}', '${pathname2}')`)\n        return `${pathname1}/${pathname2}`\n    }\n}\n","import { vec3 } from 'gl-matrix'\n\nexport function calculateNormals(vertex: number[], indices: number[]): number[] {\n\n    function addNormal(index: number, normal: vec3) {\n        normals[index] += normal[0]\n        normals[index + 1] += normal[1]\n        normals[index + 2] += normal[2]\n    }\n\n    const normals = new Array<number>(vertex.length)\n    normals.fill(0)\n    \n    // add vectors\n    for (let i = 0; i < indices.length;) {\n        const i1 = indices[i++] * 3\n        const i2 = indices[i++] * 3\n        const i3 = indices[i++] * 3\n\n        const p1 = vec3.fromValues(vertex[i1], vertex[i1 + 1], vertex[i1 + 2])\n        const p2 = vec3.fromValues(vertex[i2], vertex[i2 + 1], vertex[i2 + 2])\n        const p3 = vec3.fromValues(vertex[i3], vertex[i3 + 1], vertex[i3 + 2])\n\n        const u = vec3.create()\n        vec3.subtract(u, p2, p1)\n\n        const v = vec3.create()\n        vec3.subtract(v, p3, p1)\n\n        const n = vec3.create()\n        vec3.cross(n, u, v)\n\n        addNormal(i1, n)\n        addNormal(i2, n)\n        addNormal(i3, n)\n    }\n\n    // normalize\n    for(let normalIndex = 0; normalIndex < vertex.length; normalIndex += 3) {\n        const normal = vec3.fromValues(normals[normalIndex], normals[normalIndex + 1], normals[normalIndex + 2])\n        vec3.normalize(normal, normal)\n        normals[normalIndex] = normal[0]\n        normals[normalIndex + 1] = normal[1]\n        normals[normalIndex + 2] = normal[2]\n    }\n    return normals\n}\n","import { mat4, vec4 } from 'gl-matrix'\nimport { calculateNormals } from './lib/calculateNormals'\nimport { Mesh } from './Mesh'\nimport { HumanMesh, Update } from './mesh/HumanMesh'\nimport { Mode } from './Mode'\nimport { Bone } from \"./skeleton/Bone\"\n\nlet cubeRotation = 0.0\n\ninterface ProgramInfo {\n    program: WebGLProgram\n    attribLocations: {\n        vertexPosition: number\n        vertexNormal: number\n        // vertexColor: number\n    }\n    uniformLocations: {\n        projectionMatrix: WebGLUniformLocation\n        modelViewMatrix: WebGLUniformLocation\n        normalMatrix: WebGLUniformLocation\n        color: WebGLUniformLocation\n    }\n}\n\ninterface Buffers {\n    vertex: WebGLBuffer\n    normal: WebGLBuffer\n    indices: WebGLBuffer\n\n    skeletonIndex: number\n\n    proxy?: RenderMesh\n\n    // proxyOffset: number\n    // proxyCount: number\n}\n\nclass RenderMesh {\n    gl: WebGL2RenderingContext\n    vertex: WebGLBuffer\n    normal: WebGLBuffer\n    indices: WebGLBuffer\n    length: number\n\n    constructor(gl: WebGL2RenderingContext, vertex: number[], index: number[]) {\n        this.gl = gl\n        this.vertex = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, vertex)\n        this.indices = this.createBuffer(gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, index)\n        this.normal = this.createBuffer(gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, calculateNormals(vertex, index))\n        this.length = index.length\n    }\n\n    update(vertex: number[], index: number[]) {\n        this.updateBuffer(this.vertex, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, vertex)\n        this.updateBuffer(this.normal, this.gl.ARRAY_BUFFER, this.gl.STATIC_DRAW, Float32Array, calculateNormals(vertex, index))\n    }\n\n    draw(programInfo: ProgramInfo, mode: number) {\n        const numComponents = 3, type = this.gl.FLOAT, normalize = false, stride = 0, offset = 0\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertex)\n        this.gl.vertexAttribPointer(programInfo.attribLocations.vertexPosition, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition)\n\n        this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.normal)\n        this.gl.vertexAttribPointer(programInfo.attribLocations.vertexNormal, numComponents, type, normalize, stride, offset)\n        this.gl.enableVertexAttribArray(programInfo.attribLocations.vertexNormal)\n\n        this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER, this.indices)\n\n        this.gl.drawElements(mode, this.length , this.gl.UNSIGNED_SHORT, 0)\n    }\n\n    protected createBuffer(target: GLenum, usage: GLenum, type: Float32ArrayConstructor | Uint16ArrayConstructor, data: number[]): WebGLBuffer {\n        const buffer = this.gl.createBuffer()\n        if (buffer === null)\n            throw Error('Failed to create new WebGLBuffer')\n        this.updateBuffer(buffer, target, usage, type, data)\n        return buffer\n    }\n\n    protected updateBuffer(buffer: WebGLBuffer, target: GLenum, usage: GLenum, type: Float32ArrayConstructor | Uint16ArrayConstructor, data: number[]): WebGLBuffer {\n        this.gl.bindBuffer(target, buffer)\n        this.gl.bufferData(target, new type(data), usage)\n        return buffer\n    }\n}\n\nexport function render(canvas: HTMLCanvasElement, scene: HumanMesh): void {\n\n    // for(let i=0; i<10; ++i) {\n    //     console.log(`draw group '${scene.groups[i].name}, offset=${scene.groups[i].startIndex}, length=${scene.groups[i].length}'`)\n    // }\n\n    console.log(`NUMBER OF BONES ${scene.human.__skeleton.bones.size}`)\n\n    const gl = (canvas.getContext('webgl2') || canvas.getContext('experimental-webgl')) as WebGL2RenderingContext\n    if (!gl) {\n        throw Error('Unable to initialize WebGL. Your browser or machine may not support it.')\n    }\n\n    const buffers = createAllBuffers(gl, scene)\n\n    const vertexShader = compileShader(gl, gl.VERTEX_SHADER, vertexSharderSrc)\n    const fragmentShader = compileShader(gl, gl.FRAGMENT_SHADER, fragmentShaderSrc)\n    const programInfo = linkProgram(gl, vertexShader, fragmentShader)\n\n    let then = 0\n    function render(now: number) {\n        now *= 0.001  // convert to seconds\n        const deltaTime = now - then\n        then = now\n\n        if (scene.updateRequired !== Update.NONE) {\n            scene.update()\n            let skeleton = renderSkeletonGlobal(scene)\n            // let skeleton = renderSkeletonRelative(scene)\n\n            let vx = scene.vertex\n            let ix = scene.indices\n\n            const vertexOffset = scene.vertex.length / 3\n            vx = vx.concat(skeleton.vertex)\n            ix = ix.concat(skeleton.indices.map(v => v + vertexOffset))\n        \n            // append proxy\n            if (buffers.proxy) {\n                buffers.proxy.update(scene.proxy!.getCoords(scene.vertex), scene.proxyMesh!.indices)\n            }\n\n            buffers.vertex = createBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, vx)\n            buffers.normal = createBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, calculateNormals(vx, ix))\n        }\n\n        drawScene(gl, programInfo, buffers, deltaTime, scene)\n\n        requestAnimationFrame(render)\n    }\n    requestAnimationFrame(render)\n}\n\nfunction drawScene(gl: WebGL2RenderingContext, programInfo: ProgramInfo, buffers: Buffers, deltaTime: number, scene: HumanMesh): void {\n\n    const canvas = gl.canvas as HTMLCanvasElement\n    if (canvas.width !== canvas.clientWidth || canvas.height !== canvas.clientHeight) {\n        canvas.width = canvas.clientWidth\n        canvas.height = canvas.clientHeight\n    }\n\n    gl.viewport(0, 0, canvas.width, canvas.height)\n    gl.clearColor(0.0, 0.0, 0.0, 1.0)\n    gl.clearDepth(1.0)\n    gl.enable(gl.DEPTH_TEST)\n    gl.depthFunc(gl.LEQUAL)\n\n    // gl.enable(gl.BLEND)\n    // gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\n\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT)\n\n    const fieldOfView = 45 * Math.PI / 180    // in radians\n    const aspect = canvas.width / canvas.height\n    const zNear = 0.1\n    const zFar = 100.0\n    const projectionMatrix = mat4.create()\n    mat4.perspective(projectionMatrix, fieldOfView, aspect, zNear, zFar)\n\n    const modelViewMatrix = mat4.create()\n    mat4.translate(modelViewMatrix, modelViewMatrix, [-0.0, 0.0, -25.0]) // move the model (cube) away\n    // mat4.rotate(modelViewMatrix,  modelViewMatrix,  cubeRotation, [0, 0, 1])\n    mat4.rotate(modelViewMatrix, modelViewMatrix, cubeRotation * .7, [0, 1, 0])\n\n    const normalMatrix = mat4.create()\n    mat4.invert(normalMatrix, modelViewMatrix)\n    mat4.transpose(normalMatrix, normalMatrix)\n\n    {\n        const numComponents = 3\n        const type = gl.FLOAT\n        const normalize = false\n        const stride = 0\n        const offset = 0\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffers.vertex)\n        gl.vertexAttribPointer(\n            programInfo.attribLocations.vertexPosition,\n            numComponents,\n            type,\n            normalize,\n            stride,\n            offset)\n        gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition)\n    }\n\n    {\n        const numComponents = 3\n        const type = gl.FLOAT\n        const normalize = false\n        const stride = 0\n        const offset = 0\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffers.normal)\n        gl.vertexAttribPointer(\n            programInfo.attribLocations.vertexNormal,\n            numComponents,\n            type,\n            normalize,\n            stride,\n            offset)\n        gl.enableVertexAttribArray(programInfo.attribLocations.vertexNormal)\n    }\n\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffers.indices)\n\n    gl.useProgram(programInfo.program)\n\n    gl.uniformMatrix4fv(programInfo.uniformLocations.projectionMatrix, false, projectionMatrix)\n    gl.uniformMatrix4fv(programInfo.uniformLocations.modelViewMatrix, false, modelViewMatrix)\n    gl.uniformMatrix4fv(programInfo.uniformLocations.normalMatrix, false, normalMatrix)\n\n    let skin\n    switch (scene.mode) {\n        case Mode.MORPH:\n            skin = [Mesh.SKIN, [1.0, 0.8, 0.7, 1], gl.TRIANGLES]\n            break\n        case Mode.POSE:\n            skin = [Mesh.SKIN, [1.0 / 5, 0.8 / 5, 0.7 / 5, 1], gl.LINES]\n            break\n    }\n\n    for (let x of [\n        skin,\n        [Mesh.EYEBALL0, [0.0, 0.5, 1, 1], gl.TRIANGLES],\n        [Mesh.EYEBALL1, [0.0, 0.5, 1, 1], gl.TRIANGLES],\n        [Mesh.MOUTH_GUM_TOP, [1.0, 0.0, 0, 1], gl.TRIANGLES],\n        [Mesh.MOUTH_GUM_BOTTOM, [1.0, 0.0, 0, 1], gl.TRIANGLES],\n        [Mesh.TOUNGE, [1.0, 0.0, 0, 1], gl.TRIANGLES],\n        [Mesh.CUBE, [1.0, 0.0, 0.5, 1], gl.LINE_STRIP],\n    ]) {\n        const idx = x[0] as number\n        const mode = x[2] as number\n\n        gl.uniform4fv(programInfo.uniformLocations.color, x[1] as number[])\n        const type = gl.UNSIGNED_SHORT\n        let offset = scene.groups[idx].startIndex * 2\n        let count = scene.groups[idx].length\n\n        if (buffers.proxy && idx === Mesh.SKIN) {\n            continue\n        }\n\n        // console.log(`draw group '${scene.groups[i].name}, offset=${offset}, length=${count}'`)\n        gl.drawElements(mode, count, type, offset)\n    }\n\n    // SKELETON\n    if (scene.mode === Mode.POSE) {\n        gl.uniform4fv(programInfo.uniformLocations.color, [1, 1, 1, 1])\n        const offset = buffers.skeletonIndex\n        const mode = gl.LINES\n        const count = scene.human.__skeleton.boneslist!.length * 2\n        gl.drawElements(mode, count, gl.UNSIGNED_SHORT, offset)\n    }\n\n    // JOINTS\n    if (scene.mode === Mode.POSE) {\n        gl.uniform4fv(programInfo.uniformLocations.color, [1, 1, 1, 1])\n        const type = gl.UNSIGNED_SHORT\n        const offset = scene.groups[2].startIndex * 2\n        const count = scene.groups[2].length * 124\n        gl.drawElements(gl.TRIANGLES, count, type, offset)\n    }\n\n    if (buffers.proxy !== undefined) {\n        gl.uniform4fv(programInfo.uniformLocations.color, [1.0, 0.8, 0.7, 1])\n        let mode\n        switch (scene.mode) {\n            case Mode.MORPH:\n                gl.uniform4fv(programInfo.uniformLocations.color, [1.0, 0.8, 0.7, 1])\n                mode = gl.TRIANGLES\n                break\n            case Mode.POSE:\n                gl.uniform4fv(programInfo.uniformLocations.color, [1.0 / 5, 0.8 / 5, 0.7 / 5, 1])\n                // skin = [Mesh.SKIN, [1.0 / 5, 0.8 / 5, 0.7 / 5, 1], gl.LINES]\n                mode = gl.LINES\n                break\n        }\n\n        buffers.proxy.draw(programInfo, mode)\n    }\n\n    cubeRotation += deltaTime\n}\n\nconst vertexSharderSrc = `\n// this is our input per vertex\nattribute vec4 aVertexPosition;\nattribute vec3 aVertexNormal;\n// attribute vec4 aVertexColor;\n\n// input for all vertices (uniform for the whole shader program)\nuniform mat4 uNormalMatrix;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform vec4 uColor;\n\n// data exchanged with other graphic pipeline stages\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\n\nvoid main(void) {\n  gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n\n  highp vec3 ambientLight = vec3(0.3, 0.3, 0.3);\n  highp vec3 directionalLightColor = vec3(1, 1, 1);\n  highp vec3 directionalVector = normalize(vec3(0.85, 0.8, 0.75));\n\n  highp vec4 transformedNormal = uNormalMatrix * vec4(aVertexNormal, 1.0);\n\n  highp float directional = max(dot(transformedNormal.xyz, directionalVector), 0.0);\n  vLighting = ambientLight + (directionalLightColor * directional);\n\n  vColor = uColor;\n}`\n\n// skin color\nconst fragmentShaderSrc = `\nvarying lowp vec4 vColor;\nvarying highp vec3 vLighting;\nvoid main(void) {\n  gl_FragColor = vec4(vec3(vColor[0],vColor[1],vColor[2]) * vLighting, vColor[3]);\n    // gl_FragColor = vColor;\n}`\n\nfunction compileShader(gl: WebGL2RenderingContext, type: GLenum, source: string): WebGLShader {\n    const shader = gl.createShader(type)\n    if (shader === null)\n        throw Error('Unable to create WebGLShader')\n    gl.shaderSource(shader, source)\n    gl.compileShader(shader)\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        gl.deleteShader(shader)\n        throw Error(`An error occurred compiling the ${type} WebGLShader: ${gl.getShaderInfoLog(shader)}`)\n    }\n    return shader\n}\n\nfunction linkProgram(gl: WebGL2RenderingContext, vertexShader: WebGLShader, fragmentShader: WebGLShader): ProgramInfo {\n    const program = gl.createProgram()\n    if (program === null) {\n        throw Error('Unable to create WebGLProgram')\n    }\n    gl.attachShader(program, vertexShader)\n    gl.attachShader(program, fragmentShader)\n    gl.linkProgram(program)\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        throw Error(`Unable to initialize WebGLProgram: ${gl.getProgramInfoLog(program)}`)\n    }\n\n    return {\n        program: program,\n        attribLocations: {\n            vertexPosition: gl.getAttribLocation(program, 'aVertexPosition'),\n            vertexNormal: gl.getAttribLocation(program, 'aVertexNormal'),\n            // vertexColor: gl.getAttribLocation(program, 'aVertexColor'),\n        },\n        uniformLocations: {\n            projectionMatrix: getUniformLocation(gl, program, 'uProjectionMatrix'),\n            modelViewMatrix: getUniformLocation(gl, program, 'uModelViewMatrix'),\n            normalMatrix: getUniformLocation(gl, program, 'uNormalMatrix'),\n            color: getUniformLocation(gl, program, 'uColor')\n        }\n    }\n}\n\nfunction getUniformLocation(gl: WebGL2RenderingContext, program: WebGLProgram, name: string): WebGLUniformLocation {\n    const location = gl.getUniformLocation(program, name)\n    if (location === null)\n        throw Error(`Internal Error: Failed to get uniform location for ${name}`)\n    return location\n}\n\n// render the skeleton using matRestGlobal\nfunction renderSkeletonGlobal(scene: HumanMesh) {\n    const skel = scene.human.__skeleton\n    const v = vec4.fromValues(0, 0, 0, 1)\n    const vertex = new Array<number>(skel.boneslist!.length * 6)\n    const indices = new Array<number>(skel.boneslist!.length * 2)\n    skel.boneslist!.forEach((bone, index) => {\n        const m = bone.matPoseGlobal ? bone.matPoseGlobal : bone.matRestGlobal!\n        const a = vec4.transformMat4(vec4.create(), v, m)\n        const b = vec4.transformMat4(vec4.create(), bone.yvector4!, m)\n        const vi = index * 6\n        const ii = index * 2\n        vertex[vi] = a[0]\n        vertex[vi + 1] = a[1]\n        vertex[vi + 2] = a[2]\n        vertex[vi + 3] = b[0]\n        vertex[vi + 4] = b[1]\n        vertex[vi + 5] = b[2]\n        indices[ii] = index * 2\n        indices[ii + 1] = index * 2 + 1\n    })\n    return { vertex, indices }\n}\n\n// render the skeleton using matRestRelative\nfunction renderSkeletonRelative(scene: HumanMesh) {\n    const skel = scene.human.__skeleton\n    const v = vec4.fromValues(0, 0, 0, 1)\n    const vertex: number[] = []\n    const indices: number[] = []\n    const rootBone = skel.roots[0]!\n\n    mat4.identity(mat4.create())\n    renderSkeletonRelativeHelper(\n        mat4.identity(mat4.create()),\n        rootBone,\n        vertex,\n        indices\n    )\n    return { vertex, indices }\n}\n\nfunction renderSkeletonRelativeHelper(m: mat4, bone: Bone, vertex: number[], indices: number[]) {\n    const v = vec4.fromValues(0, 0, 0, 1)\n\n    const a = vec4.transformMat4(vec4.create(), v, bone.matRestGlobal!)\n    const b = vec4.transformMat4(vec4.create(), bone.yvector4!, bone.matRestGlobal!)\n\n    const index = vertex.length / 3\n    vertex.push(a[0], a[1], a[2], b[0], b[1], b[2])\n    indices.push(index, index + 1)\n\n    const m0 = m\n    const m1 = mat4.multiply(mat4.create(), m0, bone.matRestRelative!)\n    bone.children.forEach(childBone => {\n        renderSkeletonRelativeHelper(m1, childBone, vertex, indices)\n    })\n}\n\nfunction createAllBuffers(gl: WebGL2RenderingContext, scene: HumanMesh): Buffers {\n\n    let skeleton = renderSkeletonGlobal(scene)\n    // let skeleton = renderSkeletonRelative(scene)\n\n    let vx = scene.vertex\n    let ix = scene.indices\n\n    // append skeleton\n    const skeletonOffset = vx.length / 3\n    const skeletonIndex = ix.length * 2\n    vx = vx.concat(skeleton.vertex)\n    ix = ix.concat(skeleton.indices.map(v => v + skeletonOffset))\n\n    let proxy: RenderMesh | undefined\n    if (scene.proxy) {\n        proxy = new RenderMesh(gl, scene.proxy.getCoords(scene.vertex), scene.proxyMesh!.indices)\n    }\n\n    return {\n        vertex: createBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, vx),\n        normal: createBuffer(gl, gl.ARRAY_BUFFER, gl.STATIC_DRAW, Float32Array, calculateNormals(vx, ix)),\n        indices: createBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, gl.STATIC_DRAW, Uint16Array, ix),\n        skeletonIndex,\n        proxy\n    }\n}\n\nfunction createBuffer(gl: WebGL2RenderingContext, target: GLenum, usage: GLenum, type: Float32ArrayConstructor | Uint16ArrayConstructor, data: number[]): WebGLBuffer {\n    const buffer = gl.createBuffer()\n    if (buffer === null)\n        throw Error('Failed to create new WebGLBuffer')\n    gl.bindBuffer(target, buffer)\n    gl.bufferData(target, new type(data), usage)\n    return buffer\n}\n","import { TablePos } from 'toad.js/table/TablePos'\nimport { TreeNode } from 'toad.js/table/model/TreeNode'\nimport { TreeNodeModel } from 'toad.js/table/model/TreeNodeModel'\nimport { TreeAdapter } from 'toad.js/table/adapter/TreeAdapter'\n\nimport { Bone } from \"./Bone\"\nimport { Text } from \"toad.js/view/Text\"\nimport { NumberModel } from 'toad.js/model/NumberModel'\nimport { Fragment } from 'toad.jsx/lib/jsx-runtime'\nimport { Signal } from 'toad.js/Signal'\nimport { mat4 } from 'gl-matrix'\n\nexport class PoseNode implements TreeNode {\n    static count = 0\n    bone!: Bone\n    next?: PoseNode\n    down?: PoseNode\n\n    x: NumberModel\n    y: NumberModel\n    z: NumberModel\n\n    updateBone() {\n        let out = mat4.create()\n        let tmp = mat4.create()\n        mat4.fromXRotation(out, this.x.value / 360 * 2 * Math.PI)\n        mat4.fromYRotation(tmp, this.y.value / 360 * 2 * Math.PI)\n        mat4.multiply(out, out, tmp)\n        mat4.fromZRotation(tmp, this.z.value / 360 * 2 * Math.PI)\n        mat4.multiply(out, out, tmp)\n        this.bone.matPose = out\n        // this.bone.update()\n        this.bone.skeleton.boneslist!.forEach(bone => bone.update())\n    }\n\n    constructor(bone: Bone | undefined = undefined, signal: Signal<PoseNode> | undefined = undefined) {\n        this.x = new NumberModel(0, { min: -180, max: 180, step: 5 })\n        this.y = new NumberModel(0, { min: -180, max: 180, step: 5 })\n        this.z = new NumberModel(0, { min: -180, max: 180, step: 5 })\n\n        if (bone === undefined || signal === undefined) {\n            return\n        }\n\n        const update = () => {\n            this.updateBone()\n            signal.trigger(this)\n        }\n\n        this.x.modified.add(update)\n        this.y.modified.add(update)\n        this.z.modified.add(update)\n\n        this.bone = bone\n\n        // TODO: reduce nesting\n        // E.g. instead of\n        //     spine05\n        //       spine04\n        //         spine03\n        //           spine02\n        //             spine01\n        //               neck01\n        //               clavicle.R\n        //               clavicle.L\n        //             breast.R\n        //             breast.L\n        // arrange it as\n        //     spine05\n        //       spine04\n        //       spine03\n        //       spine02\n        //         spine01\n        //           neck01\n        //           clavicle.R\n        //           clavicle.L\n        //         breast.R\n        //         breast.L\n        bone.children.forEach(childBone => {\n            if (this.down === undefined) {\n                this.down = new PoseNode(childBone, signal)\n            } else {\n                const next = this.down\n                this.down = new PoseNode(childBone, signal)\n                this.down.next = next\n            }\n        })\n    }\n}\n\n// this tells <toad-table> how to render TreeNodeModel<PoseNode>\nexport class PoseTreeAdapter extends TreeAdapter<PoseNode> {\n\n    constructor(model: TreeNodeModel<PoseNode>) {\n        super(model)\n        this.config.expandColumn = true\n    }\n\n    override get colCount(): number {\n        return 2\n    }\n\n    override showCell(pos: TablePos, cell: HTMLSpanElement) {\n        if (this.model === undefined) {\n            console.log(\"no model\")\n            return\n        }\n        const node = this.model.rows[pos.row].node\n        switch (pos.col) {\n            case 0:\n                this.treeCell(pos, cell, node.bone.name)\n                break\n            case 1:\n                const x = <>\n                    <Text model={node.x} style={{ width: '50px' }} />\n                    <Text model={node.y} style={{ width: '50px' }} />\n                    <Text model={node.z} style={{ width: '50px' }} />\n                </> as Fragment\n                cell.replaceChildren(...x)\n                break\n        }\n    }\n}\n\n\n","import { TablePos } from 'toad.js/table/TablePos'\nimport { TreeNode } from 'toad.js/table/model/TreeNode'\nimport { TreeNodeModel } from 'toad.js/table/model/TreeNodeModel'\nimport { TreeAdapter } from 'toad.js/table/adapter/TreeAdapter'\n\nimport { Text } from 'toad.js/view/Text'\nimport { Slider } from 'toad.js/view/Slider'\nimport { Fragment } from \"toad.jsx\"\n\nimport { SliderNode } from './loadSliders'\n\n// this tells <toad-table> how to render TreeNodeModel<SliderNode>\nexport class SliderTreeAdapter extends TreeAdapter<SliderNode> {\n    constructor(model: TreeNodeModel<SliderNode>) {\n        super(model)\n        this.config.expandColumn = true\n    }\n\n    override get colCount(): number {\n        return 2\n    }\n\n    override showCell(pos: TablePos, cell: HTMLSpanElement) {\n        if (this.model === undefined) {\n            console.log(\"no model\")\n            return\n        }\n        const node = this.model.rows[pos.row].node\n        switch (pos.col) {\n            case 0:\n                this.treeCell(pos, cell, node.label)\n                break\n            case 1:\n                if (node.model) {\n                    const x = <>\n                        <Text model={node.model} style={{ width: '50px' }} />\n                        <Slider model={node.model} style={{width: '200px' }}/>\n                    </> as Fragment\n                    cell.replaceChildren(...x)\n                }\n                break\n        }\n    }\n}\n","import { HumanMesh } from './HumanMesh'\nimport { Mesh } from '../Mesh'\nimport { Bone } from '../skeleton/Bone'\nimport { calculateNormals } from '../lib/calculateNormals'\nimport { vec3, vec4, mat4 } from 'gl-matrix'\n\n// Export the human as COLLAborative Design Activity (COLLADA) suitable for import in Blender\n// https://en.wikipedia.org/wiki/COLLADA\n\nexport function exportCollada(scene: HumanMesh) {\n    let s = scene\n    // s = testCube\n\n    return colladaHead() +\n        colladaEffects() +\n        colladaMaterials() +\n        colladaGeometries(s) + // mesh\n        colladaControllers(s) + // weights\n        colladaVisualScenes(s) + // skeleton\n        colladaScene() +\n        colladaTail()\n}\n\nconst sceneName = `Scene`\nconst objectName = `Human`\nconst meshName = `${objectName}-mesh`\nconst meshPositionsName = `${meshName}-positions`\nconst meshPositionsArrayName = `${meshPositionsName}-array`\nconst meshVerticesName = `${meshName}-vertices`\n\nconst armatureName = `Armature`\nconst armatureLongName = `${armatureName}_${objectName}`\nconst skinName = `${armatureLongName}-skin`\nconst skinJointsName = `${skinName}-joints`\nconst skinJointsArrayName = `${skinJointsName}-array`\nconst skinWeightsName = `${skinName}-weights`\nconst skinWeightsArrayName = `${skinWeightsName}-array`\nconst skinIbmName = `${skinName}-bind_poses`\nconst skinIbmArrayName = `${skinIbmName}-array`\n\n// TODO: try to export with meter=\"1\" and Z_UP so that blender doesn't scale and rotate\n//       the human. this will simplify the workflow in blender after the import\nfunction colladaHead() {\n    return `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n<COLLADA xmlns=\"http://www.collada.org/2005/11/COLLADASchema\" version=\"1.4.1\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">\n  <asset>\n    <contributor>\n      <author>makehuman.js user</author>\n      <authoring_tool>https://github.com/markandre13/makehuman.js</authoring_tool>\n    </contributor>\n    <created>${new Date().toISOString()}</created>\n    <modified>${new Date().toISOString()}</modified>\n    <unit name=\"meter\" meter=\"0.1\"/>\n    <up_axis>Y_UP</up_axis>\n  </asset>\n  <library_images/>\n`\n}\n\nfunction colladaTail() { return `</COLLADA>` }\n\ninterface Material {\n    meshId: Mesh\n    name: string\n    r: number\n    g: number\n    b: number\n}\n\nconst materials: Material[] = [\n    { meshId: Mesh.SKIN, name: \"skin\", r: 1, g: 0.5, b: 0.5 },\n    { meshId: Mesh.EYEBALL0, name: \"eyeL\", r: 0, g: 1, b: 0 },\n    { meshId: Mesh.EYEBALL1, name: \"eyeR\", r: 1, g: 0, b: 0 },\n]\n\nfunction colladaEffects() {\n    let out = `  <library_effects>\\n`\n    materials.forEach(m => {\n        out += `    <effect id=\"${m.name}-effect\">\n      <profile_COMMON>\n        <technique sid=\"common\">\n          <lambert>\n            <emission>\n              <color sid=\"emission\">0 0 0 1</color>\n            </emission>\n            <diffuse>\n              <color sid=\"diffuse\">${m.r} ${m.g} ${m.b} 1</color>\n            </diffuse>\n            <reflectivity>\n              <float sid=\"specular\">0.0</float>\n            </reflectivity>\n          </lambert>\n        </technique>\n      </profile_COMMON>\n    </effect>\n`})\n    out += `  </library_effects>\\n`\n    return out\n}\n\nfunction colladaMaterials() {\n    let out = `  <library_materials>\\n`\n    materials.forEach(m => {\n        out += `    <material id=\"${m.name}-material\" name=\"${m.name}\">\n      <instance_effect url=\"#${m.name}-effect\"/>\n    </material>\n`})\n    out += `  </library_materials>\\n`\n    return out\n}\n\nfunction colladaGeometries(scene: HumanMesh) {\n    const meshId = Mesh.SKIN\n    let vertexStart = Number.MAX_VALUE, vertexEnd = Number.MIN_VALUE\n    const indexStart = scene.groups[meshId].startIndex\n    const indexEnd = indexStart + scene.groups[meshId].length\n    for (let i = indexStart; i < indexEnd; ++i) {\n        const index = scene.indices[i]\n        if (vertexStart > index) {\n            vertexStart = index\n        }\n        if (vertexEnd < index) {\n            vertexEnd = index\n        }\n    }\n    ++vertexEnd // range of [vertexStart, vertexEnd[\n    vertexStart = vertexStart * 3\n    vertexEnd = vertexEnd * 3\n\n    const vertex = scene.vertex.slice(vertexStart, vertexEnd)\n\n    // the mesh is in quads but converted to triangles for OpenGL. when exporting, revert to quads\n    const indices: number[] = []\n    for (let i = indexStart; i < indexEnd; i += 6) {\n        indices.push(scene.indices[i])\n        indices.push(scene.indices[i + 1])\n        indices.push(scene.indices[i + 2])\n        indices.push(scene.indices[i + 3])\n    }\n\n    return `  <library_geometries>\n    <geometry id=\"${meshName}\" name=\"${objectName}\">\n      <mesh>\n        <source id=\"${meshPositionsName}\">\n          <float_array id=\"${meshPositionsArrayName}\" count=\"${vertex.length}\">${vertex.join(\" \")}</float_array>\n          <technique_common>\n            <accessor source=\"#${meshPositionsArrayName}\" count=\"${vertex.length / 3}\" stride=\"3\">\n              <param name=\"X\" type=\"float\"/>\n              <param name=\"Y\" type=\"float\"/>\n              <param name=\"Z\" type=\"float\"/>\n            </accessor>\n          </technique_common>\n        </source>\n        <vertices id=\"${meshVerticesName}\">\n          <input semantic=\"POSITION\" source=\"#${meshPositionsName}\"/>\n        </vertices>\n        <polylist material=\"${materials[0].name}-material\" count=\"${indices.length / 4}\">\n          <input semantic=\"VERTEX\" source=\"#${meshVerticesName}\" offset=\"0\"/>\n          <vcount>${\"4 \".repeat(indices.length / 4)}</vcount>\n          <p>${indices.join(\" \")}</p>\n        </polylist>\n      </mesh>\n    </geometry>\n  </library_geometries>\n`}\n\nfunction colladaControllers(scene: HumanMesh) {\n    const out = new Array<Array<Array<number>>>(scene.vertex.length / 3)\n    for (let i = 0; i < out.length; ++i) {\n        out[i] = new Array()\n    }\n\n    const allBoneNames: string[] = []\n    const allWeights: number[] = []\n    let ibmAll = \"\"\n\n    scene.human.__skeleton.vertexWeights!._data.forEach((data, boneName) => {\n        const boneIndex = allBoneNames.length\n        allBoneNames.push(boneName)\n\n        const bone = scene.human.__skeleton.bones.get(boneName)!\n        ibmAll += ibm(bone) + \" \"\n\n        const indices = data[0] as number[]\n        const weights = data[1] as number[]\n        for (let i = 0; i < indices.length; ++i) {\n            const index = indices[i]\n            const weight = weights[i]\n            const weightIndex = allWeights.length\n            allWeights.push(weight)\n            out[index].push([boneIndex, weightIndex])\n        }\n    })\n    ibmAll = ibmAll.trimEnd()\n\n    const outFlat: number[] = []\n    out.forEach(x => {\n        x.forEach(y =>\n            y.forEach(z =>\n                outFlat.push(z)\n            )\n        )\n    })\n\n    return `  <library_controllers>\n    <controller id=\"${skinName}\" name=\"${armatureName}\">\n      <skin source=\"#${meshName}\">\n        <bind_shape_matrix>${mat2txt(identity)}</bind_shape_matrix>\n        <source id=\"${skinJointsName}\">\n          <Name_array id=\"${skinJointsArrayName}\" count=\"3\">${allBoneNames.join(\" \").replace(/\\./g, \"_\")}</Name_array>\n          <technique_common>\n            <accessor source=\"#${skinJointsArrayName}\" count=\"${allBoneNames.length}\" stride=\"1\">\n              <param name=\"JOINT\" type=\"name\"/>\n            </accessor>\n          </technique_common>\n        </source>\n        <source id=\"${skinIbmName}\">\n          <float_array id=\"${skinIbmArrayName}\" count=\"${allBoneNames.length * 16}\">${ibmAll}</float_array>\n          <technique_common>\n            <accessor source=\"#${skinIbmArrayName}\" count=\"${allBoneNames.length}\" stride=\"16\">\n              <param name=\"TRANSFORM\" type=\"float4x4\"/>\n            </accessor>\n          </technique_common>\n        </source>\n        <source id=\"${skinWeightsName}\">\n          <float_array id=\"${skinWeightsArrayName}\" count=\"${allWeights.length}\">${allWeights.join(\" \")}</float_array>\n          <technique_common>\n            <accessor source=\"#${skinWeightsArrayName}\" count=\"${allWeights.length}\" stride=\"1\">\n              <param name=\"WEIGHT\" type=\"float\"/>\n            </accessor>\n          </technique_common>\n        </source>\n        <joints>\n          <input semantic=\"JOINT\" source=\"#${skinJointsName}\"/>\n          <input semantic=\"INV_BIND_MATRIX\" source=\"#${skinIbmName}\"/>\n        </joints>\n        <vertex_weights count=\"${out.length}\">\n          <input semantic=\"JOINT\" source=\"#${skinJointsName}\" offset=\"0\"/>\n          <input semantic=\"WEIGHT\" source=\"#${skinWeightsName}\" offset=\"1\"/>\n          <vcount>${out.map(e => e.length).join(\" \")}</vcount>\n          <v>${outFlat.join(\" \")}</v>\n        </vertex_weights>\n      </skin>\n    </controller>\n  </library_controllers>\n`}\n\nfunction colladaVisualScenes(scene: HumanMesh) {\n    let out = `  <library_visual_scenes>\n    <visual_scene id=\"${sceneName}\" name=\"${sceneName}\">\n      <node id=\"${armatureName}\" name=\"${armatureName}\" type=\"NODE\">\n        <matrix sid=\"transform\">${mat2txt(identity)}</matrix>\n${dumpBone(armatureName, scene.human.__skeleton.roots[0])}\n`\n    // what varies...\n    // node: id, name\n    // instance_controller: url\n    //   ouch: this means each controller as a complete list of bone names and IBMs...\n    //   (yeah, checked even with a collada export from blender)\n    // instance_material: symbol, target\n    out += `        <node id=\"${objectName}\" name=\"${objectName}\" type=\"NODE\">\n          <matrix sid=\"transform\">${mat2txt(identity)}</matrix>\n          <instance_controller url=\"#${skinName}\">\n            <skeleton>#${armatureName}_${scene.human.__skeleton.roots[0].name}</skeleton>\n            <bind_material>\n              <technique_common>\n                <instance_material symbol=\"${materials[0].name}-material\" target=\"#${materials[0].name}-material\"/>\n              </technique_common>\n            </bind_material>\n          </instance_controller>\n        </node>\n`\n    out += `      </node>\n    </visual_scene>\n  </library_visual_scenes>\n`\n    return out\n}\n\nfunction colladaScene() {\n    return `  <scene>\n    <instance_visual_scene url=\"#${sceneName}\"/>\n  </scene>\n`}\n\nconst identity = mat4.identity(mat4.create())\n\n// create the \"bind shape matrix\" from the collada spec\nfunction bsm(bone: Bone) {\n    return mat2txt(bone.matRestRelative!)\n}\n\n// create the \"inverse bind pose matrix\" from the collada spec\nfunction ibm(bone: Bone) {\n    return mat2txt(mat4.invert(mat4.create(), bone.matRestGlobal!))\n}\n\n// output mat4 in collada format (translation on the right instead of bottom)\nfunction mat2txt(m: mat4) {\n    const map = [0, 4, 8, 12, 1, 5, 9, 13, 2, 6, 10, 14, 3, 7, 11, 15]\n    let out = \"\"\n    for (let i = 0; i < 16; ++i) {\n        const x = m[map[i]]\n        out += `${x} `\n    }\n    return out.trimEnd()\n}\n\nfunction dumpBone(armatureName: string, bone: Bone, indent: number = 4, connectWithParent: boolean = false) {\n    const is = indentToString(indent)\n    let out = ``\n    out += `${is}<node id=\"${armatureName}_${bone.name.replace(/\\./g, \"_\")}\" name=\"${bone.name}\" sid=\"${bone.name.replace(/\\./g, \"_\")}\" type=\"JOINT\">\\n`\n    out += `${is}  <matrix sid=\"transform\">${bsm(bone)}</matrix>\\n`\n    out += `${is}  <extra>\\n`\n    out += `${is}    <technique profile=\"blender\">\\n`\n\n    const childrenToConnectWith = new Set<Bone>()\n    const tail = vec4.transformMat4(vec4.create(), bone.yvector4!, bone.matRestGlobal!)\n    for (let child of bone.children) {\n        const childHead = vec4.transformMat4(vec4.create(), vec4.fromValues(0, 0, 0, 1), child.matRestGlobal!)\n        if (vec4.equals(tail, childHead)) {\n            childrenToConnectWith.add(child)\n        }\n    }\n\n    if (connectWithParent) {\n        out += `${is}      <connect sid=\"connect\" type=\"bool\">1</connect>\\n`\n    }\n    out += `${is}      <layer sid=\"layer\" type=\"string\">0</layer>\\n`\n    if (childrenToConnectWith.size === 0) {\n        const head = vec4.transformMat4(vec4.create(), vec4.fromValues(0, 0, 0, 1), bone.matRestGlobal!)\n        const boneGlobalVec = vec4.sub(vec4.create(), tail, head)\n        out += `${is}      <tip_x sid=\"tip_x\" type=\"float\">${boneGlobalVec[0]}</tip_x>\\n`\n        out += `${is}      <tip_y sid=\"tip_y\" type=\"float\">${boneGlobalVec[1]}</tip_y>\\n`\n        out += `${is}      <tip_z sid=\"tip_z\" type=\"float\">${boneGlobalVec[2]}</tip_z>\\n`\n    }\n    out += `${is}    </technique>\\n`\n    out += `${is}  </extra>\\n`\n    for (let child of bone.children) {\n        out += dumpBone(armatureName, child, indent + 1, childrenToConnectWith.has(child))\n    }\n    out += `${is}</node>\\n`\n    return out\n}\n\nfunction indentToString(indent: number): string {\n    let indentStr = \"\"\n    for (let i = 0; i < indent; ++i) {\n        indentStr += \"  \"\n    }\n    return indentStr\n}","import { Human } from './Human'\nimport { TargetFactory } from './target/TargetFactory'\nimport { loadSkeleton } from './skeleton/loadSkeleton'\nimport { loadModifiers } from './modifier/loadModifiers'\nimport { loadSliders, SliderNode } from './modifier/loadSliders'\nimport { WavefrontObj } from './mesh/WavefrontObj'\nimport { HumanMesh, Update } from './mesh/HumanMesh'\nimport { Mode } from './Mode'\n\nimport { FileSystemAdapter } from './filesystem/FileSystemAdapter'\nimport { HTTPFSAdapter } from './filesystem/HTTPFSAdapter'\nimport { render } from './render'\n\nimport { Table } from 'toad.js/table/Table'\nimport { TreeNodeModel } from 'toad.js/table/model/TreeNodeModel'\nimport { TreeAdapter } from \"toad.js/table/adapter/TreeAdapter\"\nimport { EnumModel } from \"toad.js/model/EnumModel\"\nimport { Fragment, ref } from \"toad.jsx\"\nimport { Tab, Tabs } from 'toad.js/view/Tab'\nimport { PoseNode, PoseTreeAdapter } from 'skeleton/poseView'\nimport { SliderTreeAdapter } from 'modifier/morphView'\nimport { Button, Signal } from 'toad.js'\nimport { exportCollada } from 'mesh/Collada'\n\nwindow.onload = () => { main() }\n\nexport function main() {\n    try {\n        run()\n    }\n    catch (e) {\n        console.log(e)\n        if (e instanceof Error)\n            alert(`${e.name}: ${e.message}`)\n        else\n            alert(e)\n    }\n}\n\n// core/mhmain.py\n//   class MHApplication\n//     startupSequence()\nfunction run() {\n    console.log('loading assets...')\n    FileSystemAdapter.setInstance(new HTTPFSAdapter())\n\n    const human = Human.getInstance()\n\n    const obj = new WavefrontObj()\n    obj.load('data/3dobjs/base.obj.z')\n    human.meshData = obj\n    const scene = new HumanMesh(human, obj)\n    human.modified.add(() => scene.updateRequired = Update.MORPH)\n\n    const skeleton = loadSkeleton('data/rigs/default.mhskel.z')\n    human.setBaseSkeleton(skeleton)\n\n    // humanmodifier.loadModifiers(getpath.getSysDataPath('modifiers/modeling_modifiers.json'), app.selectedHuman)\n    loadModifiers('data/modifiers/modeling_modifiers.json.z', human)\n    loadModifiers('data/modifiers/measurement_modifiers.json.z', human)\n\n    // guimodifier.loadModifierTaskViews(getpath.getSysDataPath('modifiers/modeling_sliders.json'), app.selectedHuman, category)\n    const sliderNodes = loadSliders('data/modifiers/modeling_sliders.json.z')\n\n    loadMacroTargets()\n\n    // TargetFactory.getInstance()\n    // const vertexCopy = [scene.vertex]\n\n    console.log('everything is loaded...')\n\n    TreeAdapter.register(SliderTreeAdapter, TreeNodeModel, SliderNode)\n    TreeAdapter.register(PoseTreeAdapter, TreeNodeModel, PoseNode)\n\n    const mode = new EnumModel<Mode>(Mode)\n    mode.modified.add(() => { scene.mode = mode.value })\n\n    const morphControls = new TreeNodeModel(SliderNode, sliderNodes)\n\n    const poseChanged = new Signal<PoseNode>()\n    poseChanged.add((poseNode) => {\n        // console.log(`Bone ${poseNode.bone.name} changed to ${poseNode.x.value}, ${poseNode.y.value}, ${poseNode.z.value}`)\n        if (scene.updateRequired === Update.NONE) {\n            scene.updateRequired = Update.POSE\n        }\n    })\n    const poseNodes = new PoseNode(skeleton.roots[0], poseChanged)\n    const poseControls = new TreeNodeModel(PoseNode, poseNodes)\n\n    const download = makeDownloadAnchor()\n\n    const references = new class { canvas!: HTMLCanvasElement }\n    const mainScreen = <>\n        <Tabs model={mode} style={{ position: 'absolute', left: 0, width: '500px', top: 0, bottom: 0 }}>\n            <Tab label=\"Morph\" value=\"MORPH\">\n                <Table model={morphControls} style={{ width: '100%', height: '100%' }} />\n            </Tab>\n            <Tab label=\"Pose\" value=\"POSE\">\n                <Table model={poseControls} style={{ width: '100%', height: '100%' }} />\n            </Tab>\n            <Tab label=\"Export\" value=\"POSE\">\n                WiP: Only the base mesh is exported.<br/>\n                <Button action={() => downloadCollada(scene, download)}>Export Collada</Button>\n            </Tab>\n        </Tabs>\n        <div style={{ position: 'absolute', left: '500px', right: 0, top: 0, bottom: 0, overflow: 'hidden' }}>\n            <canvas set={ref(references, 'canvas')} style={{ width: '100%', height: '100%' }} />\n        </div>\n    </> as Fragment\n    mainScreen.appendTo(document.body)\n    render(references.canvas, scene)\n}\n\nfunction makeDownloadAnchor() {\n    const download = document.createElement(\"a\")\n    download.type = \"text/plain\"\n    download.style.display = \"hidden\"\n    download.download = \"makehuman.dae\"\n    return download\n}\n\nfunction downloadCollada(scene: HumanMesh, download: HTMLAnchorElement) {\n    download.href = URL.createObjectURL(new Blob([exportCollada(scene)], { type: 'text/plain' }))\n    download.dispatchEvent(new MouseEvent(\"click\"))\n}\n\n//\n// more makehuman stuff i need to figure out:\n//\n\nfunction loadMacroTargets() {\n    const targetFactory = TargetFactory.getInstance()\n    // for target in targets.getTargets().findTargets('macrodetails'):\n    for (const target of targetFactory.findTargets('macrodetails')) {\n        //         #log.debug('Preloading target %s', getpath.getRelativePath(target.path))\n        //         algos3d.getTarget(self.selectedHuman.meshData, target.path)\n        // console.log(target.path)\n        // target.getTarget()\n    }\n}\n\n// core/mhmain.py\n//   startupSequence()\n// apps/human.py\n//   class Human\n//     setGender(gender: number) // 0 femaile to 1 male\n//        if updateModifier:\n//            modifier = self.getModifier('macrodetails/Gender')\n//            modifier.setValue(gender)\n//            self.applyAllTargets()\n//            return\n//        gender = min(max(gender, 0.0), 1.0)\n//        if self.gender == gender:\n//            return\n//        self.gender = gender\n//        self._setGenderVals()\n//        self.callEvent('onChanging', events3d.HumanEvent(self, 'gender'))\n//    getModifier(self, name):\n//        return self._modifiers[name]\n//    addModifier(modifier)\n//  app/humanmodifier.py\n//    class ModifierAction\n//      do()/undo()\n//    class Modifier\n//      setHuman(human)\n//        self.human = human\n//        human.addModifier(self)\n//    class SimpleModifier: Modifier\n//    class ManagedTargetModifier: Modifier\n//    class UniversalModifier: ManagedTargetModifier\n//    class MacroModifier: ManagedTargetModifier\n//    class EthnicModifier: MacroModifier\n//    loadModifiers() // modifiers/modeling_modifiers.json && modifiers/measurement_modifiers.json\n\n// Modifier.buildLists()\n//    this.verts\n//    this.faces\n//\n// Human\n//   meshData: 3DObject\n//\n// core/module3d\n//   class FaceGroup(parent: Object3D, name: string, idx: number)\n//     object // 3DObject parent\n//     name   // group name\n//     idx    // group start\n//     color: byte[] // RGBA\n//     colorID\n//\n// 3DObject contains the mesh data...\n//   name: string\n//   vertPerPrimitive: number = 4 \n//\n//   orig_coord\n//   coord: vertex coordinates (Float32,Float32,Float32)[]\n//   nvorm: vertex normals     (Float32,Float32,Float32)[]\n//   vtang: (Float32,Float32,Float32,Float32)[]\n//   color: vertex colors (uint8,uint8,uint8,uint8)[]\n//   vface: (uint32, uint32, uint32, uint32)[]\n//   nfaces: uint8[]\n//\n//   _faceGroups: Array<FaceGroup>\n//   _groups_rev: Map<string, FaceGrouo>\n//\n//   cameraMode: number = 0 WTF?\n//   _visibility: boolean = true\n//   pickable = false\n//   calculateTangents = True\n//   object3d = undefined  the object in the GUI???\n//   _priority = 0\n//   MAX_FACES = 8\n//\n//   Cache used for retrieving vertex colors multiplied with material diffuse color\n//   _old_diff = undefined\n//   _r_color_diff = undefined\n//\n//   setCoords( coords: (float, float, float)[] )\n//   setUVs( coords: (float, float)[])\n//   setFaces(fverts: (int,int,int,int)[], fuvs: (int,int,int,int)[] | undefined, groups: int[])\n//   getVertexCount() = this.coord.length\n//\n//   __object = undefined\n//\n// class MHApplication {\n//   loadHuman() {\n//     self.selectedHuman = self.addObject(\n//        human.Human(\n//          files3d.loadMesh(  // load Wavefront OBJ and return it as Object3D\n//            mh.getSysDataPath(\"3dobjs/base.obj\")\n//            , maxFaces = 5 // max number of faces per vertex... why?\n//          )\n//        )\n//      )\n//   }\n// } \n"],"names":["Reference","constructor","object","attribute","this","toString","get","set","value","Object","defineProperty","fromString","type","outValue","Number","parseFloat","Error","ref","Fragment","Array","props","super","children","i","length","e","document","createTextNode","replaceIn","element","childNodes","removeChild","appendTo","child","appendChild","jsx","nameOrConstructor","key","undefined","jsxs","namespace","name","tag","createElementNS","entries","setAction","setModel","classList","add","skey","svalue","regex","replace","upperCase","toLowerCase","style","setProperty","substring","addEventListener","substr","setAttributeNS","setInitialProperties","SignalLink","callback","id","Signal","callbacks","push","remove","splice","count","lock","locked","unlock","triggered","data","trigger","Model","_enabled","modified","enabled","GenericModel","_value","NumberModel","options","min","max","step","increment","decrement","AnimatedMesh","getRestCoordinates","meshData","vertex","setBaseSkeleton","skel","__skeleton","Human","static","instance","age","gender","weight","muscle","height","breastSize","breastFirmness","bodyProportions","caucasianVal","asianVal","africanVal","maleVal","femaleVal","oldVal","babyVal","youngVal","childVal","maxweightVal","minweightVal","averageweightVal","maxmuscleVal","minmuscleVal","averagemuscleVal","maxheightVal","minheightVal","averageheightVal","maxcupVal","mincupVal","averagecupVal","maxfirmnessVal","minfirmnessVal","averagefirmnessVal","idealproportionsVal","uncommonproportionsVal","regularproportionsVal","flag","_setDependendValues","_setGenderVals","_setAgeVals","_setMuscleVals","_setWeightVals","_setHeightVals","_setBreastSizeVals","_setBreastFirmnessVals","_setBodyProportionVals","_setEthnicVals","modifiers","Map","modifierGroups","targetsDetailStack","getModifier","getModifiersByGroup","groupName","group","console","log","addModifier","modifier","has","fullName","setDetail","targetName","delete","getDetail","setDefaultValues","Math","exclude","_setEthnicValsCore","remaining","otherTotal","abs","updateProxyMesh","fitToPosed","getRestposeCoordinates","StringToLineIterator","index","next","done","nextIndex","indexOf","result","StringToLine","Symbol","iterator","FileSystemAdapter","Target","verts","load","filename","getInstance","readFile","reader","line","trim","tokens","split","parseInt","apply","scale","dataIndex","vertexIndex","categoryData","race","breastsize","breastfirmness","bodyproportions","validCategories","valueToCategory","category","hasOwnProperty","Component","parent","slice","isRoot","createChild","update","setData","addKey","tuple","s","getVariables","orig","finish","pathname","path","TargetFactory","rootComponent","images","targets","groups","loadTargetDirectory","size","walkTargets","buildIndex","findTargets","partialGroup","entry","concat","getTargetsByGroup","root","base","fs","directoryPath","realPath","dir","listDir","sort","p","joinPath","isFile","endsWith","item","parts","part","isDir","nextRoot","a","target","component","includes","targetBuffer","EPSILON","ARRAY_TYPE","Float32Array","create","out","glMatrix.ARRAY_TYPE","identity","invert","a00","a01","a02","a03","a10","a11","a12","a13","a20","a21","a22","a23","a30","a31","a32","a33","b00","b01","b02","b03","b04","b05","b06","b07","b08","b09","b10","b11","det","multiply","b","b0","b1","b2","b3","hypot","y","arguments","sqrt","perspective","fovy","aspect","near","far","nf","f","tan","Infinity","mul","fromValues","x","z","subtract","normalize","len","cross","ax","ay","az","bx","by","bz","transformMat4","m","w","sub","vec","Bone","parentName","headJoint","tailJoint","roll","reference_bones","weight_reference_bones","headPos","tailPos","skeleton","updateJointPositions","getBone","level","matPose","mat4.identity","mat4.create","planes","human","in_rest","getJointPosition","build","ref_skel","head3","vec3.fromValues","tail3","normal","get_normal","matRestGlobal","head","tail","bone_direction","vec3.subtract","vec3.create","vec3.normalize","norm","z_axis","vec3.cross","x_axis","m00","m01","m02","m03","m10","m11","m12","m13","m20","m21","m22","m23","m30","m31","m32","m33","getMatrix","vec3.distance","matRestRelative","mat4.mul","mat4.invert","yvector4","vec4.fromValues","matPoseGlobal","mat4.multiply","matPoseVerts","plane_name","plane_defs","warn","joint_names","j1","j2","j3","p1","vec3.scale","a2vec3","p2","p3","pvec","yvec","VertexBoneWeights","info","version","description","copyright","license","_data","_build_vertex_weights_data","weights","_calculate_num_weights","vertexWeightsDict","vertexCount","rootBone","vcount","bone_name","getOwnPropertyNames","forEach","vertex_index","_vertexCount","totalWeightPerVertex","fill","vertex_weight","boneWeights","bname","vgroup","v_lookup","vn","v_idx","i_s","map","filter","vs","ws","rw_i","Skeleton","bones","roots","joint_pos_idxs","plane_map_strategy","has_custom_weights","tags","joint_name","joints","v_idxs","plane","breadthfirst_bones_set","Set","breadthfirst_bones","prev_len","bone_defs","missing","rotation_plane","JSON","stringify","addBone","reference","weights_reference","weights_file","json","parse","error","vertexWeights","rest_coord","meshCoords","v","jointName","_getHumanJointPosition","boneslist","bone","getBones","updateJoints","buildBoneList","queue","shift","trace","skinMesh","vertBoneMapping","coords","mapping","vert","vec3.transformMat4","loadSkeleton","parseSkeleton","getTargetWeights","factors","ignoreNotfound","factorDependencies","factor","targetPath","css","strings","values","str","createElement","text","div","span","input","button","ul","li","ns","svg","d","x1","y1","x2","y2","stroke","l","BooleanModel","TextModel","promise","HtmlModel","Action","title","signal","placeHolder","getAttribute","nodeName","attributeOrUndefined","globalController","modelId2Models","modelId2Views","view2ModelIds","sigChanged","registerAction","actionId","action","_registerModel","registerModel","modelId","model","modelsForModelId","viewsForModelId","view","registerView","controller","modelIdsForView","modelsForView","unregisterView","modelIds","views","clear","bind","html","boolean","number","AnimationBase","_stop","_firstFrame","_animationFrame","start","prepare","requestAnimationFrame","stop","animator","current","clearCurrent","animation","animationFrame","lastFrame","firstFrame","window","time","startTime","elapsed","animationFrameCount","ease","_current","k","cos","PI","AnimationWrapper","Animator","run","animationBase","previousAnimation","halt","OptionModelBase","_stringValue","stringValue","isValidStringValue","EnumModel","enumClass","setValue","getValue","allValidValues","keys","validValue","View","HTMLElement","customElements","define","attachStyle","shadowRoot","importNode","getModelId","hasAttribute","getActionId","connectedCallback","disconnectedCallback","ModelView","init","updateModel","updateView","isConnected","ActionView","Function","isEnabled","textContent","Text","oninput","wheel","onwheel","attachShadow","mode","txText","deltaY","preventDefault","focus","blur","observedAttributes","attributeChangedCallback","oldValue","newValue","setAttribute","strValue","textAreaStyle","TextTool","texttool","toolbar","_jsx","class","buttonH1","onclick","execCommand","buttonH2","buttonH3","buttonH4","buttonBold","buttonItalic","buttonUnderline","buttonStrikeThrough","buttonSubscript","buttonSuperscript","buttonJustifyLeft","_jsxs","viewBox","width","buttonJustifyCenter","buttonJustifyRight","toggle","queryCommandValue","queryCommandState","TextArea","content","contentEditable","event","firstChild","nodeType","innerHTML","onkeydown","metaKey","updateTextTool","shiftKey","onkeyup","onmouseup","innerText","Display","Button","label","disabled","txButton","_observer","MutationObserver","record","observer","_timer","clearTimeout","setTimeout","observe","childList","subtree","characterData","BooleanView","checked","removeAttribute","Checkbox","onchange","checkmark","txCheckbox","Search","s0","s1","form","placeholder","autocomplete","txSearch","Switch","txSwitch","RadioButton","txRadio","radioGroup","radioGroups","radioGroupCounter","MenuState","WeakMap","MenuButtonContainer","vertical","closeOnClose","state","WAIT","PopupMenu","parentButton","popup","node","down","isAvailable","createWindowAt","deleteWindow","show","master","parentBoundary","getBoundingClientRect","opacity","left","top","popupBoundary","innerHeight","innerWidth","placePopupHorizontal","placePopupVertical","display","hide","Select","asPopupMenu","onblur","ev","hover","close","tabIndex","outline","onpointerdown","open","setPointerCapture","pointerId","onpointermove","elementFromPoint","clientX","clientY","newHover","HTMLLIElement","onpointerup","idx","dataset","select","contains","keydown","txCombobox","txMenu","asComboBox","readOnly","previousItem","nextItem","property","removeProperty","displayName","option","all","u","times","c","array","ariaRoleDescription","position","zIndex","HTMLOptionElement","getIndex","Slider","txSlider","String","GenericTool","viewParents","parentElement","distance","closestParent","closestTool","closestToolDistance","MAX_SAFE_INTEGER","closestToolList","tool","allTools","canHandle","toolParent","depth","toolDistance","viewIndex","closestNextSiblingIndex","MIN_SAFE_INTEGER","toolIndex","setActive","from","activeTool","deactivate","activeView","activate","relatedTarget","focusOut","focusIn","toolbuttonStyle","ToolButton","img","onmousedown","src","SlotView","ToadIf","Tabs","setTab","slot","tabContainer","tab","tabLabel","stopPropagation","cancelBubble","activeTab","activePanel","txTabs","markerLine","adjustLine","panel","offsetTop","clientHeight","offsetLeft","clientWidth","Tab","menuStyle","btoa","MenuButton","menuButton","documentMouseUp","removeEventListener","capture","buttonDown","dispatchEvent","MouseEvent","DOWN","UP_N_HOLD","active","DOWN_N_HOLD","documentMouseDown","tagName","collapse","DOWN_N_OUTSIDE","DOWN_N_INSIDE_AGAIN","onmouseout","inside","onmouseover","insertBefore","openPopup","closePopup","oldActive","MenuNode","shortcut","parentView","flexGrow","Menu","config","config2nodes","referenceActions","createShadowDOM","layout2nodes","newnode","dom.attribute","dom.attributeOrUndefined","space","findNode","strpos","right","n","MenuSpacer","TableModel","isEmpty","colCount","rowCount","TableEditMode","EditMode","TableEventType","TablePos","col","row","SelectionModel","EDIT_CELL","TypedTableModel","nodeClass","TableAdapterConfig","editMode","EDIT_ON_FOCUS","seamless","expandColumn","expandRow","TableAdapter","getColumnHead","getRowHead","showCell","pos","cell","saveCell","editCell","isViewCompact","adapter","typeToModel","modelToAdapter","dataType","getPrototypeOf","baseClass","msg","modelX","typeToAdapterX","typeX","adapterX","TableFriend","table","measure","getStaging","bodyStaging","getHeadStaging","headStaging","body","splitBody","colHeads","rowHeads","colResizeHandles","rowResizeHandles","animationDone","selection","setCellSize","h","clearAnimation","TableAnimation","prepareStagingWithRows","prepareBodyStaging","prepareRowHeadStaging","addStaging","scrollStaging","prepareStagingWithColumns","prepareColHeadStaging","className","disposeStaging","removeStaging","makeRowMask","mask","boxSizing","border","backgroundColor","Table","maskColor","makeColumnMask","bottom","InsertAnimation","prepareCellsToBeMeasured","prepareStaging","arrangeInStaging","animate","animationStart","totalSize","join","joinHeader","joinBody","InsertRowAnimation","initialRowCount","splitHead","headMask","prepareMinCellSize","rowHeaders","colHeaders","createCell","calculateMinCellSize","overlap","px2float","colWidth","bounds","minCellWidth","rowHeadWidth","rowHeight","minCellHeight","ceil","colHeadHeight","WIDTH_ADJUST","HEIGHT_ADJUST","splitHorizontalNew","lastElementChild","RemoveRowAnimation","joinHorizontal","initialHeight","bottomCell","removeAll","arrangeRowsInStaging","splitHorizontal","topSplitBody","animationHeight","topMask","cellCount","bottomOfStaging","replaceChildren","moveSplitBodyToBody","moveSplitHeadToHead","InsertColumnAnimation","previousColCount","px2int","totalWidth","columnWidth","splitVerticalNew","bodyWidth","stagingWidth","splitWidth","bodyInsertAt","beforeChild","RemoveColumnAnimation","joinVertical","initialWidth","arrangeColumnsInStaging","splitVertical","leftSplitBody","animationWidth","leftMask","firstCellOfStaging","lastCellOfStaging","rightOfStaging","scrollIntoView","scrollableParent","el","isScrollable","findScrollableParent","parentRect","clientRect","GAP","clientLeft","scrollLeft","clientRight","clientTop","scrollTop","clientBottom","parentWidth","parentHeight","calculateScrollGoal","scrollable","startX","startY","activeGoal","concurrentScroll","scrollX","pageXOffset","scrollY","pageYOffset","deltaX","nx","ny","scrollTo","animateStep","smoothScroll","getComputedStyle","scrollBy","behavior","idSource","Date","now","userAgent","ROUNDING_TOLERANCE","navigator","RegExp","test","isScrollableY","hasScrollableSpace","canOverflow","isScrollableX","axis","scrollWidth","scrollHeight","overflowValue","isVisible","HANDLE_SIZE","HANDLE_SKEW","visible","arrangeAllMeasuredInGrid","hostKeyDown","cellKeyDown","cellFocus","pointerDown","handleDown","handleMove","handleUp","setHeadingFillerSizeToScrollbarSize","selectionChanged","modelChanged","onresize","onscroll","delegatesFocus","txTable","selectionModel","mutations","allTables","prepareCells","attributes","SELECT_CELL","elements","editing","EDIT_ON_ENTER","clientPosToTablePos","getModel","lookup","activeElement","hasFocus","SELECT_ROW","CELL_CHANGED","INSERT_ROW","REMOVE_ROW","INSERT_COL","REMOVE_COL","prepareColumnHeads","prepareRowHeads","prepareBody","colWidths","calculateColumnWidths","rowHeights","calculateRowHeights","placeColumnHeads","placeRowHeads","placeBody","placeBodyCells","measureLineHeight","columnHeaders","onfocus","caretColor","rh","withinBody","idxStart","cw","seam","filler","handle","createHandle","rowHandle","handleIndex","deltaHandle","deltaSplitBody","deltaSplitHead","deltaColumn","xLimit","yLimit","splitCol","splitHeadVertical","splitBodyVertical","splitColor","colsToSplit","boundary","splitColumn","extra","splitBodyColumns","cloneNode","delta","splitRow","splitHeadHorizontal","splitBodyHorizontal","cellAtBottom","splitBodyRows","last","bf","isRowEditInterface","isColumnEditInterface","buttonAddRowAbove","lastActiveTable","insertRow","buttonAddRowBelow","buttonDeleteRow","removeRow","buttonAddColumnLeft","insertColumn","buttonAddColumnRight","buttonDeleteColumn","removeColumn","buttonAddNodeAbove","buttonAddNodeBelow","buttonAddNodeParent","buttonAddNodeChild","buttonDeleteNode","AbstractTypedTableAdapter","TypedTableAdapter","TableEvent","RowInfo","TreeModel","rows","createRowInfoHelper","getRow","addSiblingBefore","nn","createNode","setRoot","setNext","getRoot","unshift","getNext","setDown","addSiblingAfter","nodeCount","getDown","addChildAfter","subtreeSize","addParentBefore","deleteAt","append","toggleAt","closeAt","openAt","isOpen","r","newRows","createRowInfo","getVisibleChildCount","rowinfo","rowInfo","getVisibleChildCountHelper","chain","TreeAdapter","treeCell","_showCell","labelNode","verticalAlign","padding","sx","rs","dx","dy","round","svgNode","background","x0","box","rect","cursor","minus","plus","rowNumber","lines","j","backgroundRepeat","TreeNodeModel","deleteNode","Modifier","defaultValue","setHuman","getMin","getMax","skipDependencies","clampedValue","clampValue","getFactors","tWeights","propagateUpdate","resetValue","getDefaultValue","realtime","sum","buildLists","faces","updateValue","updateNormals","skipUpdate","getSymmetrySide","getSymmetricOpposite","getSimilar","isMacro","macroVariable","ManagedTargetModifier","targetWeights","rTargets","lTargets","desc","getOwnPropertyDescriptors","TargetRef","targetsList","targetgroup","factordependencies","MacroModifier","macroDependencies","_a","findMacroDependencies","getMacroVariable","EthnicModifier","UniversalModifier","leftExt","rightExt","centerExt","center","fullTargetName","cTargets","loadModifiers","classesMapping","modifierGroup","modifierDef","modifierClass","modifierType","macrovar","mid","parseModifiers","SliderNode","modifierSpec","mod","capitalize","toUpperCase","labelFromModifier","tlabel","pop","loadSliders","rootNode","lastTabNode","tabKey","tabValue","sortOrder","tabNode","lastCategoryNode","categoryKey","categoryValue","categoryNode","lastSliderNode","sliderNode","parseSliders","Group","startIndex","WavefrontObj","faceGroups","indices","lineNumber","logStatistics","getFaceGroup","g","groupNames","helpers","startsWith","Update","Mode","HumanMesh","obj","updateRequired","NONE","origVertex","isNaN","getTarget","tmp","u8","Uint8Array","u16","Uint16Array","u32","Uint32Array","fleb","fdeb","clim","freb","eb","fl","revfl","fd","rev","hMap","cd","mb","co","le","rvb","sv","r_1","flt","fdt","flrm","fdrm","bits","o","bits16","ec","err","ind","nt","code","captureStackTrace","inflt","dat","buf","st","sl","noBuf","noSt","cbuf","bl","nbuf","final","bt","lm","dm","lbt","dbt","tbts","t","subarray","hLit","hcLen","tl","ldt","clt","clb","clbmsk","clm","lt","dt","lms","dms","lpos","sym","dsym","end","BYTES_PER_ELEMENT","slc","et","unzlibSync","Mesh","td","TextDecoder","decode","stream","HTTPFSAdapter","req","XMLHttpRequest","overrideMimeType","send","status","statusText","ab","ArrayBuffer","responseText","ua","charCodeAt","path2info","file","fullfile","pathname1","pathname2","calculateNormals","addNormal","normals","i1","i2","i3","normalIndex","cubeRotation","RenderMesh","gl","createBuffer","ARRAY_BUFFER","STATIC_DRAW","ELEMENT_ARRAY_BUFFER","updateBuffer","draw","programInfo","FLOAT","bindBuffer","vertexAttribPointer","attribLocations","vertexPosition","enableVertexAttribArray","vertexNormal","drawElements","UNSIGNED_SHORT","usage","buffer","bufferData","render","canvas","scene","getContext","buffers","renderSkeletonGlobal","vx","ix","skeletonOffset","skeletonIndex","proxy","getCoords","proxyMesh","createAllBuffers","vertexShader","compileShader","VERTEX_SHADER","vertexSharderSrc","fragmentShader","FRAGMENT_SHADER","fragmentShaderSrc","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","getAttribLocation","uniformLocations","projectionMatrix","getUniformLocation","modelViewMatrix","normalMatrix","color","then","deltaTime","vertexOffset","viewport","clearColor","clearDepth","enable","DEPTH_TEST","depthFunc","LEQUAL","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","fieldOfView","zNear","zFar","mat4.perspective","mat4.translate","rad","b12","b20","b21","b22","glMatrix.EPSILON","sin","mat4.rotate","mat4.transpose","numComponents","stride","offset","skin","useProgram","uniformMatrix4fv","MORPH","SKIN","TRIANGLES","POSE","LINES","EYEBALL0","EYEBALL1","MOUTH_GUM_TOP","MOUTH_GUM_BOTTOM","TOUNGE","CUBE","LINE_STRIP","uniform4fv","drawScene","source","shader","createShader","shaderSource","getShaderParameter","COMPILE_STATUS","deleteShader","getShaderInfoLog","location","vec4.transformMat4","vec4.create","vi","ii","PoseNode","updateBone","mat4.fromXRotation","mat4.fromYRotation","mat4.fromZRotation","childBone","PoseTreeAdapter","_Fragment","SliderTreeAdapter","exportCollada","toISOString","materials","colladaEffects","colladaMaterials","meshId","vertexStart","MAX_VALUE","vertexEnd","MIN_VALUE","indexStart","indexEnd","meshName","objectName","meshPositionsName","meshPositionsArrayName","meshVerticesName","repeat","colladaGeometries","allBoneNames","allWeights","ibmAll","boneName","boneIndex","mat2txt","ibm","weightIndex","trimEnd","outFlat","skinName","armatureName","skinJointsName","skinJointsArrayName","skinIbmName","skinIbmArrayName","skinWeightsName","skinWeightsArrayName","colladaControllers","sceneName","dumpBone","colladaVisualScenes","indent","connectWithParent","is","indentStr","indentToString","bsm","childrenToConnectWith","childHead","a0","a1","a2","a3","boneGlobalVec","vec4.sub","main","setInstance","sliderNodes","targetFactory","loadMacroTargets","register","morphControls","poseChanged","poseNode","poseNodes","poseControls","download","makeDownloadAnchor","references","assign","href","URL","createObjectURL","Blob","downloadCollada","overflow","alert","message","onload"],"mappings":"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"}